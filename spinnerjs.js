ZnVuY3Rpb24gcmVzaXplTWUoKSB7CiAgICBpbml0aWFsT2Zmc2V0ID0gJCgiLmhhbmRsZSIpLnBv
c2l0aW9uKCkudG9wCn0KCmZ1bmN0aW9uIHNwaW4oKSB7CiAgICAkKCIuaGFuZGxlIikucGVwKHsK
ICAgICAgICBkcmFnOiB1cGRhdGVQb3MsCiAgICAgICAgZWFzaW5nOiB1cGRhdGVQb3MKICAgIH0p
LCBpbml0aWFsT2Zmc2V0ID0gJCgiLmhhbmRsZSIpLnBvc2l0aW9uKCkudG9wLCBzcGlubmVyID0g
JCgiLnNwaW5uZXIiKS5wcm9wZWxsZXIoewogICAgICAgIGluZXJ0aWE6IC45OTksCiAgICAgICAg
c3BlZWQ6IC41LAogICAgICAgIG9uRHJhZ1N0b3A6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICBi
YWNrZ3JvdW5kSW5pdCA9ICEwCiAgICAgICAgfSwKICAgICAgICBvbkRyYWdTdGFydDogZnVuY3Rp
b24oKSB7CiAgICAgICAgICAgIGJhY2tncm91bmRJbml0ID0gITEKICAgICAgICB9LAogICAgICAg
IG9uUm90YXRlOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgdXBkYXRlQmFja2dyb3VuZCh0aGlz
LnNwZWVkKQogICAgICAgIH0KICAgIH0pCn0KCmZ1bmN0aW9uIHVwZGF0ZUJhY2tncm91bmQodCkg
ewogICAgdmFyIGUgPSAicmdiKCIgKyBNYXRoLmZsb29yKDI1NiAqIE1hdGgucmFuZG9tKCkpICsg
IiwiICsgTWF0aC5mbG9vcigyNTYgKiBNYXRoLnJhbmRvbSgpKSArICIsIiArIE1hdGguZmxvb3Io
MjU2ICogTWF0aC5yYW5kb20oKSkgKyAiKSI7CiAgICBpZiAoIWJhY2tncm91bmRBbmltYXRpbmcg
JiYgYmFja2dyb3VuZEluaXQpIHsKICAgICAgICB2YXIgbiA9IE1hdGguYWJzKDFlMyAtIDEwICog
TWF0aC5hYnModCkpOwogICAgICAgIGJhY2tncm91bmRBbmltYXRpbmcgPSAhMCwgJCgiYm9keSIp
LmFuaW1hdGUoewogICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IGUKICAgICAgICB9LCBuLCBm
dW5jdGlvbigpIHsKICAgICAgICAgICAgYmFja2dyb3VuZEFuaW1hdGluZyA9ICExCiAgICAgICAg
fSkKICAgIH0KfQoKZnVuY3Rpb24gZG9EcmFnKHQsIGUpIHsKICAgIG9uRHJhZ1N0YXJ0LCB1cGRh
dGVQb3ModCwgZSkKfQoKZnVuY3Rpb24gdXBkYXRlUG9zKHQsIGUpIHsKICAgICAgICB2YXIgbiA9
ICQoZS5lbCk7CiAgICAgICAgJCgiLnNwaW5uZXIiKS5jc3MoewogICAgICAgICAgICB0b3A6IG4u
cG9zaXRpb24oKS50b3AgLSBpbml0aWFsT2Zmc2V0LAogICAgICAgICAgICBsZWZ0OiBuLnBvc2l0
aW9uKCkubGVmdCAtIGluaXRpYWxPZmZzZXQKICAgICAgICB9KQogICAgfSEgZnVuY3Rpb24odCwg
ZSkgewogICAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgICAib2JqZWN0IiA9PSB0eXBlb2YgbW9k
dWxlICYmICJvYmplY3QiID09IHR5cGVvZiBtb2R1bGUuZXhwb3J0cyA/IG1vZHVsZS5leHBvcnRz
ID0gdC5kb2N1bWVudCA/IGUodCwgITApIDogZnVuY3Rpb24odCkgewogICAgICAgICAgICBpZiAo
IXQuZG9jdW1lbnQpIHRocm93IG5ldyBFcnJvcigialF1ZXJ5IHJlcXVpcmVzIGEgd2luZG93IHdp
dGggYSBkb2N1bWVudCIpOwogICAgICAgICAgICByZXR1cm4gZSh0KQogICAgICAgIH0gOiBlKHQp
CiAgICB9KCJ1bmRlZmluZWQiICE9IHR5cGVvZiB3aW5kb3cgPyB3aW5kb3cgOiB0aGlzLCBmdW5j
dGlvbih0LCBlKSB7CiAgICAgICAgInVzZSBzdHJpY3QiOwoKICAgICAgICBmdW5jdGlvbiBuKHQs
IGUpIHsKICAgICAgICAgICAgZSA9IGUgfHwgbnQ7CiAgICAgICAgICAgIHZhciBuID0gZS5jcmVh
dGVFbGVtZW50KCJzY3JpcHQiKTsKICAgICAgICAgICAgbi50ZXh0ID0gdCwgZS5oZWFkLmFwcGVu
ZENoaWxkKG4pLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobikKICAgICAgICB9CgogICAgICAgIGZ1
bmN0aW9uIGkodCkgewogICAgICAgICAgICB2YXIgZSA9ICEhdCAmJiAibGVuZ3RoIiBpbiB0ICYm
IHQubGVuZ3RoLAogICAgICAgICAgICAgICAgbiA9IGd0LnR5cGUodCk7CiAgICAgICAgICAgIHJl
dHVybiAiZnVuY3Rpb24iICE9PSBuICYmICFndC5pc1dpbmRvdyh0KSAmJiAoImFycmF5IiA9PT0g
biB8fCAwID09PSBlIHx8ICJudW1iZXIiID09IHR5cGVvZiBlICYmIGUgPiAwICYmIGUgLSAxIGlu
IHQpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBvKHQsIGUpIHsKICAgICAgICAgICAgcmV0
dXJuIHQubm9kZU5hbWUgJiYgdC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSBlLnRvTG93ZXJD
YXNlKCkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHIodCwgZSwgbikgewogICAgICAgICAg
ICByZXR1cm4gZ3QuaXNGdW5jdGlvbihlKSA/IGd0LmdyZXAodCwgZnVuY3Rpb24odCwgaSkgewog
ICAgICAgICAgICAgICAgcmV0dXJuICEhZS5jYWxsKHQsIGksIHQpICE9PSBuCiAgICAgICAgICAg
IH0pIDogZS5ub2RlVHlwZSA/IGd0LmdyZXAodCwgZnVuY3Rpb24odCkgewogICAgICAgICAgICAg
ICAgcmV0dXJuIHQgPT09IGUgIT09IG4KICAgICAgICAgICAgfSkgOiAic3RyaW5nIiAhPSB0eXBl
b2YgZSA/IGd0LmdyZXAodCwgZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgcmV0dXJuIGF0
LmNhbGwoZSwgdCkgPiAtMSAhPT0gbgogICAgICAgICAgICB9KSA6IHd0LnRlc3QoZSkgPyBndC5m
aWx0ZXIoZSwgdCwgbikgOiAoZSA9IGd0LmZpbHRlcihlLCB0KSwgZ3QuZ3JlcCh0LCBmdW5jdGlv
bih0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gYXQuY2FsbChlLCB0KSA+IC0xICE9PSBuICYm
IDEgPT09IHQubm9kZVR5cGUKICAgICAgICAgICAgfSkpCiAgICAgICAgfQoKICAgICAgICBmdW5j
dGlvbiBzKHQsIGUpIHsKICAgICAgICAgICAgZm9yICg7CiAgICAgICAgICAgICAgICAodCA9IHRb
ZV0pICYmIDEgIT09IHQubm9kZVR5cGU7KTsKICAgICAgICAgICAgcmV0dXJuIHQKICAgICAgICB9
CgogICAgICAgIGZ1bmN0aW9uIGEodCkgewogICAgICAgICAgICB2YXIgZSA9IHt9OwogICAgICAg
ICAgICByZXR1cm4gZ3QuZWFjaCh0Lm1hdGNoKGt0KSB8fCBbXSwgZnVuY3Rpb24odCwgbikgewog
ICAgICAgICAgICAgICAgZVtuXSA9ICEwCiAgICAgICAgICAgIH0pLCBlCiAgICAgICAgfQoKICAg
ICAgICBmdW5jdGlvbiB1KHQpIHsKICAgICAgICAgICAgcmV0dXJuIHQKICAgICAgICB9CgogICAg
ICAgIGZ1bmN0aW9uIGwodCkgewogICAgICAgICAgICB0aHJvdyB0CiAgICAgICAgfQoKICAgICAg
ICBmdW5jdGlvbiBjKHQsIGUsIG4sIGkpIHsKICAgICAgICAgICAgdmFyIG87CiAgICAgICAgICAg
IHRyeSB7CiAgICAgICAgICAgICAgICB0ICYmIGd0LmlzRnVuY3Rpb24obyA9IHQucHJvbWlzZSkg
PyBvLmNhbGwodCkuZG9uZShlKS5mYWlsKG4pIDogdCAmJiBndC5pc0Z1bmN0aW9uKG8gPSB0LnRo
ZW4pID8gby5jYWxsKHQsIGUsIG4pIDogZS5hcHBseSh2b2lkIDAsIFt0XS5zbGljZShpKSkKICAg
ICAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgICAgICAgbi5hcHBseSh2b2lkIDAsIFt0
XSkKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gcCgpIHsKICAgICAg
ICAgICAgbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsIHApLCB0LnJl
bW92ZUV2ZW50TGlzdGVuZXIoImxvYWQiLCBwKSwgZ3QucmVhZHkoKQogICAgICAgIH0KCiAgICAg
ICAgZnVuY3Rpb24gaCgpIHsKICAgICAgICAgICAgdGhpcy5leHBhbmRvID0gZ3QuZXhwYW5kbyAr
IGgudWlkKysKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGYodCkgewogICAgICAgICAgICBy
ZXR1cm4gInRydWUiID09PSB0IHx8ICJmYWxzZSIgIT09IHQgJiYgKCJudWxsIiA9PT0gdCA/IG51
bGwgOiB0ID09PSArdCArICIiID8gK3QgOiBQdC50ZXN0KHQpID8gSlNPTi5wYXJzZSh0KSA6IHQp
CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBkKHQsIGUsIG4pIHsKICAgICAgICAgICAgdmFy
IGk7CiAgICAgICAgICAgIGlmICh2b2lkIDAgPT09IG4gJiYgMSA9PT0gdC5ub2RlVHlwZSkKICAg
ICAgICAgICAgICAgIGlmIChpID0gImRhdGEtIiArIGUucmVwbGFjZShxdCwgIi0kJiIpLnRvTG93
ZXJDYXNlKCksICJzdHJpbmciID09IHR5cGVvZihuID0gdC5nZXRBdHRyaWJ1dGUoaSkpKSB7CiAg
ICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgbiA9IGYobikK
ICAgICAgICAgICAgICAgICAgICB9IGNhdGNoICh0KSB7fQogICAgICAgICAgICAgICAgICAgICR0
LnNldCh0LCBlLCBuKQogICAgICAgICAgICAgICAgfSBlbHNlIG4gPSB2b2lkIDA7CiAgICAgICAg
ICAgIHJldHVybiBuCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBnKHQsIGUsIG4sIGkpIHsK
ICAgICAgICAgICAgdmFyIG8sIHIgPSAxLAogICAgICAgICAgICAgICAgcyA9IDIwLAogICAgICAg
ICAgICAgICAgYSA9IGkgPyBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4g
aS5jdXIoKQogICAgICAgICAgICAgICAgfSA6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAg
ICAgIHJldHVybiBndC5jc3ModCwgZSwgIiIpCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAg
ICAgICAgdSA9IGEoKSwKICAgICAgICAgICAgICAgIGwgPSBuICYmIG5bM10gfHwgKGd0LmNzc051
bWJlcltlXSA/ICIiIDogInB4IiksCiAgICAgICAgICAgICAgICBjID0gKGd0LmNzc051bWJlcltl
XSB8fCAicHgiICE9PSBsICYmICt1KSAmJiBJdC5leGVjKGd0LmNzcyh0LCBlKSk7CiAgICAgICAg
ICAgIGlmIChjICYmIGNbM10gIT09IGwpIHsKICAgICAgICAgICAgICAgIGwgPSBsIHx8IGNbM10s
IG4gPSBuIHx8IFtdLCBjID0gK3UgfHwgMTsKICAgICAgICAgICAgICAgIGRvIHsKICAgICAgICAg
ICAgICAgICAgICByID0gciB8fCAiLjUiLCBjIC89IHIsIGd0LnN0eWxlKHQsIGUsIGMgKyBsKQog
ICAgICAgICAgICAgICAgfSB3aGlsZSAociAhPT0gKHIgPSBhKCkgLyB1KSAmJiAxICE9PSByICYm
IC0tcykKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gbiAmJiAoYyA9ICtjIHx8ICt1
IHx8IDAsIG8gPSBuWzFdID8gYyArIChuWzFdICsgMSkgKiBuWzJdIDogK25bMl0sIGkgJiYgKGku
dW5pdCA9IGwsIGkuc3RhcnQgPSBjLCBpLmVuZCA9IG8pKSwgbwogICAgICAgIH0KCiAgICAgICAg
ZnVuY3Rpb24gbSh0KSB7CiAgICAgICAgICAgIHZhciBlLCBuID0gdC5vd25lckRvY3VtZW50LAog
ICAgICAgICAgICAgICAgaSA9IHQubm9kZU5hbWUsCiAgICAgICAgICAgICAgICBvID0gV3RbaV07
CiAgICAgICAgICAgIHJldHVybiBvIHx8IChlID0gbi5ib2R5LmFwcGVuZENoaWxkKG4uY3JlYXRl
RWxlbWVudChpKSksIG8gPSBndC5jc3MoZSwgImRpc3BsYXkiKSwgZS5wYXJlbnROb2RlLnJlbW92
ZUNoaWxkKGUpLCAibm9uZSIgPT09IG8gJiYgKG8gPSAiYmxvY2siKSwgV3RbaV0gPSBvLCBvKQog
ICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gdih0LCBlKSB7CiAgICAgICAgICAgIGZvciAodmFy
IG4sIGksIG8gPSBbXSwgciA9IDAsIHMgPSB0Lmxlbmd0aDsgciA8IHM7IHIrKykgaSA9IHRbcl0s
IGkuc3R5bGUgJiYgKG4gPSBpLnN0eWxlLmRpc3BsYXksIGUgPyAoIm5vbmUiID09PSBuICYmIChv
W3JdID0gTHQuZ2V0KGksICJkaXNwbGF5IikgfHwgbnVsbCwgb1tyXSB8fCAoaS5zdHlsZS5kaXNw
bGF5ID0gIiIpKSwgIiIgPT09IGkuc3R5bGUuZGlzcGxheSAmJiBPdChpKSAmJiAob1tyXSA9IG0o
aSkpKSA6ICJub25lIiAhPT0gbiAmJiAob1tyXSA9ICJub25lIiwgTHQuc2V0KGksICJkaXNwbGF5
IiwgbikpKTsKICAgICAgICAgICAgZm9yIChyID0gMDsgciA8IHM7IHIrKykgbnVsbCAhPSBvW3Jd
ICYmICh0W3JdLnN0eWxlLmRpc3BsYXkgPSBvW3JdKTsKICAgICAgICAgICAgcmV0dXJuIHQKICAg
ICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHkodCwgZSkgewogICAgICAgICAgICB2YXIgbjsKICAg
ICAgICAgICAgcmV0dXJuIG4gPSB2b2lkIDAgIT09IHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUgPyB0
LmdldEVsZW1lbnRzQnlUYWdOYW1lKGUgfHwgIioiKSA6IHZvaWQgMCAhPT0gdC5xdWVyeVNlbGVj
dG9yQWxsID8gdC5xdWVyeVNlbGVjdG9yQWxsKGUgfHwgIioiKSA6IFtdLCB2b2lkIDAgPT09IGUg
fHwgZSAmJiBvKHQsIGUpID8gZ3QubWVyZ2UoW3RdLCBuKSA6IG4KICAgICAgICB9CgogICAgICAg
IGZ1bmN0aW9uIHgodCwgZSkgewogICAgICAgICAgICBmb3IgKHZhciBuID0gMCwgaSA9IHQubGVu
Z3RoOyBuIDwgaTsgbisrKSBMdC5zZXQodFtuXSwgImdsb2JhbEV2YWwiLCAhZSB8fCBMdC5nZXQo
ZVtuXSwgImdsb2JhbEV2YWwiKSkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGIodCwgZSwg
biwgaSwgbykgewogICAgICAgICAgICBmb3IgKHZhciByLCBzLCBhLCB1LCBsLCBjLCBwID0gZS5j
cmVhdGVEb2N1bWVudEZyYWdtZW50KCksIGggPSBbXSwgZiA9IDAsIGQgPSB0Lmxlbmd0aDsgZiA8
IGQ7IGYrKykKICAgICAgICAgICAgICAgIGlmICgociA9IHRbZl0pIHx8IDAgPT09IHIpCiAgICAg
ICAgICAgICAgICAgICAgaWYgKCJvYmplY3QiID09PSBndC50eXBlKHIpKSBndC5tZXJnZShoLCBy
Lm5vZGVUeXBlID8gW3JdIDogcik7CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoWXQudGVz
dChyKSkgewogICAgICAgICAgICAgICAgZm9yIChzID0gcyB8fCBwLmFwcGVuZENoaWxkKGUuY3Jl
YXRlRWxlbWVudCgiZGl2IikpLCBhID0gKEJ0LmV4ZWMocikgfHwgWyIiLCAiIl0pWzFdLnRvTG93
ZXJDYXNlKCksIHUgPSBYdFthXSB8fCBYdC5fZGVmYXVsdCwgcy5pbm5lckhUTUwgPSB1WzFdICsg
Z3QuaHRtbFByZWZpbHRlcihyKSArIHVbMl0sIGMgPSB1WzBdOyBjLS07KSBzID0gcy5sYXN0Q2hp
bGQ7CiAgICAgICAgICAgICAgICBndC5tZXJnZShoLCBzLmNoaWxkTm9kZXMpLCBzID0gcC5maXJz
dENoaWxkLCBzLnRleHRDb250ZW50ID0gIiIKICAgICAgICAgICAgfSBlbHNlIGgucHVzaChlLmNy
ZWF0ZVRleHROb2RlKHIpKTsKICAgICAgICAgICAgZm9yIChwLnRleHRDb250ZW50ID0gIiIsIGYg
PSAwOyByID0gaFtmKytdOykKICAgICAgICAgICAgICAgIGlmIChpICYmIGd0LmluQXJyYXkociwg
aSkgPiAtMSkgbyAmJiBvLnB1c2gocik7CiAgICAgICAgICAgICAgICBlbHNlIGlmIChsID0gZ3Qu
Y29udGFpbnMoci5vd25lckRvY3VtZW50LCByKSwgcyA9IHkocC5hcHBlbmRDaGlsZChyKSwgInNj
cmlwdCIpLCBsICYmIHgocyksIG4pCiAgICAgICAgICAgICAgICBmb3IgKGMgPSAwOyByID0gc1tj
KytdOykgenQudGVzdChyLnR5cGUgfHwgIiIpICYmIG4ucHVzaChyKTsKICAgICAgICAgICAgcmV0
dXJuIHAKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIFQoKSB7CiAgICAgICAgICAgIHJldHVy
biAhMAogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gdygpIHsKICAgICAgICAgICAgcmV0dXJu
ICExCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBDKCkgewogICAgICAgICAgICB0cnkgewog
ICAgICAgICAgICAgICAgcmV0dXJuIG50LmFjdGl2ZUVsZW1lbnQKICAgICAgICAgICAgfSBjYXRj
aCAodCkge30KICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIFModCwgZSwgbiwgaSwgbywgcikg
ewogICAgICAgICAgICB2YXIgcywgYTsKICAgICAgICAgICAgaWYgKCJvYmplY3QiID09IHR5cGVv
ZiBlKSB7CiAgICAgICAgICAgICAgICAic3RyaW5nIiAhPSB0eXBlb2YgbiAmJiAoaSA9IGkgfHwg
biwgbiA9IHZvaWQgMCk7CiAgICAgICAgICAgICAgICBmb3IgKGEgaW4gZSkgUyh0LCBhLCBuLCBp
LCBlW2FdLCByKTsKICAgICAgICAgICAgICAgIHJldHVybiB0CiAgICAgICAgICAgIH0KICAgICAg
ICAgICAgaWYgKG51bGwgPT0gaSAmJiBudWxsID09IG8gPyAobyA9IG4sIGkgPSBuID0gdm9pZCAw
KSA6IG51bGwgPT0gbyAmJiAoInN0cmluZyIgPT0gdHlwZW9mIG4gPyAobyA9IGksIGkgPSB2b2lk
IDApIDogKG8gPSBpLCBpID0gbiwgbiA9IHZvaWQgMCkpLCAhMSA9PT0gbykgbyA9IHc7CiAgICAg
ICAgICAgIGVsc2UgaWYgKCFvKSByZXR1cm4gdDsKICAgICAgICAgICAgcmV0dXJuIDEgPT09IHIg
JiYgKHMgPSBvLCBvID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgcmV0dXJuIGd0KCku
b2ZmKHQpLCBzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykKICAgICAgICAgICAgfSwgby5ndWlkID0g
cy5ndWlkIHx8IChzLmd1aWQgPSBndC5ndWlkKyspKSwgdC5lYWNoKGZ1bmN0aW9uKCkgewogICAg
ICAgICAgICAgICAgZ3QuZXZlbnQuYWRkKHRoaXMsIGUsIG8sIGksIG4pCiAgICAgICAgICAgIH0p
CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBFKHQsIGUpIHsKICAgICAgICAgICAgcmV0dXJu
IG8odCwgInRhYmxlIikgJiYgbygxMSAhPT0gZS5ub2RlVHlwZSA/IGUgOiBlLmZpcnN0Q2hpbGQs
ICJ0ciIpID8gZ3QoIj50Ym9keSIsIHQpWzBdIHx8IHQgOiB0CiAgICAgICAgfQoKICAgICAgICBm
dW5jdGlvbiBBKHQpIHsKICAgICAgICAgICAgcmV0dXJuIHQudHlwZSA9IChudWxsICE9PSB0Lmdl
dEF0dHJpYnV0ZSgidHlwZSIpKSArICIvIiArIHQudHlwZSwgdAogICAgICAgIH0KCiAgICAgICAg
ZnVuY3Rpb24gayh0KSB7CiAgICAgICAgICAgIHZhciBlID0gWnQuZXhlYyh0LnR5cGUpOwogICAg
ICAgICAgICByZXR1cm4gZSA/IHQudHlwZSA9IGVbMV0gOiB0LnJlbW92ZUF0dHJpYnV0ZSgidHlw
ZSIpLCB0CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBEKHQsIGUpIHsKICAgICAgICAgICAg
dmFyIG4sIGksIG8sIHIsIHMsIGEsIHUsIGw7CiAgICAgICAgICAgIGlmICgxID09PSBlLm5vZGVU
eXBlKSB7CiAgICAgICAgICAgICAgICBpZiAoTHQuaGFzRGF0YSh0KSAmJiAociA9IEx0LmFjY2Vz
cyh0KSwgcyA9IEx0LnNldChlLCByKSwgbCA9IHIuZXZlbnRzKSkgewogICAgICAgICAgICAgICAg
ICAgIGRlbGV0ZSBzLmhhbmRsZSwgcy5ldmVudHMgPSB7fTsKICAgICAgICAgICAgICAgICAgICBm
b3IgKG8gaW4gbCkKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChuID0gMCwgaSA9IGxbb10u
bGVuZ3RoOyBuIDwgaTsgbisrKSBndC5ldmVudC5hZGQoZSwgbywgbFtvXVtuXSkKICAgICAgICAg
ICAgICAgIH0KICAgICAgICAgICAgICAgICR0Lmhhc0RhdGEodCkgJiYgKGEgPSAkdC5hY2Nlc3Mo
dCksIHUgPSBndC5leHRlbmQoe30sIGEpLCAkdC5zZXQoZSwgdSkpCiAgICAgICAgICAgIH0KICAg
ICAgICB9CgogICAgICAgIGZ1bmN0aW9uIE4odCwgZSkgewogICAgICAgICAgICB2YXIgbiA9IGUu
bm9kZU5hbWUudG9Mb3dlckNhc2UoKTsKICAgICAgICAgICAgImlucHV0IiA9PT0gbiAmJiBfdC50
ZXN0KHQudHlwZSkgPyBlLmNoZWNrZWQgPSB0LmNoZWNrZWQgOiAiaW5wdXQiICE9PSBuICYmICJ0
ZXh0YXJlYSIgIT09IG4gfHwgKGUuZGVmYXVsdFZhbHVlID0gdC5kZWZhdWx0VmFsdWUpCiAgICAg
ICAgfQoKICAgICAgICBmdW5jdGlvbiBNKHQsIGUsIGksIG8pIHsKICAgICAgICAgICAgZSA9IHJ0
LmFwcGx5KFtdLCBlKTsKICAgICAgICAgICAgdmFyIHIsIHMsIGEsIHUsIGwsIGMsIHAgPSAwLAog
ICAgICAgICAgICAgICAgaCA9IHQubGVuZ3RoLAogICAgICAgICAgICAgICAgZiA9IGggLSAxLAog
ICAgICAgICAgICAgICAgZCA9IGVbMF0sCiAgICAgICAgICAgICAgICBnID0gZ3QuaXNGdW5jdGlv
bihkKTsKICAgICAgICAgICAgaWYgKGcgfHwgaCA+IDEgJiYgInN0cmluZyIgPT0gdHlwZW9mIGQg
JiYgIWZ0LmNoZWNrQ2xvbmUgJiYgS3QudGVzdChkKSkgcmV0dXJuIHQuZWFjaChmdW5jdGlvbihu
KSB7CiAgICAgICAgICAgICAgICB2YXIgciA9IHQuZXEobik7CiAgICAgICAgICAgICAgICBnICYm
IChlWzBdID0gZC5jYWxsKHRoaXMsIG4sIHIuaHRtbCgpKSksIE0ociwgZSwgaSwgbykKICAgICAg
ICAgICAgfSk7CiAgICAgICAgICAgIGlmIChoICYmIChyID0gYihlLCB0WzBdLm93bmVyRG9jdW1l
bnQsICExLCB0LCBvKSwgcyA9IHIuZmlyc3RDaGlsZCwgMSA9PT0gci5jaGlsZE5vZGVzLmxlbmd0
aCAmJiAociA9IHMpLCBzIHx8IG8pKSB7CiAgICAgICAgICAgICAgICBmb3IgKGEgPSBndC5tYXAo
eShyLCAic2NyaXB0IiksIEEpLCB1ID0gYS5sZW5ndGg7IHAgPCBoOyBwKyspIGwgPSByLCBwICE9
PSBmICYmIChsID0gZ3QuY2xvbmUobCwgITAsICEwKSwgdSAmJiBndC5tZXJnZShhLCB5KGwsICJz
Y3JpcHQiKSkpLCBpLmNhbGwodFtwXSwgbCwgcCk7CiAgICAgICAgICAgICAgICBpZiAodSkKICAg
ICAgICAgICAgICAgICAgICBmb3IgKGMgPSBhW2EubGVuZ3RoIC0gMV0ub3duZXJEb2N1bWVudCwg
Z3QubWFwKGEsIGspLCBwID0gMDsgcCA8IHU7IHArKykgbCA9IGFbcF0sIHp0LnRlc3QobC50eXBl
IHx8ICIiKSAmJiAhTHQuYWNjZXNzKGwsICJnbG9iYWxFdmFsIikgJiYgZ3QuY29udGFpbnMoYywg
bCkgJiYgKGwuc3JjID8gZ3QuX2V2YWxVcmwgJiYgZ3QuX2V2YWxVcmwobC5zcmMpIDogbihsLnRl
eHRDb250ZW50LnJlcGxhY2UodGUsICIiKSwgYykpCiAgICAgICAgICAgIH0KICAgICAgICAgICAg
cmV0dXJuIHQKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGoodCwgZSwgbikgewogICAgICAg
ICAgICBmb3IgKHZhciBpLCBvID0gZSA/IGd0LmZpbHRlcihlLCB0KSA6IHQsIHIgPSAwOyBudWxs
ICE9IChpID0gb1tyXSk7IHIrKykgbiB8fCAxICE9PSBpLm5vZGVUeXBlIHx8IGd0LmNsZWFuRGF0
YSh5KGkpKSwgaS5wYXJlbnROb2RlICYmIChuICYmIGd0LmNvbnRhaW5zKGkub3duZXJEb2N1bWVu
dCwgaSkgJiYgeCh5KGksICJzY3JpcHQiKSksIGkucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChpKSk7
CiAgICAgICAgICAgIHJldHVybiB0CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBMKHQsIGUs
IG4pIHsKICAgICAgICAgICAgdmFyIGksIG8sIHIsIHMsIGEgPSB0LnN0eWxlOwogICAgICAgICAg
ICByZXR1cm4gbiA9IG4gfHwgaWUodCksIG4gJiYgKHMgPSBuLmdldFByb3BlcnR5VmFsdWUoZSkg
fHwgbltlXSwgIiIgIT09IHMgfHwgZ3QuY29udGFpbnModC5vd25lckRvY3VtZW50LCB0KSB8fCAo
cyA9IGd0LnN0eWxlKHQsIGUpKSwgIWZ0LnBpeGVsTWFyZ2luUmlnaHQoKSAmJiBuZS50ZXN0KHMp
ICYmIGVlLnRlc3QoZSkgJiYgKGkgPSBhLndpZHRoLCBvID0gYS5taW5XaWR0aCwgciA9IGEubWF4
V2lkdGgsIGEubWluV2lkdGggPSBhLm1heFdpZHRoID0gYS53aWR0aCA9IHMsIHMgPSBuLndpZHRo
LCBhLndpZHRoID0gaSwgYS5taW5XaWR0aCA9IG8sIGEubWF4V2lkdGggPSByKSksIHZvaWQgMCAh
PT0gcyA/IHMgKyAiIiA6IHMKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uICQodCwgZSkgewog
ICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAg
ICAgICAgICAgICAgICAgICByZXR1cm4gdCgpID8gdm9pZCBkZWxldGUgdGhpcy5nZXQgOiAodGhp
cy5nZXQgPSBlKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpCiAgICAgICAgICAgICAgICB9CiAgICAg
ICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIFAodCkgewogICAgICAgICAgICBp
ZiAodCBpbiBsZSkgcmV0dXJuIHQ7CiAgICAgICAgICAgIGZvciAodmFyIGUgPSB0WzBdLnRvVXBw
ZXJDYXNlKCkgKyB0LnNsaWNlKDEpLCBuID0gdWUubGVuZ3RoOyBuLS07KQogICAgICAgICAgICAg
ICAgaWYgKCh0ID0gdWVbbl0gKyBlKSBpbiBsZSkgcmV0dXJuIHQKICAgICAgICB9CgogICAgICAg
IGZ1bmN0aW9uIHEodCkgewogICAgICAgICAgICB2YXIgZSA9IGd0LmNzc1Byb3BzW3RdOwogICAg
ICAgICAgICByZXR1cm4gZSB8fCAoZSA9IGd0LmNzc1Byb3BzW3RdID0gUCh0KSB8fCB0KSwgZQog
ICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gUih0LCBlLCBuKSB7CiAgICAgICAgICAgIHZhciBp
ID0gSXQuZXhlYyhlKTsKICAgICAgICAgICAgcmV0dXJuIGkgPyBNYXRoLm1heCgwLCBpWzJdIC0g
KG4gfHwgMCkpICsgKGlbM10gfHwgInB4IikgOiBlCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlv
biBJKHQsIGUsIG4sIGksIG8pIHsKICAgICAgICAgICAgdmFyIHIsIHMgPSAwOwogICAgICAgICAg
ICBmb3IgKHIgPSBuID09PSAoaSA/ICJib3JkZXIiIDogImNvbnRlbnQiKSA/IDQgOiAid2lkdGgi
ID09PSBlID8gMSA6IDA7IHIgPCA0OyByICs9IDIpICJtYXJnaW4iID09PSBuICYmIChzICs9IGd0
LmNzcyh0LCBuICsgRnRbcl0sICEwLCBvKSksIGkgPyAoImNvbnRlbnQiID09PSBuICYmIChzIC09
IGd0LmNzcyh0LCAicGFkZGluZyIgKyBGdFtyXSwgITAsIG8pKSwgIm1hcmdpbiIgIT09IG4gJiYg
KHMgLT0gZ3QuY3NzKHQsICJib3JkZXIiICsgRnRbcl0gKyAiV2lkdGgiLCAhMCwgbykpKSA6IChz
ICs9IGd0LmNzcyh0LCAicGFkZGluZyIgKyBGdFtyXSwgITAsIG8pLCAicGFkZGluZyIgIT09IG4g
JiYgKHMgKz0gZ3QuY3NzKHQsICJib3JkZXIiICsgRnRbcl0gKyAiV2lkdGgiLCAhMCwgbykpKTsK
ICAgICAgICAgICAgcmV0dXJuIHMKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIEYodCwgZSwg
bikgewogICAgICAgICAgICB2YXIgaSwgbyA9IGllKHQpLAogICAgICAgICAgICAgICAgciA9IEwo
dCwgZSwgbyksCiAgICAgICAgICAgICAgICBzID0gImJvcmRlci1ib3giID09PSBndC5jc3ModCwg
ImJveFNpemluZyIsICExLCBvKTsKICAgICAgICAgICAgcmV0dXJuIG5lLnRlc3QocikgPyByIDog
KGkgPSBzICYmIChmdC5ib3hTaXppbmdSZWxpYWJsZSgpIHx8IHIgPT09IHQuc3R5bGVbZV0pLCAi
YXV0byIgPT09IHIgJiYgKHIgPSB0WyJvZmZzZXQiICsgZVswXS50b1VwcGVyQ2FzZSgpICsgZS5z
bGljZSgxKV0pLCAociA9IHBhcnNlRmxvYXQocikgfHwgMCkgKyBJKHQsIGUsIG4gfHwgKHMgPyAi
Ym9yZGVyIiA6ICJjb250ZW50IiksIGksIG8pICsgInB4IikKICAgICAgICB9CgogICAgICAgIGZ1
bmN0aW9uIE8odCwgZSwgbiwgaSwgbykgewogICAgICAgICAgICByZXR1cm4gbmV3IE8ucHJvdG90
eXBlLmluaXQodCwgZSwgbiwgaSwgbykKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIEgoKSB7
CiAgICAgICAgICAgIHBlICYmICghMSA9PT0gbnQuaGlkZGVuICYmIHQucmVxdWVzdEFuaW1hdGlv
bkZyYW1lID8gdC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoSCkgOiB0LnNldFRpbWVvdXQoSCwgZ3Qu
ZnguaW50ZXJ2YWwpLCBndC5meC50aWNrKCkpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBX
KCkgewogICAgICAgICAgICByZXR1cm4gdC5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICAg
ICAgICAgICAgY2UgPSB2b2lkIDAKICAgICAgICAgICAgfSksIGNlID0gZ3Qubm93KCkKICAgICAg
ICB9CgogICAgICAgIGZ1bmN0aW9uIF8odCwgZSkgewogICAgICAgICAgICB2YXIgbiwgaSA9IDAs
CiAgICAgICAgICAgICAgICBvID0gewogICAgICAgICAgICAgICAgICAgIGhlaWdodDogdAogICAg
ICAgICAgICAgICAgfTsKICAgICAgICAgICAgZm9yIChlID0gZSA/IDEgOiAwOyBpIDwgNDsgaSAr
PSAyIC0gZSkgbiA9IEZ0W2ldLCBvWyJtYXJnaW4iICsgbl0gPSBvWyJwYWRkaW5nIiArIG5dID0g
dDsKICAgICAgICAgICAgcmV0dXJuIGUgJiYgKG8ub3BhY2l0eSA9IG8ud2lkdGggPSB0KSwgbwog
ICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gQih0LCBlLCBuKSB7CiAgICAgICAgICAgIGZvciAo
dmFyIGksIG8gPSAoWS50d2VlbmVyc1tlXSB8fCBbXSkuY29uY2F0KFkudHdlZW5lcnNbIioiXSks
IHIgPSAwLCBzID0gby5sZW5ndGg7IHIgPCBzOyByKyspCiAgICAgICAgICAgICAgICBpZiAoaSA9
IG9bcl0uY2FsbChuLCBlLCB0KSkgcmV0dXJuIGkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9u
IHoodCwgZSwgbikgewogICAgICAgICAgICB2YXIgaSwgbywgciwgcywgYSwgdSwgbCwgYywgcCA9
ICJ3aWR0aCIgaW4gZSB8fCAiaGVpZ2h0IiBpbiBlLAogICAgICAgICAgICAgICAgaCA9IHRoaXMs
CiAgICAgICAgICAgICAgICBmID0ge30sCiAgICAgICAgICAgICAgICBkID0gdC5zdHlsZSwKICAg
ICAgICAgICAgICAgIGcgPSB0Lm5vZGVUeXBlICYmIE90KHQpLAogICAgICAgICAgICAgICAgbSA9
IEx0LmdldCh0LCAiZnhzaG93Iik7CiAgICAgICAgICAgIG4ucXVldWUgfHwgKHMgPSBndC5fcXVl
dWVIb29rcyh0LCAiZngiKSwgbnVsbCA9PSBzLnVucXVldWVkICYmIChzLnVucXVldWVkID0gMCwg
YSA9IHMuZW1wdHkuZmlyZSwgcy5lbXB0eS5maXJlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAg
ICAgICBzLnVucXVldWVkIHx8IGEoKQogICAgICAgICAgICB9KSwgcy51bnF1ZXVlZCsrLCBoLmFs
d2F5cyhmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIGguYWx3YXlzKGZ1bmN0aW9uKCkgewog
ICAgICAgICAgICAgICAgICAgIHMudW5xdWV1ZWQtLSwgZ3QucXVldWUodCwgImZ4IikubGVuZ3Ro
IHx8IHMuZW1wdHkuZmlyZSgpCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9KSk7CiAg
ICAgICAgICAgIGZvciAoaSBpbiBlKQogICAgICAgICAgICAgICAgaWYgKG8gPSBlW2ldLCBoZS50
ZXN0KG8pKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGRlbGV0ZSBlW2ldLCByID0gciB8fCAi
dG9nZ2xlIiA9PT0gbywgbyA9PT0gKGcgPyAiaGlkZSIgOiAic2hvdyIpKSB7CiAgICAgICAgICAg
ICAgICAgICAgICAgIGlmICgic2hvdyIgIT09IG8gfHwgIW0gfHwgdm9pZCAwID09PSBtW2ldKSBj
b250aW51ZTsKICAgICAgICAgICAgICAgICAgICAgICAgZyA9ICEwCiAgICAgICAgICAgICAgICAg
ICAgfQogICAgICAgICAgICAgICAgICAgIGZbaV0gPSBtICYmIG1baV0gfHwgZ3Quc3R5bGUodCwg
aSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCh1ID0gIWd0LmlzRW1wdHlPYmpl
Y3QoZSkpIHx8ICFndC5pc0VtcHR5T2JqZWN0KGYpKSB7CiAgICAgICAgICAgICAgICBwICYmIDEg
PT09IHQubm9kZVR5cGUgJiYgKG4ub3ZlcmZsb3cgPSBbZC5vdmVyZmxvdywgZC5vdmVyZmxvd1gs
IGQub3ZlcmZsb3dZXSwgbCA9IG0gJiYgbS5kaXNwbGF5LCBudWxsID09IGwgJiYgKGwgPSBMdC5n
ZXQodCwgImRpc3BsYXkiKSksIGMgPSBndC5jc3ModCwgImRpc3BsYXkiKSwgIm5vbmUiID09PSBj
ICYmIChsID8gYyA9IGwgOiAodihbdF0sICEwKSwgbCA9IHQuc3R5bGUuZGlzcGxheSB8fCBsLCBj
ID0gZ3QuY3NzKHQsICJkaXNwbGF5IiksIHYoW3RdKSkpLCAoImlubGluZSIgPT09IGMgfHwgImlu
bGluZS1ibG9jayIgPT09IGMgJiYgbnVsbCAhPSBsKSAmJiAibm9uZSIgPT09IGd0LmNzcyh0LCAi
ZmxvYXQiKSAmJiAodSB8fCAoaC5kb25lKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAg
IGQuZGlzcGxheSA9IGwKICAgICAgICAgICAgICAgIH0pLCBudWxsID09IGwgJiYgKGMgPSBkLmRp
c3BsYXksIGwgPSAibm9uZSIgPT09IGMgPyAiIiA6IGMpKSwgZC5kaXNwbGF5ID0gImlubGluZS1i
bG9jayIpKSwgbi5vdmVyZmxvdyAmJiAoZC5vdmVyZmxvdyA9ICJoaWRkZW4iLCBoLmFsd2F5cyhm
dW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICBkLm92ZXJmbG93ID0gbi5vdmVyZmxvd1sw
XSwgZC5vdmVyZmxvd1ggPSBuLm92ZXJmbG93WzFdLCBkLm92ZXJmbG93WSA9IG4ub3ZlcmZsb3db
Ml0KICAgICAgICAgICAgICAgIH0pKSwgdSA9ICExOwogICAgICAgICAgICAgICAgZm9yIChpIGlu
IGYpIHUgfHwgKG0gPyAiaGlkZGVuIiBpbiBtICYmIChnID0gbS5oaWRkZW4pIDogbSA9IEx0LmFj
Y2Vzcyh0LCAiZnhzaG93IiwgewogICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IGwKICAgICAg
ICAgICAgICAgIH0pLCByICYmIChtLmhpZGRlbiA9ICFnKSwgZyAmJiB2KFt0XSwgITApLCBoLmRv
bmUoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgZyB8fCB2KFt0XSksIEx0LnJlbW92
ZSh0LCAiZnhzaG93Iik7CiAgICAgICAgICAgICAgICAgICAgZm9yIChpIGluIGYpIGd0LnN0eWxl
KHQsIGksIGZbaV0pCiAgICAgICAgICAgICAgICB9KSksIHUgPSBCKGcgPyBtW2ldIDogMCwgaSwg
aCksIGkgaW4gbSB8fCAobVtpXSA9IHUuc3RhcnQsIGcgJiYgKHUuZW5kID0gdS5zdGFydCwgdS5z
dGFydCA9IDApKQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBYKHQs
IGUpIHsKICAgICAgICAgICAgdmFyIG4sIGksIG8sIHIsIHM7CiAgICAgICAgICAgIGZvciAobiBp
biB0KQogICAgICAgICAgICAgICAgaWYgKGkgPSBndC5jYW1lbENhc2UobiksIG8gPSBlW2ldLCBy
ID0gdFtuXSwgQXJyYXkuaXNBcnJheShyKSAmJiAobyA9IHJbMV0sIHIgPSB0W25dID0gclswXSks
IG4gIT09IGkgJiYgKHRbaV0gPSByLCBkZWxldGUgdFtuXSksIChzID0gZ3QuY3NzSG9va3NbaV0p
ICYmICJleHBhbmQiIGluIHMpIHsKICAgICAgICAgICAgICAgICAgICByID0gcy5leHBhbmQociks
IGRlbGV0ZSB0W2ldOwogICAgICAgICAgICAgICAgICAgIGZvciAobiBpbiByKSBuIGluIHQgfHwg
KHRbbl0gPSByW25dLCBlW25dID0gbykKICAgICAgICAgICAgICAgIH0gZWxzZSBlW2ldID0gbwog
ICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gWSh0LCBlLCBuKSB7CiAgICAgICAgICAgIHZhciBp
LCBvLCByID0gMCwKICAgICAgICAgICAgICAgIHMgPSBZLnByZWZpbHRlcnMubGVuZ3RoLAogICAg
ICAgICAgICAgICAgYSA9IGd0LkRlZmVycmVkKCkuYWx3YXlzKGZ1bmN0aW9uKCkgewogICAgICAg
ICAgICAgICAgICAgIGRlbGV0ZSB1LmVsZW0KICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAg
ICAgICAgdSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIGlmIChvKSByZXR1cm4g
ITE7CiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZSA9IGNlIHx8IFcoKSwgbiA9IE1hdGgu
bWF4KDAsIGwuc3RhcnRUaW1lICsgbC5kdXJhdGlvbiAtIGUpLCBpID0gbiAvIGwuZHVyYXRpb24g
fHwgMCwgciA9IDEgLSBpLCBzID0gMCwgdSA9IGwudHdlZW5zLmxlbmd0aDsgcyA8IHU7IHMrKykg
bC50d2VlbnNbc10ucnVuKHIpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBhLm5vdGlmeVdp
dGgodCwgW2wsIHIsIG5dKSwgciA8IDEgJiYgdSA/IG4gOiAodSB8fCBhLm5vdGlmeVdpdGgodCwg
W2wsIDEsIDBdKSwgYS5yZXNvbHZlV2l0aCh0LCBbbF0pLCAhMSkKICAgICAgICAgICAgICAgIH0s
CiAgICAgICAgICAgICAgICBsID0gYS5wcm9taXNlKHsKICAgICAgICAgICAgICAgICAgICBlbGVt
OiB0LAogICAgICAgICAgICAgICAgICAgIHByb3BzOiBndC5leHRlbmQoe30sIGUpLAogICAgICAg
ICAgICAgICAgICAgIG9wdHM6IGd0LmV4dGVuZCghMCwgewogICAgICAgICAgICAgICAgICAgICAg
ICBzcGVjaWFsRWFzaW5nOiB7fSwKICAgICAgICAgICAgICAgICAgICAgICAgZWFzaW5nOiBndC5l
YXNpbmcuX2RlZmF1bHQKICAgICAgICAgICAgICAgICAgICB9LCBuKSwKICAgICAgICAgICAgICAg
ICAgICBvcmlnaW5hbFByb3BlcnRpZXM6IGUsCiAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWxP
cHRpb25zOiBuLAogICAgICAgICAgICAgICAgICAgIHN0YXJ0VGltZTogY2UgfHwgVygpLAogICAg
ICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBuLmR1cmF0aW9uLAogICAgICAgICAgICAgICAgICAg
IHR3ZWVuczogW10sCiAgICAgICAgICAgICAgICAgICAgY3JlYXRlVHdlZW46IGZ1bmN0aW9uKGUs
IG4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSBndC5Ud2Vlbih0LCBsLm9wdHMs
IGUsIG4sIGwub3B0cy5zcGVjaWFsRWFzaW5nW2VdIHx8IGwub3B0cy5lYXNpbmcpOwogICAgICAg
ICAgICAgICAgICAgICAgICByZXR1cm4gbC50d2VlbnMucHVzaChpKSwgaQogICAgICAgICAgICAg
ICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgc3RvcDogZnVuY3Rpb24oZSkgewogICAgICAg
ICAgICAgICAgICAgICAgICB2YXIgbiA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBp
ID0gZSA/IGwudHdlZW5zLmxlbmd0aCA6IDA7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChv
KSByZXR1cm4gdGhpczsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChvID0gITA7IG4gPCBp
OyBuKyspIGwudHdlZW5zW25dLnJ1bigxKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJu
IGUgPyAoYS5ub3RpZnlXaXRoKHQsIFtsLCAxLCAwXSksIGEucmVzb2x2ZVdpdGgodCwgW2wsIGVd
KSkgOiBhLnJlamVjdFdpdGgodCwgW2wsIGVdKSwgdGhpcwogICAgICAgICAgICAgICAgICAgIH0K
ICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgYyA9IGwucHJvcHM7CiAgICAgICAg
ICAgIGZvciAoWChjLCBsLm9wdHMuc3BlY2lhbEVhc2luZyk7IHIgPCBzOyByKyspCiAgICAgICAg
ICAgICAgICBpZiAoaSA9IFkucHJlZmlsdGVyc1tyXS5jYWxsKGwsIHQsIGMsIGwub3B0cykpIHJl
dHVybiBndC5pc0Z1bmN0aW9uKGkuc3RvcCkgJiYgKGd0Ll9xdWV1ZUhvb2tzKGwuZWxlbSwgbC5v
cHRzLnF1ZXVlKS5zdG9wID0gZ3QucHJveHkoaS5zdG9wLCBpKSksIGk7CiAgICAgICAgICAgIHJl
dHVybiBndC5tYXAoYywgQiwgbCksIGd0LmlzRnVuY3Rpb24obC5vcHRzLnN0YXJ0KSAmJiBsLm9w
dHMuc3RhcnQuY2FsbCh0LCBsKSwgbC5wcm9ncmVzcyhsLm9wdHMucHJvZ3Jlc3MpLmRvbmUobC5v
cHRzLmRvbmUsIGwub3B0cy5jb21wbGV0ZSkuZmFpbChsLm9wdHMuZmFpbCkuYWx3YXlzKGwub3B0
cy5hbHdheXMpLCBndC5meC50aW1lcihndC5leHRlbmQodSwgewogICAgICAgICAgICAgICAgZWxl
bTogdCwKICAgICAgICAgICAgICAgIGFuaW06IGwsCiAgICAgICAgICAgICAgICBxdWV1ZTogbC5v
cHRzLnF1ZXVlCiAgICAgICAgICAgIH0pKSwgbAogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24g
Vih0KSB7CiAgICAgICAgICAgIHJldHVybiAodC5tYXRjaChrdCkgfHwgW10pLmpvaW4oIiAiKQog
ICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gVSh0KSB7CiAgICAgICAgICAgIHJldHVybiB0Lmdl
dEF0dHJpYnV0ZSAmJiB0LmdldEF0dHJpYnV0ZSgiY2xhc3MiKSB8fCAiIgogICAgICAgIH0KCiAg
ICAgICAgZnVuY3Rpb24gUSh0LCBlLCBuLCBpKSB7CiAgICAgICAgICAgIHZhciBvOwogICAgICAg
ICAgICBpZiAoQXJyYXkuaXNBcnJheShlKSkgZ3QuZWFjaChlLCBmdW5jdGlvbihlLCBvKSB7CiAg
ICAgICAgICAgICAgICBuIHx8IHdlLnRlc3QodCkgPyBpKHQsIG8pIDogUSh0ICsgIlsiICsgKCJv
YmplY3QiID09IHR5cGVvZiBvICYmIG51bGwgIT0gbyA/IGUgOiAiIikgKyAiXSIsIG8sIG4sIGkp
CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBlbHNlIGlmIChuIHx8ICJvYmplY3QiICE9PSBn
dC50eXBlKGUpKSBpKHQsIGUpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBmb3Ig
KG8gaW4gZSkgUSh0ICsgIlsiICsgbyArICJdIiwgZVtvXSwgbiwgaSkKICAgICAgICB9CgogICAg
ICAgIGZ1bmN0aW9uIEcodCkgewogICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZSwgbikgewog
ICAgICAgICAgICAgICAgInN0cmluZyIgIT0gdHlwZW9mIGUgJiYgKG4gPSBlLCBlID0gIioiKTsK
ICAgICAgICAgICAgICAgIHZhciBpLCBvID0gMCwKICAgICAgICAgICAgICAgICAgICByID0gZS50
b0xvd2VyQ2FzZSgpLm1hdGNoKGt0KSB8fCBbXTsKICAgICAgICAgICAgICAgIGlmIChndC5pc0Z1
bmN0aW9uKG4pKQogICAgICAgICAgICAgICAgICAgIGZvciAoOyBpID0gcltvKytdOykgIisiID09
PSBpWzBdID8gKGkgPSBpLnNsaWNlKDEpIHx8ICIqIiwgKHRbaV0gPSB0W2ldIHx8IFtdKS51bnNo
aWZ0KG4pKSA6ICh0W2ldID0gdFtpXSB8fCBbXSkucHVzaChuKQogICAgICAgICAgICB9CiAgICAg
ICAgfQoKICAgICAgICBmdW5jdGlvbiBKKHQsIGUsIG4sIGkpIHsKICAgICAgICAgICAgZnVuY3Rp
b24gbyhhKSB7CiAgICAgICAgICAgICAgICB2YXIgdTsKICAgICAgICAgICAgICAgIHJldHVybiBy
W2FdID0gITAsIGd0LmVhY2godFthXSB8fCBbXSwgZnVuY3Rpb24odCwgYSkgewogICAgICAgICAg
ICAgICAgICAgIHZhciBsID0gYShlLCBuLCBpKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4g
InN0cmluZyIgIT0gdHlwZW9mIGwgfHwgcyB8fCByW2xdID8gcyA/ICEodSA9IGwpIDogdm9pZCAw
IDogKGUuZGF0YVR5cGVzLnVuc2hpZnQobCksIG8obCksICExKQogICAgICAgICAgICAgICAgfSks
IHUKICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgciA9IHt9LAogICAgICAgICAgICAgICAg
cyA9IHQgPT09IE5lOwogICAgICAgICAgICByZXR1cm4gbyhlLmRhdGFUeXBlc1swXSkgfHwgIXJb
IioiXSAmJiBvKCIqIikKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIEsodCwgZSkgewogICAg
ICAgICAgICB2YXIgbiwgaSwgbyA9IGd0LmFqYXhTZXR0aW5ncy5mbGF0T3B0aW9ucyB8fCB7fTsK
ICAgICAgICAgICAgZm9yIChuIGluIGUpIHZvaWQgMCAhPT0gZVtuXSAmJiAoKG9bbl0gPyB0IDog
aSB8fCAoaSA9IHt9KSlbbl0gPSBlW25dKTsKICAgICAgICAgICAgcmV0dXJuIGkgJiYgZ3QuZXh0
ZW5kKCEwLCB0LCBpKSwgdAogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gWih0LCBlLCBuKSB7
CiAgICAgICAgICAgIGZvciAodmFyIGksIG8sIHIsIHMsIGEgPSB0LmNvbnRlbnRzLCB1ID0gdC5k
YXRhVHlwZXM7CiAgICAgICAgICAgICAgICAiKiIgPT09IHVbMF07KSB1LnNoaWZ0KCksIHZvaWQg
MCA9PT0gaSAmJiAoaSA9IHQubWltZVR5cGUgfHwgZS5nZXRSZXNwb25zZUhlYWRlcigiQ29udGVu
dC1UeXBlIikpOwogICAgICAgICAgICBpZiAoaSkKICAgICAgICAgICAgICAgIGZvciAobyBpbiBh
KQogICAgICAgICAgICAgICAgICAgIGlmIChhW29dICYmIGFbb10udGVzdChpKSkgewogICAgICAg
ICAgICAgICAgICAgICAgICB1LnVuc2hpZnQobyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJy
ZWFrCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAodVswXSBpbiBuKSByID0g
dVswXTsKICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBmb3IgKG8gaW4gbikgewog
ICAgICAgICAgICAgICAgICAgIGlmICghdVswXSB8fCB0LmNvbnZlcnRlcnNbbyArICIgIiArIHVb
MF1dKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHIgPSBvOwogICAgICAgICAgICAgICAgICAg
ICAgICBicmVhawogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBzIHx8
IChzID0gbykKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHIgPSByIHx8IHMKICAg
ICAgICAgICAgfQogICAgICAgICAgICBpZiAocikgcmV0dXJuIHIgIT09IHVbMF0gJiYgdS51bnNo
aWZ0KHIpLCBuW3JdCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiB0dCh0LCBlLCBuLCBpKSB7
CiAgICAgICAgICAgIHZhciBvLCByLCBzLCBhLCB1LCBsID0ge30sCiAgICAgICAgICAgICAgICBj
ID0gdC5kYXRhVHlwZXMuc2xpY2UoKTsKICAgICAgICAgICAgaWYgKGNbMV0pCiAgICAgICAgICAg
ICAgICBmb3IgKHMgaW4gdC5jb252ZXJ0ZXJzKSBsW3MudG9Mb3dlckNhc2UoKV0gPSB0LmNvbnZl
cnRlcnNbc107CiAgICAgICAgICAgIGZvciAociA9IGMuc2hpZnQoKTsgcjspCiAgICAgICAgICAg
ICAgICBpZiAodC5yZXNwb25zZUZpZWxkc1tyXSAmJiAoblt0LnJlc3BvbnNlRmllbGRzW3JdXSA9
IGUpLCAhdSAmJiBpICYmIHQuZGF0YUZpbHRlciAmJiAoZSA9IHQuZGF0YUZpbHRlcihlLCB0LmRh
dGFUeXBlKSksIHUgPSByLCByID0gYy5zaGlmdCgpKQogICAgICAgICAgICAgICAgICAgIGlmICgi
KiIgPT09IHIpIHIgPSB1OwogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKCIqIiAhPT0gdSAm
JiB1ICE9PSByKSB7CiAgICAgICAgICAgICAgICBpZiAoIShzID0gbFt1ICsgIiAiICsgcl0gfHwg
bFsiKiAiICsgcl0pKQogICAgICAgICAgICAgICAgICAgIGZvciAobyBpbiBsKQogICAgICAgICAg
ICAgICAgICAgICAgICBpZiAoYSA9IG8uc3BsaXQoIiAiKSwgYVsxXSA9PT0gciAmJiAocyA9IGxb
dSArICIgIiArIGFbMF1dIHx8IGxbIiogIiArIGFbMF1dKSkgewogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgITAgPT09IHMgPyBzID0gbFtvXSA6ICEwICE9PSBsW29dICYmIChyID0gYVswXSwg
Yy51bnNoaWZ0KGFbMV0pKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAg
ICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmICghMCAhPT0gcykKICAgICAg
ICAgICAgICAgICAgICBpZiAocyAmJiB0LnRocm93cykgZSA9IHMoZSk7CiAgICAgICAgICAgICAg
ICAgICAgZWxzZSB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICBlID0gcyhlKQogICAgICAg
ICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJu
IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlOiAicGFyc2VyZXJyb3IiLAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IHMgPyB0IDogIk5vIGNvbnZlcnNpb24gZnJv
bSAiICsgdSArICIgdG8gIiArIHIKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAg
ICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAg
ICAgICAgc3RhdGU6ICJzdWNjZXNzIiwKICAgICAgICAgICAgICAgIGRhdGE6IGUKICAgICAgICAg
ICAgfQogICAgICAgIH0KICAgICAgICB2YXIgZXQgPSBbXSwKICAgICAgICAgICAgbnQgPSB0LmRv
Y3VtZW50LAogICAgICAgICAgICBpdCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZiwKICAgICAgICAg
ICAgb3QgPSBldC5zbGljZSwKICAgICAgICAgICAgcnQgPSBldC5jb25jYXQsCiAgICAgICAgICAg
IHN0ID0gZXQucHVzaCwKICAgICAgICAgICAgYXQgPSBldC5pbmRleE9mLAogICAgICAgICAgICB1
dCA9IHt9LAogICAgICAgICAgICBsdCA9IHV0LnRvU3RyaW5nLAogICAgICAgICAgICBjdCA9IHV0
Lmhhc093blByb3BlcnR5LAogICAgICAgICAgICBwdCA9IGN0LnRvU3RyaW5nLAogICAgICAgICAg
ICBodCA9IHB0LmNhbGwoT2JqZWN0KSwKICAgICAgICAgICAgZnQgPSB7fSwKICAgICAgICAgICAg
ZHQgPSAiMy4yLjEiLAogICAgICAgICAgICBndCA9IGZ1bmN0aW9uKHQsIGUpIHsKICAgICAgICAg
ICAgICAgIHJldHVybiBuZXcgZ3QuZm4uaW5pdCh0LCBlKQogICAgICAgICAgICB9LAogICAgICAg
ICAgICBtdCA9IGZ1bmN0aW9uKHQsIGUpIHsKICAgICAgICAgICAgICAgIHJldHVybiBlLnRvVXBw
ZXJDYXNlKCkKICAgICAgICAgICAgfTsKICAgICAgICBndC5mbiA9IGd0LnByb3RvdHlwZSA9IHsK
ICAgICAgICAgICAganF1ZXJ5OiBkdCwKICAgICAgICAgICAgY29uc3RydWN0b3I6IGd0LAogICAg
ICAgICAgICBsZW5ndGg6IDAsCiAgICAgICAgICAgIHRvQXJyYXk6IGZ1bmN0aW9uKCkgewogICAg
ICAgICAgICAgICAgcmV0dXJuIG90LmNhbGwodGhpcykKICAgICAgICAgICAgfSwKICAgICAgICAg
ICAgZ2V0OiBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbCA9PSB0ID8g
b3QuY2FsbCh0aGlzKSA6IHQgPCAwID8gdGhpc1t0ICsgdGhpcy5sZW5ndGhdIDogdGhpc1t0XQog
ICAgICAgICAgICB9LAogICAgICAgICAgICBwdXNoU3RhY2s6IGZ1bmN0aW9uKHQpIHsKICAgICAg
ICAgICAgICAgIHZhciBlID0gZ3QubWVyZ2UodGhpcy5jb25zdHJ1Y3RvcigpLCB0KTsKICAgICAg
ICAgICAgICAgIHJldHVybiBlLnByZXZPYmplY3QgPSB0aGlzLCBlCiAgICAgICAgICAgIH0sCiAg
ICAgICAgICAgIGVhY2g6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIHJldHVybiBndC5l
YWNoKHRoaXMsIHQpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG1hcDogZnVuY3Rpb24odCkg
ewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucHVzaFN0YWNrKGd0Lm1hcCh0aGlzLCBmdW5j
dGlvbihlLCBuKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQuY2FsbChlLCBuLCBlKQog
ICAgICAgICAgICAgICAgfSkpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHNsaWNlOiBmdW5j
dGlvbigpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnB1c2hTdGFjayhvdC5hcHBseSh0
aGlzLCBhcmd1bWVudHMpKQogICAgICAgICAgICB9LAogICAgICAgICAgICBmaXJzdDogZnVuY3Rp
b24oKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5lcSgwKQogICAgICAgICAgICB9LAog
ICAgICAgICAgICBsYXN0OiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlz
LmVxKC0xKQogICAgICAgICAgICB9LAogICAgICAgICAgICBlcTogZnVuY3Rpb24odCkgewogICAg
ICAgICAgICAgICAgdmFyIGUgPSB0aGlzLmxlbmd0aCwKICAgICAgICAgICAgICAgICAgICBuID0g
K3QgKyAodCA8IDAgPyBlIDogMCk7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wdXNoU3Rh
Y2sobiA+PSAwICYmIG4gPCBlID8gW3RoaXNbbl1dIDogW10pCiAgICAgICAgICAgIH0sCiAgICAg
ICAgICAgIGVuZDogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wcmV2
T2JqZWN0IHx8IHRoaXMuY29uc3RydWN0b3IoKQogICAgICAgICAgICB9LAogICAgICAgICAgICBw
dXNoOiBzdCwKICAgICAgICAgICAgc29ydDogZXQuc29ydCwKICAgICAgICAgICAgc3BsaWNlOiBl
dC5zcGxpY2UKICAgICAgICB9LCBndC5leHRlbmQgPSBndC5mbi5leHRlbmQgPSBmdW5jdGlvbigp
IHsKICAgICAgICAgICAgdmFyIHQsIGUsIG4sIGksIG8sIHIsIHMgPSBhcmd1bWVudHNbMF0gfHwg
e30sCiAgICAgICAgICAgICAgICBhID0gMSwKICAgICAgICAgICAgICAgIHUgPSBhcmd1bWVudHMu
bGVuZ3RoLAogICAgICAgICAgICAgICAgbCA9ICExOwogICAgICAgICAgICBmb3IgKCJib29sZWFu
IiA9PSB0eXBlb2YgcyAmJiAobCA9IHMsIHMgPSBhcmd1bWVudHNbYV0gfHwge30sIGErKyksICJv
YmplY3QiID09IHR5cGVvZiBzIHx8IGd0LmlzRnVuY3Rpb24ocykgfHwgKHMgPSB7fSksIGEgPT09
IHUgJiYgKHMgPSB0aGlzLCBhLS0pOyBhIDwgdTsgYSsrKQogICAgICAgICAgICAgICAgaWYgKG51
bGwgIT0gKHQgPSBhcmd1bWVudHNbYV0pKQogICAgICAgICAgICAgICAgICAgIGZvciAoZSBpbiB0
KSBuID0gc1tlXSwgaSA9IHRbZV0sIHMgIT09IGkgJiYgKGwgJiYgaSAmJiAoZ3QuaXNQbGFpbk9i
amVjdChpKSB8fCAobyA9IEFycmF5LmlzQXJyYXkoaSkpKSA/IChvID8gKG8gPSAhMSwgciA9IG4g
JiYgQXJyYXkuaXNBcnJheShuKSA/IG4gOiBbXSkgOiByID0gbiAmJiBndC5pc1BsYWluT2JqZWN0
KG4pID8gbiA6IHt9LCBzW2VdID0gZ3QuZXh0ZW5kKGwsIHIsIGkpKSA6IHZvaWQgMCAhPT0gaSAm
JiAoc1tlXSA9IGkpKTsKICAgICAgICAgICAgcmV0dXJuIHMKICAgICAgICB9LCBndC5leHRlbmQo
ewogICAgICAgICAgICBleHBhbmRvOiAialF1ZXJ5IiArIChkdCArIE1hdGgucmFuZG9tKCkpLnJl
cGxhY2UoL1xEL2csICIiKSwKICAgICAgICAgICAgaXNSZWFkeTogITAsCiAgICAgICAgICAgIGVy
cm9yOiBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IodCkKICAg
ICAgICAgICAgfSwKICAgICAgICAgICAgbm9vcDogZnVuY3Rpb24oKSB7fSwKICAgICAgICAgICAg
aXNGdW5jdGlvbjogZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgcmV0dXJuICJmdW5jdGlv
biIgPT09IGd0LnR5cGUodCkKICAgICAgICAgICAgfSwKICAgICAgICAgICAgaXNXaW5kb3c6IGZ1
bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIHJldHVybiBudWxsICE9IHQgJiYgdCA9PT0gdC53
aW5kb3cKICAgICAgICAgICAgfSwKICAgICAgICAgICAgaXNOdW1lcmljOiBmdW5jdGlvbih0KSB7
CiAgICAgICAgICAgICAgICB2YXIgZSA9IGd0LnR5cGUodCk7CiAgICAgICAgICAgICAgICByZXR1
cm4gKCJudW1iZXIiID09PSBlIHx8ICJzdHJpbmciID09PSBlKSAmJiAhaXNOYU4odCAtIHBhcnNl
RmxvYXQodCkpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGlzUGxhaW5PYmplY3Q6IGZ1bmN0
aW9uKHQpIHsKICAgICAgICAgICAgICAgIHZhciBlLCBuOwogICAgICAgICAgICAgICAgcmV0dXJu
ICEoIXQgfHwgIltvYmplY3QgT2JqZWN0XSIgIT09IGx0LmNhbGwodCkgfHwgKGUgPSBpdCh0KSkg
JiYgKCJmdW5jdGlvbiIgIT0gdHlwZW9mKG4gPSBjdC5jYWxsKGUsICJjb25zdHJ1Y3RvciIpICYm
IGUuY29uc3RydWN0b3IpIHx8IHB0LmNhbGwobikgIT09IGh0KSkKICAgICAgICAgICAgfSwKICAg
ICAgICAgICAgaXNFbXB0eU9iamVjdDogZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgdmFy
IGU7CiAgICAgICAgICAgICAgICBmb3IgKGUgaW4gdCkgcmV0dXJuICExOwogICAgICAgICAgICAg
ICAgcmV0dXJuICEwCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHR5cGU6IGZ1bmN0aW9uKHQp
IHsKICAgICAgICAgICAgICAgIHJldHVybiBudWxsID09IHQgPyB0ICsgIiIgOiAib2JqZWN0IiA9
PSB0eXBlb2YgdCB8fCAiZnVuY3Rpb24iID09IHR5cGVvZiB0ID8gdXRbbHQuY2FsbCh0KV0gfHwg
Im9iamVjdCIgOiB0eXBlb2YgdAogICAgICAgICAgICB9LAogICAgICAgICAgICBnbG9iYWxFdmFs
OiBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICBuKHQpCiAgICAgICAgICAgIH0sCiAgICAg
ICAgICAgIGNhbWVsQ2FzZTogZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHQu
cmVwbGFjZSgvXi1tcy0vLCAibXMtIikucmVwbGFjZSgvLShbYS16XSkvZywgbXQpCiAgICAgICAg
ICAgIH0sCiAgICAgICAgICAgIGVhY2g6IGZ1bmN0aW9uKHQsIGUpIHsKICAgICAgICAgICAgICAg
IHZhciBuLCBvID0gMDsKICAgICAgICAgICAgICAgIGlmIChpKHQpKQogICAgICAgICAgICAgICAg
ICAgIGZvciAobiA9IHQubGVuZ3RoOyBvIDwgbiAmJiAhMSAhPT0gZS5jYWxsKHRbb10sIG8sIHRb
b10pOyBvKyspOwogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIGZvciAo
byBpbiB0KQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoITEgPT09IGUuY2FsbCh0W29dLCBv
LCB0W29dKSkgYnJlYWs7IHJldHVybiB0CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHRyaW06
IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIHJldHVybiBudWxsID09IHQgPyAiIiA6ICh0
ICsgIiIpLnJlcGxhY2UoL15bXHNcdUZFRkZceEEwXSt8W1xzXHVGRUZGXHhBMF0rJC9nLCAiIikK
ICAgICAgICAgICAgfSwKICAgICAgICAgICAgbWFrZUFycmF5OiBmdW5jdGlvbih0LCBlKSB7CiAg
ICAgICAgICAgICAgICB2YXIgbiA9IGUgfHwgW107CiAgICAgICAgICAgICAgICByZXR1cm4gbnVs
bCAhPSB0ICYmIChpKE9iamVjdCh0KSkgPyBndC5tZXJnZShuLCAic3RyaW5nIiA9PSB0eXBlb2Yg
dCA/IFt0XSA6IHQpIDogc3QuY2FsbChuLCB0KSksIG4KICAgICAgICAgICAgfSwKICAgICAgICAg
ICAgaW5BcnJheTogZnVuY3Rpb24odCwgZSwgbikgewogICAgICAgICAgICAgICAgcmV0dXJuIG51
bGwgPT0gZSA/IC0xIDogYXQuY2FsbChlLCB0LCBuKQogICAgICAgICAgICB9LAogICAgICAgICAg
ICBtZXJnZTogZnVuY3Rpb24odCwgZSkgewogICAgICAgICAgICAgICAgZm9yICh2YXIgbiA9ICtl
Lmxlbmd0aCwgaSA9IDAsIG8gPSB0Lmxlbmd0aDsgaSA8IG47IGkrKykgdFtvKytdID0gZVtpXTsK
ICAgICAgICAgICAgICAgIHJldHVybiB0Lmxlbmd0aCA9IG8sIHQKICAgICAgICAgICAgfSwKICAg
ICAgICAgICAgZ3JlcDogZnVuY3Rpb24odCwgZSwgbikgewogICAgICAgICAgICAgICAgZm9yICh2
YXIgaSA9IFtdLCBvID0gMCwgciA9IHQubGVuZ3RoLCBzID0gIW47IG8gPCByOyBvKyspICFlKHRb
b10sIG8pICE9PSBzICYmIGkucHVzaCh0W29dKTsKICAgICAgICAgICAgICAgIHJldHVybiBpCiAg
ICAgICAgICAgIH0sCiAgICAgICAgICAgIG1hcDogZnVuY3Rpb24odCwgZSwgbikgewogICAgICAg
ICAgICAgICAgdmFyIG8sIHIsIHMgPSAwLAogICAgICAgICAgICAgICAgICAgIGEgPSBbXTsKICAg
ICAgICAgICAgICAgIGlmIChpKHQpKQogICAgICAgICAgICAgICAgICAgIGZvciAobyA9IHQubGVu
Z3RoOyBzIDwgbzsgcysrKSBudWxsICE9IChyID0gZSh0W3NdLCBzLCBuKSkgJiYgYS5wdXNoKHIp
OwogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIGZvciAocyBpbiB0KSBu
dWxsICE9IChyID0gZSh0W3NdLCBzLCBuKSkgJiYgYS5wdXNoKHIpOwogICAgICAgICAgICAgICAg
cmV0dXJuIHJ0LmFwcGx5KFtdLCBhKQogICAgICAgICAgICB9LAogICAgICAgICAgICBndWlkOiAx
LAogICAgICAgICAgICBwcm94eTogZnVuY3Rpb24odCwgZSkgewogICAgICAgICAgICAgICAgdmFy
IG4sIGksIG87CiAgICAgICAgICAgICAgICBpZiAoInN0cmluZyIgPT0gdHlwZW9mIGUgJiYgKG4g
PSB0W2VdLCBlID0gdCwgdCA9IG4pLCBndC5pc0Z1bmN0aW9uKHQpKSByZXR1cm4gaSA9IG90LmNh
bGwoYXJndW1lbnRzLCAyKSwgbyA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHJl
dHVybiB0LmFwcGx5KGUgfHwgdGhpcywgaS5jb25jYXQob3QuY2FsbChhcmd1bWVudHMpKSkKICAg
ICAgICAgICAgICAgIH0sIG8uZ3VpZCA9IHQuZ3VpZCA9IHQuZ3VpZCB8fCBndC5ndWlkKyssIG8K
ICAgICAgICAgICAgfSwKICAgICAgICAgICAgbm93OiBEYXRlLm5vdywKICAgICAgICAgICAgc3Vw
cG9ydDogZnQKICAgICAgICB9KSwgImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmIChndC5m
bltTeW1ib2wuaXRlcmF0b3JdID0gZXRbU3ltYm9sLml0ZXJhdG9yXSksIGd0LmVhY2goIkJvb2xl
YW4gTnVtYmVyIFN0cmluZyBGdW5jdGlvbiBBcnJheSBEYXRlIFJlZ0V4cCBPYmplY3QgRXJyb3Ig
U3ltYm9sIi5zcGxpdCgiICIpLCBmdW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAgIHV0WyJbb2Jq
ZWN0ICIgKyBlICsgIl0iXSA9IGUudG9Mb3dlckNhc2UoKQogICAgICAgIH0pOwogICAgICAgIHZh
ciB2dCA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgZnVuY3Rpb24gZSh0LCBlLCBuLCBpKSB7
CiAgICAgICAgICAgICAgICB2YXIgbywgciwgcywgYSwgdSwgYywgaCwgZiA9IGUgJiYgZS5vd25l
ckRvY3VtZW50LAogICAgICAgICAgICAgICAgICAgIGQgPSBlID8gZS5ub2RlVHlwZSA6IDk7CiAg
ICAgICAgICAgICAgICBpZiAobiA9IG4gfHwgW10sICJzdHJpbmciICE9IHR5cGVvZiB0IHx8ICF0
IHx8IDEgIT09IGQgJiYgOSAhPT0gZCAmJiAxMSAhPT0gZCkgcmV0dXJuIG47CiAgICAgICAgICAg
ICAgICBpZiAoIWkgJiYgKChlID8gZS5vd25lckRvY3VtZW50IHx8IGUgOiBPKSAhPT0gaiAmJiBN
KGUpLCBlID0gZSB8fCBqLCAkKSkgewogICAgICAgICAgICAgICAgICAgIGlmICgxMSAhPT0gZCAm
JiAodSA9IGd0LmV4ZWModCkpKQogICAgICAgICAgICAgICAgICAgICAgICBpZiAobyA9IHVbMV0p
IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICg5ID09PSBkKSB7CiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgaWYgKCEocyA9IGUuZ2V0RWxlbWVudEJ5SWQobykpKSByZXR1
cm4gbjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocy5pZCA9PT0gbykgcmV0
dXJuIG4ucHVzaChzKSwgbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChm
ICYmIChzID0gZi5nZXRFbGVtZW50QnlJZChvKSkgJiYgSShlLCBzKSAmJiBzLmlkID09PSBvKSBy
ZXR1cm4gbi5wdXNoKHMpLCBuCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBpZiAodVsyXSkgcmV0dXJuIEcuYXBwbHkobiwgZS5nZXRF
bGVtZW50c0J5VGFnTmFtZSh0KSksIG47CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAo
KG8gPSB1WzNdKSAmJiBiLmdldEVsZW1lbnRzQnlDbGFzc05hbWUgJiYgZS5nZXRFbGVtZW50c0J5
Q2xhc3NOYW1lKSByZXR1cm4gRy5hcHBseShuLCBlLmdldEVsZW1lbnRzQnlDbGFzc05hbWUobykp
LCBuCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoYi5x
c2EgJiYgIXpbdCArICIgIl0gJiYgKCFQIHx8ICFQLnRlc3QodCkpKSB7CiAgICAgICAgICAgICAg
ICAgICAgICAgIGlmICgxICE9PSBkKSBmID0gZSwgaCA9IHQ7CiAgICAgICAgICAgICAgICAgICAg
ICAgIGVsc2UgaWYgKCJvYmplY3QiICE9PSBlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkpIHsKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoKGEgPSBlLmdldEF0dHJpYnV0ZSgiaWQiKSkg
PyBhID0gYS5yZXBsYWNlKHh0LCBidCkgOiBlLnNldEF0dHJpYnV0ZSgiaWQiLCBhID0gRiksIGMg
PSBTKHQpLCByID0gYy5sZW5ndGg7IHItLTspIGNbcl0gPSAiIyIgKyBhICsgIiAiICsgcChjW3Jd
KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGggPSBjLmpvaW4oIiwiKSwgZiA9IG10LnRl
c3QodCkgJiYgbChlLnBhcmVudE5vZGUpIHx8IGUKICAgICAgICAgICAgICAgICAgICAgICAgfQog
ICAgICAgICAgICAgICAgICAgICAgICBpZiAoaCkgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHJldHVybiBHLmFwcGx5KG4sIGYucXVlcnlTZWxlY3RvckFsbChoKSksIG4KICAgICAg
ICAgICAgICAgICAgICAgICAgfSBjYXRjaCAodCkge30gZmluYWxseSB7CiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBhID09PSBGICYmIGUucmVtb3ZlQXR0cmlidXRlKCJpZCIpCiAgICAgICAg
ICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9
CiAgICAgICAgICAgICAgICByZXR1cm4gQSh0LnJlcGxhY2UocnQsICIkMSIpLCBlLCBuLCBpKQog
ICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiBuKCkgewogICAgICAgICAgICAgICAg
ZnVuY3Rpb24gdChuLCBpKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGUucHVzaChuICsg
IiAiKSA+IFQuY2FjaGVMZW5ndGggJiYgZGVsZXRlIHRbZS5zaGlmdCgpXSwgdFtuICsgIiAiXSA9
IGkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHZhciBlID0gW107CiAgICAgICAg
ICAgICAgICByZXR1cm4gdAogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiBpKHQp
IHsKICAgICAgICAgICAgICAgIHJldHVybiB0W0ZdID0gITAsIHQKICAgICAgICAgICAgfQoKICAg
ICAgICAgICAgZnVuY3Rpb24gbyh0KSB7CiAgICAgICAgICAgICAgICB2YXIgZSA9IGouY3JlYXRl
RWxlbWVudCgiZmllbGRzZXQiKTsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAg
ICAgICAgcmV0dXJuICEhdChlKQogICAgICAgICAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAg
ICAgICAgICAgICAgIHJldHVybiAhMQogICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAg
ICAgICAgICAgICAgICBlLnBhcmVudE5vZGUgJiYgZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGUp
LCBlID0gbnVsbAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBm
dW5jdGlvbiByKHQsIGUpIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIG4gPSB0LnNwbGl0KCJ8
IiksIGkgPSBuLmxlbmd0aDsgaS0tOykgVC5hdHRySGFuZGxlW25baV1dID0gZQogICAgICAgICAg
ICB9CgogICAgICAgICAgICBmdW5jdGlvbiBzKHQsIGUpIHsKICAgICAgICAgICAgICAgIHZhciBu
ID0gZSAmJiB0LAogICAgICAgICAgICAgICAgICAgIGkgPSBuICYmIDEgPT09IHQubm9kZVR5cGUg
JiYgMSA9PT0gZS5ub2RlVHlwZSAmJiB0LnNvdXJjZUluZGV4IC0gZS5zb3VyY2VJbmRleDsKICAg
ICAgICAgICAgICAgIGlmIChpKSByZXR1cm4gaTsKICAgICAgICAgICAgICAgIGlmIChuKQogICAg
ICAgICAgICAgICAgICAgIGZvciAoOyBuID0gbi5uZXh0U2libGluZzspCiAgICAgICAgICAgICAg
ICAgICAgICAgIGlmIChuID09PSBlKSByZXR1cm4gLTE7CiAgICAgICAgICAgICAgICByZXR1cm4g
dCA/IDEgOiAtMQogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiBhKHQpIHsKICAg
ICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0
dXJuICJmb3JtIiBpbiBlID8gZS5wYXJlbnROb2RlICYmICExID09PSBlLmRpc2FibGVkID8gImxh
YmVsIiBpbiBlID8gImxhYmVsIiBpbiBlLnBhcmVudE5vZGUgPyBlLnBhcmVudE5vZGUuZGlzYWJs
ZWQgPT09IHQgOiBlLmRpc2FibGVkID09PSB0IDogZS5pc0Rpc2FibGVkID09PSB0IHx8IGUuaXNE
aXNhYmxlZCAhPT0gIXQgJiYgd3QoZSkgPT09IHQgOiBlLmRpc2FibGVkID09PSB0IDogImxhYmVs
IiBpbiBlICYmIGUuZGlzYWJsZWQgPT09IHQKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg
fQoKICAgICAgICAgICAgZnVuY3Rpb24gdSh0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gaShm
dW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGUgPSArZSwgaShmdW5jdGlv
bihuLCBpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIG8sIHIgPSB0KFtdLCBu
Lmxlbmd0aCwgZSksIHMgPSByLmxlbmd0aDsgcy0tOykgbltvID0gcltzXV0gJiYgKG5bb10gPSAh
KGlbb10gPSBuW29dKSkKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfSkK
ICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gbCh0KSB7CiAgICAgICAgICAgICAg
ICByZXR1cm4gdCAmJiB2b2lkIDAgIT09IHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUgJiYgdAogICAg
ICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiBjKCkge30KCiAgICAgICAgICAgIGZ1bmN0
aW9uIHAodCkgewogICAgICAgICAgICAgICAgZm9yICh2YXIgZSA9IDAsIG4gPSB0Lmxlbmd0aCwg
aSA9ICIiOyBlIDwgbjsgZSsrKSBpICs9IHRbZV0udmFsdWU7CiAgICAgICAgICAgICAgICByZXR1
cm4gaQogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiBoKHQsIGUsIG4pIHsKICAg
ICAgICAgICAgICAgIHZhciBpID0gZS5kaXIsCiAgICAgICAgICAgICAgICAgICAgbyA9IGUubmV4
dCwKICAgICAgICAgICAgICAgICAgICByID0gbyB8fCBpLAogICAgICAgICAgICAgICAgICAgIHMg
PSBuICYmICJwYXJlbnROb2RlIiA9PT0gciwKICAgICAgICAgICAgICAgICAgICBhID0gVysrOwog
ICAgICAgICAgICAgICAgcmV0dXJuIGUuZmlyc3QgPyBmdW5jdGlvbihlLCBuLCBvKSB7CiAgICAg
ICAgICAgICAgICAgICAgZm9yICg7IGUgPSBlW2ldOykKICAgICAgICAgICAgICAgICAgICAgICAg
aWYgKDEgPT09IGUubm9kZVR5cGUgfHwgcykgcmV0dXJuIHQoZSwgbiwgbyk7CiAgICAgICAgICAg
ICAgICAgICAgcmV0dXJuICExCiAgICAgICAgICAgICAgICB9IDogZnVuY3Rpb24oZSwgbiwgdSkg
ewogICAgICAgICAgICAgICAgICAgIHZhciBsLCBjLCBwLCBoID0gW0gsIGFdOwogICAgICAgICAg
ICAgICAgICAgIGlmICh1KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoOyBlID0gZVtp
XTspCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKDEgPT09IGUubm9kZVR5cGUgfHwg
cykgJiYgdChlLCBuLCB1KSkgcmV0dXJuICEwCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlCiAg
ICAgICAgICAgICAgICAgICAgICAgIGZvciAoOyBlID0gZVtpXTspCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBpZiAoMSA9PT0gZS5ub2RlVHlwZSB8fCBzKQogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGlmIChwID0gZVtGXSB8fCAoZVtGXSA9IHt9KSwgYyA9IHBbZS51bmlxdWVJ
RF0gfHwgKHBbZS51bmlxdWVJRF0gPSB7fSksIG8gJiYgbyA9PT0gZS5ub2RlTmFtZS50b0xvd2Vy
Q2FzZSgpKSBlID0gZVtpXSB8fCBlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVs
c2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKGwgPSBjW3JdKSAm
JiBsWzBdID09PSBIICYmIGxbMV0gPT09IGEpIHJldHVybiBoWzJdID0gbFsyXTsKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNbcl0gPSBoLCBoWzJdID0gdChlLCBuLCB1
KSkgcmV0dXJuICEwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSByZXR1cm4gITEK
ICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gZih0
KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdC5sZW5ndGggPiAxID8gZnVuY3Rpb24oZSwgbiwg
aSkgewogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIG8gPSB0Lmxlbmd0aDsgby0tOykKICAg
ICAgICAgICAgICAgICAgICAgICAgaWYgKCF0W29dKGUsIG4sIGkpKSByZXR1cm4gITE7CiAgICAg
ICAgICAgICAgICAgICAgcmV0dXJuICEwCiAgICAgICAgICAgICAgICB9IDogdFswXQogICAgICAg
ICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiBkKHQsIG4sIGkpIHsKICAgICAgICAgICAgICAg
IGZvciAodmFyIG8gPSAwLCByID0gbi5sZW5ndGg7IG8gPCByOyBvKyspIGUodCwgbltvXSwgaSk7
CiAgICAgICAgICAgICAgICByZXR1cm4gaQogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5j
dGlvbiBnKHQsIGUsIG4sIGksIG8pIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIHIsIHMgPSBb
XSwgYSA9IDAsIHUgPSB0Lmxlbmd0aCwgbCA9IG51bGwgIT0gZTsgYSA8IHU7IGErKykociA9IHRb
YV0pICYmIChuICYmICFuKHIsIGksIG8pIHx8IChzLnB1c2gociksIGwgJiYgZS5wdXNoKGEpKSk7
CiAgICAgICAgICAgICAgICByZXR1cm4gcwogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5j
dGlvbiBtKHQsIGUsIG4sIG8sIHIsIHMpIHsKICAgICAgICAgICAgICAgIHJldHVybiBvICYmICFv
W0ZdICYmIChvID0gbShvKSksIHIgJiYgIXJbRl0gJiYgKHIgPSBtKHIsIHMpKSwgaShmdW5jdGlv
bihpLCBzLCBhLCB1KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGwsIGMsIHAsIGggPSBbXSwK
ICAgICAgICAgICAgICAgICAgICAgICAgZiA9IFtdLAogICAgICAgICAgICAgICAgICAgICAgICBt
ID0gcy5sZW5ndGgsCiAgICAgICAgICAgICAgICAgICAgICAgIHYgPSBpIHx8IGQoZSB8fCAiKiIs
IGEubm9kZVR5cGUgPyBbYV0gOiBhLCBbXSksCiAgICAgICAgICAgICAgICAgICAgICAgIHkgPSAh
dCB8fCAhaSAmJiBlID8gdiA6IGcodiwgaCwgdCwgYSwgdSksCiAgICAgICAgICAgICAgICAgICAg
ICAgIHggPSBuID8gciB8fCAoaSA/IHQgOiBtIHx8IG8pID8gW10gOiBzIDogeTsKICAgICAgICAg
ICAgICAgICAgICBpZiAobiAmJiBuKHksIHgsIGEsIHUpLCBvKQogICAgICAgICAgICAgICAgICAg
ICAgICBmb3IgKGwgPSBnKHgsIGYpLCBvKGwsIFtdLCBhLCB1KSwgYyA9IGwubGVuZ3RoOyBjLS07
KShwID0gbFtjXSkgJiYgKHhbZltjXV0gPSAhKHlbZltjXV0gPSBwKSk7CiAgICAgICAgICAgICAg
ICAgICAgaWYgKGkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHIgfHwgdCkgewogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHIpIHsKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBmb3IgKGwgPSBbXSwgYyA9IHgubGVuZ3RoOyBjLS07KShwID0geFtjXSkgJiYgbC5w
dXNoKHlbY10gPSBwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByKG51bGwsIHgg
PSBbXSwgbCwgdSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGZvciAoYyA9IHgubGVuZ3RoOyBjLS07KShwID0geFtjXSkgJiYgKGwgPSBy
ID8gSyhpLCBwKSA6IGhbY10pID4gLTEgJiYgKGlbbF0gPSAhKHNbbF0gPSBwKSkKICAgICAgICAg
ICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB4ID0gZyh4ID09PSBz
ID8geC5zcGxpY2UobSwgeC5sZW5ndGgpIDogeCksIHIgPyByKG51bGwsIHMsIHgsIHUpIDogRy5h
cHBseShzLCB4KQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfQoKICAgICAgICAgICAg
ZnVuY3Rpb24gdih0KSB7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBlLCBuLCBpLCBvID0gdC5s
ZW5ndGgsIHIgPSBULnJlbGF0aXZlW3RbMF0udHlwZV0sIHMgPSByIHx8IFQucmVsYXRpdmVbIiAi
XSwgYSA9IHIgPyAxIDogMCwgdSA9IGgoZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAg
ICAgICByZXR1cm4gdCA9PT0gZQogICAgICAgICAgICAgICAgICAgIH0sIHMsICEwKSwgbCA9IGgo
ZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gSyhlLCB0KSA+IC0x
CiAgICAgICAgICAgICAgICAgICAgfSwgcywgITApLCBjID0gW2Z1bmN0aW9uKHQsIG4sIGkpIHsK
ICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG8gPSAhciAmJiAoaSB8fCBuICE9PSBrKSB8fCAo
KGUgPSBuKS5ub2RlVHlwZSA/IHUodCwgbiwgaSkgOiBsKHQsIG4sIGkpKTsKICAgICAgICAgICAg
ICAgICAgICAgICAgcmV0dXJuIGUgPSBudWxsLCBvCiAgICAgICAgICAgICAgICAgICAgfV07IGEg
PCBvOyBhKyspCiAgICAgICAgICAgICAgICAgICAgaWYgKG4gPSBULnJlbGF0aXZlW3RbYV0udHlw
ZV0pIGMgPSBbaChmKGMpLCBuKV07CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAg
ICAgICAgICAgICAgICAgIGlmIChuID0gVC5maWx0ZXJbdFthXS50eXBlXS5hcHBseShudWxsLCB0
W2FdLm1hdGNoZXMpLCBuW0ZdKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGkg
PSArK2E7IGkgPCBvICYmICFULnJlbGF0aXZlW3RbaV0udHlwZV07IGkrKyk7CiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICByZXR1cm4gbShhID4gMSAmJiBmKGMpLCBhID4gMSAmJiBwKHQuc2xp
Y2UoMCwgYSAtIDEpLmNvbmNhdCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFs
dWU6ICIgIiA9PT0gdFthIC0gMl0udHlwZSA/ICIqIiA6ICIiCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB9KSkucmVwbGFjZShydCwgIiQxIiksIG4sIGEgPCBpICYmIHYodC5zbGljZShhLCBp
KSksIGkgPCBvICYmIHYodCA9IHQuc2xpY2UoaSkpLCBpIDwgbyAmJiBwKHQpKQogICAgICAgICAg
ICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGMucHVzaChuKQogICAgICAg
ICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBmKGMpCiAgICAgICAgICAgIH0K
CiAgICAgICAgICAgIGZ1bmN0aW9uIHkodCwgbikgewogICAgICAgICAgICAgICAgdmFyIG8gPSBu
Lmxlbmd0aCA+IDAsCiAgICAgICAgICAgICAgICAgICAgciA9IHQubGVuZ3RoID4gMCwKICAgICAg
ICAgICAgICAgICAgICBzID0gZnVuY3Rpb24oaSwgcywgYSwgdSwgbCkgewogICAgICAgICAgICAg
ICAgICAgICAgICB2YXIgYywgcCwgaCwgZiA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBkID0gIjAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbSA9IGkgJiYgW10sCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB2ID0gW10sCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB5ID0gaywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHggPSBpIHx8IHIgJiYgVC5maW5k
LlRBRygiKiIsIGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYiA9IEggKz0gbnVsbCA9
PSB5ID8gMSA6IE1hdGgucmFuZG9tKCkgfHwgLjEsCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB3ID0geC5sZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobCAmJiAoayA9IHMg
PT09IGogfHwgcyB8fCBsKTsgZCAhPT0gdyAmJiBudWxsICE9IChjID0geFtkXSk7IGQrKykgewog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHIgJiYgYykgewogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGZvciAocCA9IDAsIHMgfHwgYy5vd25lckRvY3VtZW50ID09PSBqIHx8
IChNKGMpLCBhID0gISQpOyBoID0gdFtwKytdOykKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgaWYgKGgoYywgcyB8fCBqLCBhKSkgewogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdS5wdXNoKGMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwgJiYgKEggPSBiKQogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbyAmJiAoKGMgPSAhaCAm
JiBjKSAmJiBmLS0sIGkgJiYgbS5wdXNoKGMpKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAg
ICAgICAgICAgICAgICAgICAgICAgIGlmIChmICs9IGQsIG8gJiYgZCAhPT0gZikgewogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgZm9yIChwID0gMDsgaCA9IG5bcCsrXTspIGgobSwgdiwgcywg
YSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSkgewogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGlmIChmID4gMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgZm9yICg7IGQtLTspIG1bZF0gfHwgdltkXSB8fCAodltkXSA9IFUuY2FsbCh1KSk7CiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdiA9IGcodikKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEcuYXBwbHkodSwgdiksIGwg
JiYgIWkgJiYgdi5sZW5ndGggPiAwICYmIGYgKyBuLmxlbmd0aCA+IDEgJiYgZS51bmlxdWVTb3J0
KHUpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0
dXJuIGwgJiYgKEggPSBiLCBrID0geSksIG0KICAgICAgICAgICAgICAgICAgICB9OwogICAgICAg
ICAgICAgICAgcmV0dXJuIG8gPyBpKHMpIDogcwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZh
ciB4LCBiLCBULCB3LCBDLCBTLCBFLCBBLCBrLCBELCBOLCBNLCBqLCBMLCAkLCBQLCBxLCBSLCBJ
LCBGID0gInNpenpsZSIgKyAxICogbmV3IERhdGUsCiAgICAgICAgICAgICAgICBPID0gdC5kb2N1
bWVudCwKICAgICAgICAgICAgICAgIEggPSAwLAogICAgICAgICAgICAgICAgVyA9IDAsCiAgICAg
ICAgICAgICAgICBfID0gbigpLAogICAgICAgICAgICAgICAgQiA9IG4oKSwKICAgICAgICAgICAg
ICAgIHogPSBuKCksCiAgICAgICAgICAgICAgICBYID0gZnVuY3Rpb24odCwgZSkgewogICAgICAg
ICAgICAgICAgICAgIHJldHVybiB0ID09PSBlICYmIChOID0gITApLCAwCiAgICAgICAgICAgICAg
ICB9LAogICAgICAgICAgICAgICAgWSA9IHt9Lmhhc093blByb3BlcnR5LAogICAgICAgICAgICAg
ICAgViA9IFtdLAogICAgICAgICAgICAgICAgVSA9IFYucG9wLAogICAgICAgICAgICAgICAgUSA9
IFYucHVzaCwKICAgICAgICAgICAgICAgIEcgPSBWLnB1c2gsCiAgICAgICAgICAgICAgICBKID0g
Vi5zbGljZSwKICAgICAgICAgICAgICAgIEsgPSBmdW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAg
ICAgICAgICAgZm9yICh2YXIgbiA9IDAsIGkgPSB0Lmxlbmd0aDsgbiA8IGk7IG4rKykKICAgICAg
ICAgICAgICAgICAgICAgICAgaWYgKHRbbl0gPT09IGUpIHJldHVybiBuOwogICAgICAgICAgICAg
ICAgICAgIHJldHVybiAtMQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIFogPSAi
Y2hlY2tlZHxzZWxlY3RlZHxhc3luY3xhdXRvZm9jdXN8YXV0b3BsYXl8Y29udHJvbHN8ZGVmZXJ8
ZGlzYWJsZWR8aGlkZGVufGlzbWFwfGxvb3B8bXVsdGlwbGV8b3BlbnxyZWFkb25seXxyZXF1aXJl
ZHxzY29wZWQiLAogICAgICAgICAgICAgICAgdHQgPSAiW1xceDIwXFx0XFxyXFxuXFxmXSIsCiAg
ICAgICAgICAgICAgICBldCA9ICIoPzpcXFxcLnxbXFx3LV18W15cMC1cXHhhMF0pKyIsCiAgICAg
ICAgICAgICAgICBudCA9ICJcXFsiICsgdHQgKyAiKigiICsgZXQgKyAiKSg/OiIgKyB0dCArICIq
KFsqXiR8IX5dPz0pIiArIHR0ICsgIiooPzonKCg/OlxcXFwufFteXFxcXCddKSopJ3xcIigoPzpc
XFxcLnxbXlxcXFxcIl0pKilcInwoIiArIGV0ICsgIikpfCkiICsgdHQgKyAiKlxcXSIsCiAgICAg
ICAgICAgICAgICBpdCA9ICI6KCIgKyBldCArICIpKD86XFwoKCgnKCg/OlxcXFwufFteXFxcXCdd
KSopJ3xcIigoPzpcXFxcLnxbXlxcXFxcIl0pKilcIil8KCg/OlxcXFwufFteXFxcXCgpW1xcXV18
IiArIG50ICsgIikqKXwuKilcXCl8KSIsCiAgICAgICAgICAgICAgICBvdCA9IG5ldyBSZWdFeHAo
dHQgKyAiKyIsICJnIiksCiAgICAgICAgICAgICAgICBydCA9IG5ldyBSZWdFeHAoIl4iICsgdHQg
KyAiK3woKD86XnxbXlxcXFxdKSg/OlxcXFwuKSopIiArIHR0ICsgIiskIiwgImciKSwKICAgICAg
ICAgICAgICAgIHN0ID0gbmV3IFJlZ0V4cCgiXiIgKyB0dCArICIqLCIgKyB0dCArICIqIiksCiAg
ICAgICAgICAgICAgICBhdCA9IG5ldyBSZWdFeHAoIl4iICsgdHQgKyAiKihbPit+XXwiICsgdHQg
KyAiKSIgKyB0dCArICIqIiksCiAgICAgICAgICAgICAgICB1dCA9IG5ldyBSZWdFeHAoIj0iICsg
dHQgKyAiKihbXlxcXSdcIl0qPykiICsgdHQgKyAiKlxcXSIsICJnIiksCiAgICAgICAgICAgICAg
ICBsdCA9IG5ldyBSZWdFeHAoaXQpLAogICAgICAgICAgICAgICAgY3QgPSBuZXcgUmVnRXhwKCJe
IiArIGV0ICsgIiQiKSwKICAgICAgICAgICAgICAgIHB0ID0gewogICAgICAgICAgICAgICAgICAg
IElEOiBuZXcgUmVnRXhwKCJeIygiICsgZXQgKyAiKSIpLAogICAgICAgICAgICAgICAgICAgIENM
QVNTOiBuZXcgUmVnRXhwKCJeXFwuKCIgKyBldCArICIpIiksCiAgICAgICAgICAgICAgICAgICAg
VEFHOiBuZXcgUmVnRXhwKCJeKCIgKyBldCArICJ8WypdKSIpLAogICAgICAgICAgICAgICAgICAg
IEFUVFI6IG5ldyBSZWdFeHAoIl4iICsgbnQpLAogICAgICAgICAgICAgICAgICAgIFBTRVVETzog
bmV3IFJlZ0V4cCgiXiIgKyBpdCksCiAgICAgICAgICAgICAgICAgICAgQ0hJTEQ6IG5ldyBSZWdF
eHAoIl46KG9ubHl8Zmlyc3R8bGFzdHxudGh8bnRoLWxhc3QpLShjaGlsZHxvZi10eXBlKSg/Olxc
KCIgKyB0dCArICIqKGV2ZW58b2RkfCgoWystXXwpKFxcZCopbnwpIiArIHR0ICsgIiooPzooWyst
XXwpIiArIHR0ICsgIiooXFxkKyl8KSkiICsgdHQgKyAiKlxcKXwpIiwgImkiKSwKICAgICAgICAg
ICAgICAgICAgICBib29sOiBuZXcgUmVnRXhwKCJeKD86IiArIFogKyAiKSQiLCAiaSIpLAogICAg
ICAgICAgICAgICAgICAgIG5lZWRzQ29udGV4dDogbmV3IFJlZ0V4cCgiXiIgKyB0dCArICIqWz4r
fl18OihldmVufG9kZHxlcXxndHxsdHxudGh8Zmlyc3R8bGFzdCkoPzpcXCgiICsgdHQgKyAiKigo
PzotXFxkKT9cXGQqKSIgKyB0dCArICIqXFwpfCkoPz1bXi1dfCQpIiwgImkiKQogICAgICAgICAg
ICAgICAgfSwKICAgICAgICAgICAgICAgIGh0ID0gL14oPzppbnB1dHxzZWxlY3R8dGV4dGFyZWF8
YnV0dG9uKSQvaSwKICAgICAgICAgICAgICAgIGZ0ID0gL15oXGQkL2ksCiAgICAgICAgICAgICAg
ICBkdCA9IC9eW157XStce1xzKlxbbmF0aXZlIFx3LywKICAgICAgICAgICAgICAgIGd0ID0gL14o
PzojKFtcdy1dKyl8KFx3Kyl8XC4oW1x3LV0rKSkkLywKICAgICAgICAgICAgICAgIG10ID0gL1sr
fl0vLAogICAgICAgICAgICAgICAgdnQgPSBuZXcgUmVnRXhwKCJcXFxcKFtcXGRhLWZdezEsNn0i
ICsgdHQgKyAiP3woIiArIHR0ICsgIil8LikiLCAiaWciKSwKICAgICAgICAgICAgICAgIHl0ID0g
ZnVuY3Rpb24odCwgZSwgbikgewogICAgICAgICAgICAgICAgICAgIHZhciBpID0gIjB4IiArIGUg
LSA2NTUzNjsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gaSAhPT0gaSB8fCBuID8gZSA6IGkg
PCAwID8gU3RyaW5nLmZyb21DaGFyQ29kZShpICsgNjU1MzYpIDogU3RyaW5nLmZyb21DaGFyQ29k
ZShpID4+IDEwIHwgNTUyOTYsIDEwMjMgJiBpIHwgNTYzMjApCiAgICAgICAgICAgICAgICB9LAog
ICAgICAgICAgICAgICAgeHQgPSAvKFtcMC1ceDFmXHg3Zl18Xi0/XGQpfF4tJHxbXlwwLVx4MWZc
eDdmLVx1RkZGRlx3LV0vZywKICAgICAgICAgICAgICAgIGJ0ID0gZnVuY3Rpb24odCwgZSkgewog
ICAgICAgICAgICAgICAgICAgIHJldHVybiBlID8gIlwwIiA9PT0gdCA/ICI/IiA6IHQuc2xpY2Uo
MCwgLTEpICsgIlxcIiArIHQuY2hhckNvZGVBdCh0Lmxlbmd0aCAtIDEpLnRvU3RyaW5nKDE2KSAr
ICIgIiA6ICJcXCIgKyB0CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgVHQgPSBm
dW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICBNKCkKICAgICAgICAgICAgICAgIH0sCiAg
ICAgICAgICAgICAgICB3dCA9IGgoZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgIHJl
dHVybiAhMCA9PT0gdC5kaXNhYmxlZCAmJiAoImZvcm0iIGluIHQgfHwgImxhYmVsIiBpbiB0KQog
ICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICAgIGRpcjogInBhcmVudE5vZGUi
LAogICAgICAgICAgICAgICAgICAgIG5leHQ6ICJsZWdlbmQiCiAgICAgICAgICAgICAgICB9KTsK
ICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIEcuYXBwbHkoViA9IEouY2FsbChPLmNo
aWxkTm9kZXMpLCBPLmNoaWxkTm9kZXMpLCBWW08uY2hpbGROb2Rlcy5sZW5ndGhdLm5vZGVUeXBl
CiAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgICAgICAgIEcgPSB7CiAgICAgICAg
ICAgICAgICAgICAgYXBwbHk6IFYubGVuZ3RoID8gZnVuY3Rpb24odCwgZSkgewogICAgICAgICAg
ICAgICAgICAgICAgICBRLmFwcGx5KHQsIEouY2FsbChlKSkKICAgICAgICAgICAgICAgICAgICB9
IDogZnVuY3Rpb24odCwgZSkgewogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBuID0g
dC5sZW5ndGgsIGkgPSAwOyB0W24rK10gPSBlW2krK107KTsKICAgICAgICAgICAgICAgICAgICAg
ICAgdC5sZW5ndGggPSBuIC0gMQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg
IH0KICAgICAgICAgICAgfQogICAgICAgICAgICBiID0gZS5zdXBwb3J0ID0ge30sIEMgPSBlLmlz
WE1MID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgdmFyIGUgPSB0ICYmICh0Lm93bmVy
RG9jdW1lbnQgfHwgdCkuZG9jdW1lbnRFbGVtZW50OwogICAgICAgICAgICAgICAgcmV0dXJuICEh
ZSAmJiAiSFRNTCIgIT09IGUubm9kZU5hbWUKICAgICAgICAgICAgfSwgTSA9IGUuc2V0RG9jdW1l
bnQgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICB2YXIgZSwgbiwgaSA9IHQgPyB0Lm93
bmVyRG9jdW1lbnQgfHwgdCA6IE87CiAgICAgICAgICAgICAgICByZXR1cm4gaSAhPT0gaiAmJiA5
ID09PSBpLm5vZGVUeXBlICYmIGkuZG9jdW1lbnRFbGVtZW50ID8gKGogPSBpLCBMID0gai5kb2N1
bWVudEVsZW1lbnQsICQgPSAhQyhqKSwgTyAhPT0gaiAmJiAobiA9IGouZGVmYXVsdFZpZXcpICYm
IG4udG9wICE9PSBuICYmIChuLmFkZEV2ZW50TGlzdGVuZXIgPyBuLmFkZEV2ZW50TGlzdGVuZXIo
InVubG9hZCIsIFR0LCAhMSkgOiBuLmF0dGFjaEV2ZW50ICYmIG4uYXR0YWNoRXZlbnQoIm9udW5s
b2FkIiwgVHQpKSwgYi5hdHRyaWJ1dGVzID0gbyhmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAg
ICAgICAgcmV0dXJuIHQuY2xhc3NOYW1lID0gImkiLCAhdC5nZXRBdHRyaWJ1dGUoImNsYXNzTmFt
ZSIpCiAgICAgICAgICAgICAgICB9KSwgYi5nZXRFbGVtZW50c0J5VGFnTmFtZSA9IG8oZnVuY3Rp
b24odCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB0LmFwcGVuZENoaWxkKGouY3JlYXRl
Q29tbWVudCgiIikpLCAhdC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpLmxlbmd0aAogICAgICAg
ICAgICAgICAgfSksIGIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSA9IGR0LnRlc3Qoai5nZXRFbGVt
ZW50c0J5Q2xhc3NOYW1lKSwgYi5nZXRCeUlkID0gbyhmdW5jdGlvbih0KSB7CiAgICAgICAgICAg
ICAgICAgICAgcmV0dXJuIEwuYXBwZW5kQ2hpbGQodCkuaWQgPSBGLCAhai5nZXRFbGVtZW50c0J5
TmFtZSB8fCAhai5nZXRFbGVtZW50c0J5TmFtZShGKS5sZW5ndGgKICAgICAgICAgICAgICAgIH0p
LCBiLmdldEJ5SWQgPyAoVC5maWx0ZXIuSUQgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAg
ICAgICAgdmFyIGUgPSB0LnJlcGxhY2UodnQsIHl0KTsKICAgICAgICAgICAgICAgICAgICByZXR1
cm4gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5nZXRBdHRy
aWJ1dGUoImlkIikgPT09IGUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9
LCBULmZpbmQuSUQgPSBmdW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHZv
aWQgMCAhPT0gZS5nZXRFbGVtZW50QnlJZCAmJiAkKSB7CiAgICAgICAgICAgICAgICAgICAgICAg
IHZhciBuID0gZS5nZXRFbGVtZW50QnlJZCh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0
dXJuIG4gPyBbbl0gOiBbXQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0p
IDogKFQuZmlsdGVyLklEID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgIHZhciBl
ID0gdC5yZXBsYWNlKHZ0LCB5dCk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9u
KHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSB2b2lkIDAgIT09IHQuZ2V0QXR0
cmlidXRlTm9kZSAmJiB0LmdldEF0dHJpYnV0ZU5vZGUoImlkIik7CiAgICAgICAgICAgICAgICAg
ICAgICAgIHJldHVybiBuICYmIG4udmFsdWUgPT09IGUKICAgICAgICAgICAgICAgICAgICB9CiAg
ICAgICAgICAgICAgICB9LCBULmZpbmQuSUQgPSBmdW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAg
ICAgICAgICAgaWYgKHZvaWQgMCAhPT0gZS5nZXRFbGVtZW50QnlJZCAmJiAkKSB7CiAgICAgICAg
ICAgICAgICAgICAgICAgIHZhciBuLCBpLCBvLCByID0gZS5nZXRFbGVtZW50QnlJZCh0KTsKICAg
ICAgICAgICAgICAgICAgICAgICAgaWYgKHIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGlmICgobiA9IHIuZ2V0QXR0cmlidXRlTm9kZSgiaWQiKSkgJiYgbi52YWx1ZSA9PT0gdCkgcmV0
dXJuIFtyXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobyA9IGUuZ2V0RWxlbWVu
dHNCeU5hbWUodCksIGkgPSAwOyByID0gb1tpKytdOykKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBpZiAoKG4gPSByLmdldEF0dHJpYnV0ZU5vZGUoImlkIikpICYmIG4udmFsdWUgPT09
IHQpIHJldHVybiBbcl0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg
ICAgICAgICByZXR1cm4gW10KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9
KSwgVC5maW5kLlRBRyA9IGIuZ2V0RWxlbWVudHNCeVRhZ05hbWUgPyBmdW5jdGlvbih0LCBlKSB7
CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZvaWQgMCAhPT0gZS5nZXRFbGVtZW50c0J5VGFn
TmFtZSA/IGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUodCkgOiBiLnFzYSA/IGUucXVlcnlTZWxlY3Rv
ckFsbCh0KSA6IHZvaWQgMAogICAgICAgICAgICAgICAgfSA6IGZ1bmN0aW9uKHQsIGUpIHsKICAg
ICAgICAgICAgICAgICAgICB2YXIgbiwgaSA9IFtdLAogICAgICAgICAgICAgICAgICAgICAgICBv
ID0gMCwKICAgICAgICAgICAgICAgICAgICAgICAgciA9IGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUo
dCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKCIqIiA9PT0gdCkgewogICAgICAgICAgICAgICAg
ICAgICAgICBmb3IgKDsgbiA9IHJbbysrXTspIDEgPT09IG4ubm9kZVR5cGUgJiYgaS5wdXNoKG4p
OwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaQogICAgICAgICAgICAgICAgICAgIH0K
ICAgICAgICAgICAgICAgICAgICByZXR1cm4gcgogICAgICAgICAgICAgICAgfSwgVC5maW5kLkNM
QVNTID0gYi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lICYmIGZ1bmN0aW9uKHQsIGUpIHsKICAgICAg
ICAgICAgICAgICAgICBpZiAodm9pZCAwICE9PSBlLmdldEVsZW1lbnRzQnlDbGFzc05hbWUgJiYg
JCkgcmV0dXJuIGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSh0KQogICAgICAgICAgICAgICAgfSwg
cSA9IFtdLCBQID0gW10sIChiLnFzYSA9IGR0LnRlc3Qoai5xdWVyeVNlbGVjdG9yQWxsKSkgJiYg
KG8oZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgIEwuYXBwZW5kQ2hpbGQodCkuaW5u
ZXJIVE1MID0gIjxhIGlkPSciICsgRiArICInPjwvYT48c2VsZWN0IGlkPSciICsgRiArICItXHJc
XCcgbXNhbGxvd2NhcHR1cmU9Jyc+PG9wdGlvbiBzZWxlY3RlZD0nJz48L29wdGlvbj48L3NlbGVj
dD4iLCB0LnF1ZXJ5U2VsZWN0b3JBbGwoIlttc2FsbG93Y2FwdHVyZV49JyddIikubGVuZ3RoICYm
IFAucHVzaCgiWypeJF09IiArIHR0ICsgIiooPzonJ3xcIlwiKSIpLCB0LnF1ZXJ5U2VsZWN0b3JB
bGwoIltzZWxlY3RlZF0iKS5sZW5ndGggfHwgUC5wdXNoKCJcXFsiICsgdHQgKyAiKig/OnZhbHVl
fCIgKyBaICsgIikiKSwgdC5xdWVyeVNlbGVjdG9yQWxsKCJbaWR+PSIgKyBGICsgIi1dIikubGVu
Z3RoIHx8IFAucHVzaCgifj0iKSwgdC5xdWVyeVNlbGVjdG9yQWxsKCI6Y2hlY2tlZCIpLmxlbmd0
aCB8fCBQLnB1c2goIjpjaGVja2VkIiksIHQucXVlcnlTZWxlY3RvckFsbCgiYSMiICsgRiArICIr
KiIpLmxlbmd0aCB8fCBQLnB1c2goIi4jLitbK35dIikKICAgICAgICAgICAgICAgIH0pLCBvKGZ1
bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICB0LmlubmVySFRNTCA9ICI8YSBocmVmPScn
IGRpc2FibGVkPSdkaXNhYmxlZCc+PC9hPjxzZWxlY3QgZGlzYWJsZWQ9J2Rpc2FibGVkJz48b3B0
aW9uLz48L3NlbGVjdD4iOwogICAgICAgICAgICAgICAgICAgIHZhciBlID0gai5jcmVhdGVFbGVt
ZW50KCJpbnB1dCIpOwogICAgICAgICAgICAgICAgICAgIGUuc2V0QXR0cmlidXRlKCJ0eXBlIiwg
ImhpZGRlbiIpLCB0LmFwcGVuZENoaWxkKGUpLnNldEF0dHJpYnV0ZSgibmFtZSIsICJEIiksIHQu
cXVlcnlTZWxlY3RvckFsbCgiW25hbWU9ZF0iKS5sZW5ndGggJiYgUC5wdXNoKCJuYW1lIiArIHR0
ICsgIipbKl4kfCF+XT89IiksIDIgIT09IHQucXVlcnlTZWxlY3RvckFsbCgiOmVuYWJsZWQiKS5s
ZW5ndGggJiYgUC5wdXNoKCI6ZW5hYmxlZCIsICI6ZGlzYWJsZWQiKSwgTC5hcHBlbmRDaGlsZCh0
KS5kaXNhYmxlZCA9ICEwLCAyICE9PSB0LnF1ZXJ5U2VsZWN0b3JBbGwoIjpkaXNhYmxlZCIpLmxl
bmd0aCAmJiBQLnB1c2goIjplbmFibGVkIiwgIjpkaXNhYmxlZCIpLCB0LnF1ZXJ5U2VsZWN0b3JB
bGwoIiosOngiKSwgUC5wdXNoKCIsLio6IikKICAgICAgICAgICAgICAgIH0pKSwgKGIubWF0Y2hl
c1NlbGVjdG9yID0gZHQudGVzdChSID0gTC5tYXRjaGVzIHx8IEwud2Via2l0TWF0Y2hlc1NlbGVj
dG9yIHx8IEwubW96TWF0Y2hlc1NlbGVjdG9yIHx8IEwub01hdGNoZXNTZWxlY3RvciB8fCBMLm1z
TWF0Y2hlc1NlbGVjdG9yKSkgJiYgbyhmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAg
Yi5kaXNjb25uZWN0ZWRNYXRjaCA9IFIuY2FsbCh0LCAiKiIpLCBSLmNhbGwodCwgIltzIT0nJ106
eCIpLCBxLnB1c2goIiE9IiwgaXQpCiAgICAgICAgICAgICAgICB9KSwgUCA9IFAubGVuZ3RoICYm
IG5ldyBSZWdFeHAoUC5qb2luKCJ8IikpLCBxID0gcS5sZW5ndGggJiYgbmV3IFJlZ0V4cChxLmpv
aW4oInwiKSksIGUgPSBkdC50ZXN0KEwuY29tcGFyZURvY3VtZW50UG9zaXRpb24pLCBJID0gZSB8
fCBkdC50ZXN0KEwuY29udGFpbnMpID8gZnVuY3Rpb24odCwgZSkgewogICAgICAgICAgICAgICAg
ICAgIHZhciBuID0gOSA9PT0gdC5ub2RlVHlwZSA/IHQuZG9jdW1lbnRFbGVtZW50IDogdCwKICAg
ICAgICAgICAgICAgICAgICAgICAgaSA9IGUgJiYgZS5wYXJlbnROb2RlOwogICAgICAgICAgICAg
ICAgICAgIHJldHVybiB0ID09PSBpIHx8ICEoIWkgfHwgMSAhPT0gaS5ub2RlVHlwZSB8fCAhKG4u
Y29udGFpbnMgPyBuLmNvbnRhaW5zKGkpIDogdC5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiAmJiAx
NiAmIHQuY29tcGFyZURvY3VtZW50UG9zaXRpb24oaSkpKQogICAgICAgICAgICAgICAgfSA6IGZ1
bmN0aW9uKHQsIGUpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoZSkKICAgICAgICAgICAgICAg
ICAgICAgICAgZm9yICg7IGUgPSBlLnBhcmVudE5vZGU7KQogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgaWYgKGUgPT09IHQpIHJldHVybiAhMDsKICAgICAgICAgICAgICAgICAgICByZXR1cm4g
ITEKICAgICAgICAgICAgICAgIH0sIFggPSBlID8gZnVuY3Rpb24odCwgZSkgewogICAgICAgICAg
ICAgICAgICAgIGlmICh0ID09PSBlKSByZXR1cm4gTiA9ICEwLCAwOwogICAgICAgICAgICAgICAg
ICAgIHZhciBuID0gIXQuY29tcGFyZURvY3VtZW50UG9zaXRpb24gLSAhZS5jb21wYXJlRG9jdW1l
bnRQb3NpdGlvbjsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbiB8fCAobiA9ICh0Lm93bmVy
RG9jdW1lbnQgfHwgdCkgPT09IChlLm93bmVyRG9jdW1lbnQgfHwgZSkgPyB0LmNvbXBhcmVEb2N1
bWVudFBvc2l0aW9uKGUpIDogMSwgMSAmIG4gfHwgIWIuc29ydERldGFjaGVkICYmIGUuY29tcGFy
ZURvY3VtZW50UG9zaXRpb24odCkgPT09IG4gPyB0ID09PSBqIHx8IHQub3duZXJEb2N1bWVudCA9
PT0gTyAmJiBJKE8sIHQpID8gLTEgOiBlID09PSBqIHx8IGUub3duZXJEb2N1bWVudCA9PT0gTyAm
JiBJKE8sIGUpID8gMSA6IEQgPyBLKEQsIHQpIC0gSyhELCBlKSA6IDAgOiA0ICYgbiA/IC0xIDog
MSkKICAgICAgICAgICAgICAgIH0gOiBmdW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAgICAgICAg
ICAgaWYgKHQgPT09IGUpIHJldHVybiBOID0gITAsIDA7CiAgICAgICAgICAgICAgICAgICAgdmFy
IG4sIGkgPSAwLAogICAgICAgICAgICAgICAgICAgICAgICBvID0gdC5wYXJlbnROb2RlLAogICAg
ICAgICAgICAgICAgICAgICAgICByID0gZS5wYXJlbnROb2RlLAogICAgICAgICAgICAgICAgICAg
ICAgICBhID0gW3RdLAogICAgICAgICAgICAgICAgICAgICAgICB1ID0gW2VdOwogICAgICAgICAg
ICAgICAgICAgIGlmICghbyB8fCAhcikgcmV0dXJuIHQgPT09IGogPyAtMSA6IGUgPT09IGogPyAx
IDogbyA/IC0xIDogciA/IDEgOiBEID8gSyhELCB0KSAtIEsoRCwgZSkgOiAwOwogICAgICAgICAg
ICAgICAgICAgIGlmIChvID09PSByKSByZXR1cm4gcyh0LCBlKTsKICAgICAgICAgICAgICAgICAg
ICBmb3IgKG4gPSB0OyBuID0gbi5wYXJlbnROb2RlOykgYS51bnNoaWZ0KG4pOwogICAgICAgICAg
ICAgICAgICAgIGZvciAobiA9IGU7IG4gPSBuLnBhcmVudE5vZGU7KSB1LnVuc2hpZnQobik7CiAg
ICAgICAgICAgICAgICAgICAgZm9yICg7IGFbaV0gPT09IHVbaV07KSBpKys7CiAgICAgICAgICAg
ICAgICAgICAgcmV0dXJuIGkgPyBzKGFbaV0sIHVbaV0pIDogYVtpXSA9PT0gTyA/IC0xIDogdVtp
XSA9PT0gTyA/IDEgOiAwCiAgICAgICAgICAgICAgICB9LCBqKSA6IGoKICAgICAgICAgICAgfSwg
ZS5tYXRjaGVzID0gZnVuY3Rpb24odCwgbikgewogICAgICAgICAgICAgICAgcmV0dXJuIGUodCwg
bnVsbCwgbnVsbCwgbikKICAgICAgICAgICAgfSwgZS5tYXRjaGVzU2VsZWN0b3IgPSBmdW5jdGlv
bih0LCBuKSB7CiAgICAgICAgICAgICAgICBpZiAoKHQub3duZXJEb2N1bWVudCB8fCB0KSAhPT0g
aiAmJiBNKHQpLCBuID0gbi5yZXBsYWNlKHV0LCAiPSckMSddIiksIGIubWF0Y2hlc1NlbGVjdG9y
ICYmICQgJiYgIXpbbiArICIgIl0gJiYgKCFxIHx8ICFxLnRlc3QobikpICYmICghUCB8fCAhUC50
ZXN0KG4pKSkgdHJ5IHsKICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IFIuY2FsbCh0LCBuKTsK
ICAgICAgICAgICAgICAgICAgICBpZiAoaSB8fCBiLmRpc2Nvbm5lY3RlZE1hdGNoIHx8IHQuZG9j
dW1lbnQgJiYgMTEgIT09IHQuZG9jdW1lbnQubm9kZVR5cGUpIHJldHVybiBpCiAgICAgICAgICAg
ICAgICB9IGNhdGNoICh0KSB7fQogICAgICAgICAgICAgICAgcmV0dXJuIGUobiwgaiwgbnVsbCwg
W3RdKS5sZW5ndGggPiAwCiAgICAgICAgICAgIH0sIGUuY29udGFpbnMgPSBmdW5jdGlvbih0LCBl
KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gKHQub3duZXJEb2N1bWVudCB8fCB0KSAhPT0gaiAm
JiBNKHQpLCBJKHQsIGUpCiAgICAgICAgICAgIH0sIGUuYXR0ciA9IGZ1bmN0aW9uKHQsIGUpIHsK
ICAgICAgICAgICAgICAgICh0Lm93bmVyRG9jdW1lbnQgfHwgdCkgIT09IGogJiYgTSh0KTsKICAg
ICAgICAgICAgICAgIHZhciBuID0gVC5hdHRySGFuZGxlW2UudG9Mb3dlckNhc2UoKV0sCiAgICAg
ICAgICAgICAgICAgICAgaSA9IG4gJiYgWS5jYWxsKFQuYXR0ckhhbmRsZSwgZS50b0xvd2VyQ2Fz
ZSgpKSA/IG4odCwgZSwgISQpIDogdm9pZCAwOwogICAgICAgICAgICAgICAgcmV0dXJuIHZvaWQg
MCAhPT0gaSA/IGkgOiBiLmF0dHJpYnV0ZXMgfHwgISQgPyB0LmdldEF0dHJpYnV0ZShlKSA6IChp
ID0gdC5nZXRBdHRyaWJ1dGVOb2RlKGUpKSAmJiBpLnNwZWNpZmllZCA/IGkudmFsdWUgOiBudWxs
CiAgICAgICAgICAgIH0sIGUuZXNjYXBlID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAg
cmV0dXJuICh0ICsgIiIpLnJlcGxhY2UoeHQsIGJ0KQogICAgICAgICAgICB9LCBlLmVycm9yID0g
ZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJTeW50YXggZXJy
b3IsIHVucmVjb2duaXplZCBleHByZXNzaW9uOiAiICsgdCkKICAgICAgICAgICAgfSwgZS51bmlx
dWVTb3J0ID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgdmFyIGUsIG4gPSBbXSwKICAg
ICAgICAgICAgICAgICAgICBpID0gMCwKICAgICAgICAgICAgICAgICAgICBvID0gMDsKICAgICAg
ICAgICAgICAgIGlmIChOID0gIWIuZGV0ZWN0RHVwbGljYXRlcywgRCA9ICFiLnNvcnRTdGFibGUg
JiYgdC5zbGljZSgwKSwgdC5zb3J0KFgpLCBOKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yICg7
IGUgPSB0W28rK107KSBlID09PSB0W29dICYmIChpID0gbi5wdXNoKG8pKTsKICAgICAgICAgICAg
ICAgICAgICBmb3IgKDsgaS0tOykgdC5zcGxpY2UobltpXSwgMSkKICAgICAgICAgICAgICAgIH0K
ICAgICAgICAgICAgICAgIHJldHVybiBEID0gbnVsbCwgdAogICAgICAgICAgICB9LCB3ID0gZS5n
ZXRUZXh0ID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgdmFyIGUsIG4gPSAiIiwKICAg
ICAgICAgICAgICAgICAgICBpID0gMCwKICAgICAgICAgICAgICAgICAgICBvID0gdC5ub2RlVHlw
ZTsKICAgICAgICAgICAgICAgIGlmIChvKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKDEgPT09
IG8gfHwgOSA9PT0gbyB8fCAxMSA9PT0gbykgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAo
InN0cmluZyIgPT0gdHlwZW9mIHQudGV4dENvbnRlbnQpIHJldHVybiB0LnRleHRDb250ZW50Owog
ICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHQgPSB0LmZpcnN0Q2hpbGQ7IHQ7IHQgPSB0Lm5l
eHRTaWJsaW5nKSBuICs9IHcodCkKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKDMgPT09
IG8gfHwgNCA9PT0gbykgcmV0dXJuIHQubm9kZVZhbHVlCiAgICAgICAgICAgICAgICB9IGVsc2UK
ICAgICAgICAgICAgICAgICAgICBmb3IgKDsgZSA9IHRbaSsrXTspIG4gKz0gdyhlKTsKICAgICAg
ICAgICAgICAgIHJldHVybiBuCiAgICAgICAgICAgIH0sIFQgPSBlLnNlbGVjdG9ycyA9IHsKICAg
ICAgICAgICAgICAgIGNhY2hlTGVuZ3RoOiA1MCwKICAgICAgICAgICAgICAgIGNyZWF0ZVBzZXVk
bzogaSwKICAgICAgICAgICAgICAgIG1hdGNoOiBwdCwKICAgICAgICAgICAgICAgIGF0dHJIYW5k
bGU6IHt9LAogICAgICAgICAgICAgICAgZmluZDoge30sCiAgICAgICAgICAgICAgICByZWxhdGl2
ZTogewogICAgICAgICAgICAgICAgICAgICI+IjogewogICAgICAgICAgICAgICAgICAgICAgICBk
aXI6ICJwYXJlbnROb2RlIiwKICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3Q6ICEwCiAgICAg
ICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAiICI6IHsKICAgICAgICAgICAg
ICAgICAgICAgICAgZGlyOiAicGFyZW50Tm9kZSIKICAgICAgICAgICAgICAgICAgICB9LAogICAg
ICAgICAgICAgICAgICAgICIrIjogewogICAgICAgICAgICAgICAgICAgICAgICBkaXI6ICJwcmV2
aW91c1NpYmxpbmciLAogICAgICAgICAgICAgICAgICAgICAgICBmaXJzdDogITAKICAgICAgICAg
ICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICJ+IjogewogICAgICAgICAgICAgICAg
ICAgICAgICBkaXI6ICJwcmV2aW91c1NpYmxpbmciCiAgICAgICAgICAgICAgICAgICAgfQogICAg
ICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHByZUZpbHRlcjogewogICAgICAgICAgICAg
ICAgICAgIEFUVFI6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJu
IHRbMV0gPSB0WzFdLnJlcGxhY2UodnQsIHl0KSwgdFszXSA9ICh0WzNdIHx8IHRbNF0gfHwgdFs1
XSB8fCAiIikucmVwbGFjZSh2dCwgeXQpLCAifj0iID09PSB0WzJdICYmICh0WzNdID0gIiAiICsg
dFszXSArICIgIiksIHQuc2xpY2UoMCwgNCkKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAg
ICAgICAgICAgICAgIENISUxEOiBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgICAg
IHJldHVybiB0WzFdID0gdFsxXS50b0xvd2VyQ2FzZSgpLCAibnRoIiA9PT0gdFsxXS5zbGljZSgw
LCAzKSA/ICh0WzNdIHx8IGUuZXJyb3IodFswXSksIHRbNF0gPSArKHRbNF0gPyB0WzVdICsgKHRb
Nl0gfHwgMSkgOiAyICogKCJldmVuIiA9PT0gdFszXSB8fCAib2RkIiA9PT0gdFszXSkpLCB0WzVd
ID0gKyh0WzddICsgdFs4XSB8fCAib2RkIiA9PT0gdFszXSkpIDogdFszXSAmJiBlLmVycm9yKHRb
MF0pLCB0CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBQU0VVRE86
IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUsIG4gPSAhdFs2XSAm
JiB0WzJdOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHQuQ0hJTEQudGVzdCh0WzBd
KSA/IG51bGwgOiAodFszXSA/IHRbMl0gPSB0WzRdIHx8IHRbNV0gfHwgIiIgOiBuICYmIGx0LnRl
c3QobikgJiYgKGUgPSBTKG4sICEwKSkgJiYgKGUgPSBuLmluZGV4T2YoIikiLCBuLmxlbmd0aCAt
IGUpIC0gbi5sZW5ndGgpICYmICh0WzBdID0gdFswXS5zbGljZSgwLCBlKSwgdFsyXSA9IG4uc2xp
Y2UoMCwgZSkpLCB0LnNsaWNlKDAsIDMpKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAg
ICAgICAgIH0sCiAgICAgICAgICAgICAgICBmaWx0ZXI6IHsKICAgICAgICAgICAgICAgICAgICBU
QUc6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSB0LnJlcGxh
Y2UodnQsIHl0KS50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4g
IioiID09PSB0ID8gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1
cm4gITAKICAgICAgICAgICAgICAgICAgICAgICAgfSA6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHJldHVybiB0Lm5vZGVOYW1lICYmIHQubm9kZU5hbWUudG9Mb3dl
ckNhc2UoKSA9PT0gZQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAg
ICAgfSwKICAgICAgICAgICAgICAgICAgICBDTEFTUzogZnVuY3Rpb24odCkgewogICAgICAgICAg
ICAgICAgICAgICAgICB2YXIgZSA9IF9bdCArICIgIl07CiAgICAgICAgICAgICAgICAgICAgICAg
IHJldHVybiBlIHx8IChlID0gbmV3IFJlZ0V4cCgiKF58IiArIHR0ICsgIikiICsgdCArICIoIiAr
IHR0ICsgInwkKSIpKSAmJiBfKHQsIGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHJldHVybiBlLnRlc3QoInN0cmluZyIgPT0gdHlwZW9mIHQuY2xhc3NOYW1lICYmIHQu
Y2xhc3NOYW1lIHx8IHZvaWQgMCAhPT0gdC5nZXRBdHRyaWJ1dGUgJiYgdC5nZXRBdHRyaWJ1dGUo
ImNsYXNzIikgfHwgIiIpCiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAg
ICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBBVFRSOiBmdW5jdGlvbih0LCBuLCBpKSB7CiAg
ICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihvKSB7CiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB2YXIgciA9IGUuYXR0cihvLCB0KTsKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHJldHVybiBudWxsID09IHIgPyAiIT0iID09PSBuIDogIW4gfHwgKHIgKz0gIiIsICI9
IiA9PT0gbiA/IHIgPT09IGkgOiAiIT0iID09PSBuID8gciAhPT0gaSA6ICJePSIgPT09IG4gPyBp
ICYmIDAgPT09IHIuaW5kZXhPZihpKSA6ICIqPSIgPT09IG4gPyBpICYmIHIuaW5kZXhPZihpKSA+
IC0xIDogIiQ9IiA9PT0gbiA/IGkgJiYgci5zbGljZSgtaS5sZW5ndGgpID09PSBpIDogIn49IiA9
PT0gbiA/ICgiICIgKyByLnJlcGxhY2Uob3QsICIgIikgKyAiICIpLmluZGV4T2YoaSkgPiAtMSA6
ICJ8PSIgPT09IG4gJiYgKHIgPT09IGkgfHwgci5zbGljZSgwLCBpLmxlbmd0aCArIDEpID09PSBp
ICsgIi0iKSkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0s
CiAgICAgICAgICAgICAgICAgICAgQ0hJTEQ6IGZ1bmN0aW9uKHQsIGUsIG4sIGksIG8pIHsKICAg
ICAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSAibnRoIiAhPT0gdC5zbGljZSgwLCAzKSwKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHMgPSAibGFzdCIgIT09IHQuc2xpY2UoLTQpLAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgYSA9ICJvZi10eXBlIiA9PT0gZTsKICAgICAgICAgICAg
ICAgICAgICAgICAgcmV0dXJuIDEgPT09IGkgJiYgMCA9PT0gbyA/IGZ1bmN0aW9uKHQpIHsKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhIXQucGFyZW50Tm9kZQogICAgICAgICAg
ICAgICAgICAgICAgICB9IDogZnVuY3Rpb24oZSwgbiwgdSkgewogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdmFyIGwsIGMsIHAsIGgsIGYsIGQsIGcgPSByICE9PSBzID8gIm5leHRTaWJsaW5n
IiA6ICJwcmV2aW91c1NpYmxpbmciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0g
PSBlLnBhcmVudE5vZGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdiA9IGEgJiYg
ZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHkgPSAhdSAmJiAhYSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4ID0gITE7CiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobSkgewogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGlmIChyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZv
ciAoOyBnOykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICho
ID0gZTsgaCA9IGhbZ107KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGlmIChhID8gaC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSB2IDogMSA9PT0gaC5ub2Rl
VHlwZSkgcmV0dXJuICExOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ZCA9IGcgPSAib25seSIgPT09IHQgJiYgIWQgJiYgIm5leHRTaWJsaW5nIgogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHJldHVybiAhMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBpZiAoZCA9IFtzID8gbS5maXJzdENoaWxkIDogbS5sYXN0
Q2hpbGRdLCBzICYmIHkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9y
IChoID0gbSwgcCA9IGhbRl0gfHwgKGhbRl0gPSB7fSksIGMgPSBwW2gudW5pcXVlSURdIHx8IChw
W2gudW5pcXVlSURdID0ge30pLCBsID0gY1t0XSB8fCBbXSwgZiA9IGxbMF0gPT09IEggJiYgbFsx
XSwgeCA9IGYgJiYgbFsyXSwgaCA9IGYgJiYgbS5jaGlsZE5vZGVzW2ZdOyBoID0gKytmICYmIGgg
JiYgaFtnXSB8fCAoeCA9IGYgPSAwKSB8fCBkLnBvcCgpOykKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGlmICgxID09PSBoLm5vZGVUeXBlICYmICsreCAmJiBoID09PSBl
KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY1t0XSA9IFtI
LCBmLCB4XTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVh
awogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoeSAmJiAoaCA9IGUsIHAgPSBoW0ZdIHx8ICho
W0ZdID0ge30pLCBjID0gcFtoLnVuaXF1ZUlEXSB8fCAocFtoLnVuaXF1ZUlEXSA9IHt9KSwgbCA9
IGNbdF0gfHwgW10sIGYgPSBsWzBdID09PSBIICYmIGxbMV0sIHggPSBmKSwgITEgPT09IHgpCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoOwogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgKGggPSArK2YgJiYgaCAmJiBoW2ddIHx8ICh4ID0gZiA9
IDApIHx8IGQucG9wKCkpICYmICgoYSA/IGgubm9kZU5hbWUudG9Mb3dlckNhc2UoKSAhPT0gdiA6
IDEgIT09IGgubm9kZVR5cGUpIHx8ICErK3ggfHwgKHkgJiYgKHAgPSBoW0ZdIHx8IChoW0ZdID0g
e30pLCBjID0gcFtoLnVuaXF1ZUlEXSB8fCAocFtoLnVuaXF1ZUlEXSA9IHt9KSwgY1t0XSA9IFtI
LCB4XSksIGggIT09IGUpKTspOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVy
biAoeCAtPSBvKSA9PT0gaSB8fCB4ICUgaSA9PSAwICYmIHggLyBpID49IDAKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg
ICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgUFNFVURPOiBmdW5jdGlvbih0LCBuKSB7CiAg
ICAgICAgICAgICAgICAgICAgICAgIHZhciBvLCByID0gVC5wc2V1ZG9zW3RdIHx8IFQuc2V0Rmls
dGVyc1t0LnRvTG93ZXJDYXNlKCldIHx8IGUuZXJyb3IoInVuc3VwcG9ydGVkIHBzZXVkbzogIiAr
IHQpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcltGXSA/IHIobikgOiByLmxlbmd0
aCA+IDEgPyAobyA9IFt0LCB0LCAiIiwgbl0sIFQuc2V0RmlsdGVycy5oYXNPd25Qcm9wZXJ0eSh0
LnRvTG93ZXJDYXNlKCkpID8gaShmdW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBmb3IgKHZhciBpLCBvID0gcih0LCBuKSwgcyA9IG8ubGVuZ3RoOyBzLS07KSBpID0g
Syh0LCBvW3NdKSwgdFtpXSA9ICEoZVtpXSA9IG9bc10pCiAgICAgICAgICAgICAgICAgICAgICAg
IH0pIDogZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHIo
dCwgMCwgbykKICAgICAgICAgICAgICAgICAgICAgICAgfSkgOiByCiAgICAgICAgICAgICAgICAg
ICAgfQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHBzZXVkb3M6IHsKICAgICAg
ICAgICAgICAgICAgICBub3Q6IGkoZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgICAg
ICB2YXIgZSA9IFtdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbiA9IFtdLAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgbyA9IEUodC5yZXBsYWNlKHJ0LCAiJDEiKSk7CiAgICAgICAg
ICAgICAgICAgICAgICAgIHJldHVybiBvW0ZdID8gaShmdW5jdGlvbih0LCBlLCBuLCBpKSB7CiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciByLCBzID0gbyh0LCBudWxsLCBpLCBb
XSksIGEgPSB0Lmxlbmd0aDsgYS0tOykociA9IHNbYV0pICYmICh0W2FdID0gIShlW2FdID0gcikp
CiAgICAgICAgICAgICAgICAgICAgICAgIH0pIDogZnVuY3Rpb24odCwgaSwgcikgewogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVbMF0gPSB0LAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIG8oZSwgbnVsbCwgciwgbiksIGVbMF0gPSBudWxsLCAhbi5wb3AoKQogICAg
ICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAg
ICAgICAgICAgaGFzOiBpKGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0
dXJuIGZ1bmN0aW9uKG4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlKHQs
IG4pLmxlbmd0aCA+IDAKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg
ICAgIH0pLAogICAgICAgICAgICAgICAgICAgIGNvbnRhaW5zOiBpKGZ1bmN0aW9uKHQpIHsKICAg
ICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQgPSB0LnJlcGxhY2UodnQsIHl0KSwKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICByZXR1cm4gKGUudGV4dENvbnRlbnQgfHwgZS5pbm5lclRleHQgfHwgdyhlKSku
aW5kZXhPZih0KSA+IC0xCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg
ICAgICAgICAgfSksCiAgICAgICAgICAgICAgICAgICAgbGFuZzogaShmdW5jdGlvbih0KSB7CiAg
ICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjdC50ZXN0KHQgfHwgIiIpIHx8IGUuZXJyb3Io
InVuc3VwcG9ydGVkIGxhbmc6ICIgKyB0KSwgdCA9IHQucmVwbGFjZSh2dCwgeXQpLnRvTG93ZXJD
YXNlKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihlKSB7CiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG47CiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgZG8gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobiA9ICQg
PyBlLmxhbmcgOiBlLmdldEF0dHJpYnV0ZSgieG1sOmxhbmciKSB8fCBlLmdldEF0dHJpYnV0ZSgi
bGFuZyIpKSByZXR1cm4gKG4gPSBuLnRvTG93ZXJDYXNlKCkpID09PSB0IHx8IDAgPT09IG4uaW5k
ZXhPZih0ICsgIi0iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gd2hpbGUgKChl
ID0gZS5wYXJlbnROb2RlKSAmJiAxID09PSBlLm5vZGVUeXBlKTsKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICByZXR1cm4gITEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAg
ICAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IGZ1bmN0aW9u
KGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSB0LmxvY2F0aW9uICYmIHQubG9j
YXRpb24uaGFzaDsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG4gJiYgbi5zbGljZSgx
KSA9PT0gZS5pZAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgcm9v
dDogZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdCA9PT0gTAog
ICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgZm9jdXM6IGZ1bmN0aW9u
KHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQgPT09IGouYWN0aXZlRWxlbWVu
dCAmJiAoIWouaGFzRm9jdXMgfHwgai5oYXNGb2N1cygpKSAmJiAhISh0LnR5cGUgfHwgdC5ocmVm
IHx8IH50LnRhYkluZGV4KQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAg
ICAgZW5hYmxlZDogYSghMSksCiAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ6IGEoITApLAog
ICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAg
ICAgICAgICAgdmFyIGUgPSB0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgICAgICAg
ICAgICAgICAgIHJldHVybiAiaW5wdXQiID09PSBlICYmICEhdC5jaGVja2VkIHx8ICJvcHRpb24i
ID09PSBlICYmICEhdC5zZWxlY3RlZAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAg
ICAgICAgICAgc2VsZWN0ZWQ6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAg
cmV0dXJuIHQucGFyZW50Tm9kZSAmJiB0LnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleCwgITAgPT09
IHQuc2VsZWN0ZWQKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIGVt
cHR5OiBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodCA9IHQuZmly
c3RDaGlsZDsgdDsgdCA9IHQubmV4dFNpYmxpbmcpCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBpZiAodC5ub2RlVHlwZSA8IDYpIHJldHVybiAhMTsKICAgICAgICAgICAgICAgICAgICAgICAg
cmV0dXJuICEwCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBwYXJl
bnQ6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICFULnBzZXVk
b3MuZW1wdHkodCkKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIGhl
YWRlcjogZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnQudGVz
dCh0Lm5vZGVOYW1lKQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAg
aW5wdXQ6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGh0LnRl
c3QodC5ub2RlTmFtZSkKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAg
IGJ1dHRvbjogZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IHQu
bm9kZU5hbWUudG9Mb3dlckNhc2UoKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJp
bnB1dCIgPT09IGUgJiYgImJ1dHRvbiIgPT09IHQudHlwZSB8fCAiYnV0dG9uIiA9PT0gZQogICAg
ICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgdGV4dDogZnVuY3Rpb24odCkg
ewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZTsKICAgICAgICAgICAgICAgICAgICAgICAg
cmV0dXJuICJpbnB1dCIgPT09IHQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSAmJiAidGV4dCIgPT09
IHQudHlwZSAmJiAobnVsbCA9PSAoZSA9IHQuZ2V0QXR0cmlidXRlKCJ0eXBlIikpIHx8ICJ0ZXh0
IiA9PT0gZS50b0xvd2VyQ2FzZSgpKQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAg
ICAgICAgICAgZmlyc3Q6IHUoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJl
dHVybiBbMF0KICAgICAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgICAgICBsYXN0
OiB1KGZ1bmN0aW9uKHQsIGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtlIC0g
MV0KICAgICAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgICAgICBlcTogdShmdW5j
dGlvbih0LCBlLCBuKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbbiA8IDAgPyBu
ICsgZSA6IG5dCiAgICAgICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICAgICAgZXZl
bjogdShmdW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIG4g
PSAwOyBuIDwgZTsgbiArPSAyKSB0LnB1c2gobik7CiAgICAgICAgICAgICAgICAgICAgICAgIHJl
dHVybiB0CiAgICAgICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICAgICAgb2RkOiB1
KGZ1bmN0aW9uKHQsIGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgbiA9IDE7
IG4gPCBlOyBuICs9IDIpIHQucHVzaChuKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJu
IHQKICAgICAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgICAgICBsdDogdShmdW5j
dGlvbih0LCBlLCBuKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSBuIDwg
MCA/IG4gKyBlIDogbjsgLS1pID49IDA7KSB0LnB1c2goaSk7CiAgICAgICAgICAgICAgICAgICAg
ICAgIHJldHVybiB0CiAgICAgICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICAgICAg
Z3Q6IHUoZnVuY3Rpb24odCwgZSwgbikgewogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZh
ciBpID0gbiA8IDAgPyBuICsgZSA6IG47ICsraSA8IGU7KSB0LnB1c2goaSk7CiAgICAgICAgICAg
ICAgICAgICAgICAgIHJldHVybiB0CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAg
ICAgIH0KICAgICAgICAgICAgfSwgVC5wc2V1ZG9zLm50aCA9IFQucHNldWRvcy5lcTsKICAgICAg
ICAgICAgZm9yICh4IGluIHsKICAgICAgICAgICAgICAgICAgICByYWRpbzogITAsCiAgICAgICAg
ICAgICAgICAgICAgY2hlY2tib3g6ICEwLAogICAgICAgICAgICAgICAgICAgIGZpbGU6ICEwLAog
ICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiAhMCwKICAgICAgICAgICAgICAgICAgICBpbWFn
ZTogITAKICAgICAgICAgICAgICAgIH0pIFQucHNldWRvc1t4XSA9IGZ1bmN0aW9uKHQpIHsKICAg
ICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0
dXJuICJpbnB1dCIgPT09IGUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSAmJiBlLnR5cGUgPT09IHQK
ICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSh4KTsKICAgICAgICAgICAgZm9yICh4IGlu
IHsKICAgICAgICAgICAgICAgICAgICBzdWJtaXQ6ICEwLAogICAgICAgICAgICAgICAgICAgIHJl
c2V0OiAhMAogICAgICAgICAgICAgICAgfSkgVC5wc2V1ZG9zW3hdID0gZnVuY3Rpb24odCkgewog
ICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgICAgICAgICB2
YXIgbiA9IGUubm9kZU5hbWUudG9Mb3dlckNhc2UoKTsKICAgICAgICAgICAgICAgICAgICByZXR1
cm4gKCJpbnB1dCIgPT09IG4gfHwgImJ1dHRvbiIgPT09IG4pICYmIGUudHlwZSA9PT0gdAogICAg
ICAgICAgICAgICAgfQogICAgICAgICAgICB9KHgpOwogICAgICAgICAgICByZXR1cm4gYy5wcm90
b3R5cGUgPSBULmZpbHRlcnMgPSBULnBzZXVkb3MsIFQuc2V0RmlsdGVycyA9IG5ldyBjLCBTID0g
ZS50b2tlbml6ZSA9IGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICAgICAgICAgIHZhciBpLCBvLCBy
LCBzLCBhLCB1LCBsLCBjID0gQlt0ICsgIiAiXTsKICAgICAgICAgICAgICAgIGlmIChjKSByZXR1
cm4gbiA/IDAgOiBjLnNsaWNlKDApOwogICAgICAgICAgICAgICAgZm9yIChhID0gdCwgdSA9IFtd
LCBsID0gVC5wcmVGaWx0ZXI7IGE7KSB7CiAgICAgICAgICAgICAgICAgICAgaSAmJiAhKG8gPSBz
dC5leGVjKGEpKSB8fCAobyAmJiAoYSA9IGEuc2xpY2Uob1swXS5sZW5ndGgpIHx8IGEpLCB1LnB1
c2gociA9IFtdKSksIGkgPSAhMSwgKG8gPSBhdC5leGVjKGEpKSAmJiAoaSA9IG8uc2hpZnQoKSwg
ci5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGksCiAgICAgICAgICAgICAg
ICAgICAgICAgIHR5cGU6IG9bMF0ucmVwbGFjZShydCwgIiAiKQogICAgICAgICAgICAgICAgICAg
IH0pLCBhID0gYS5zbGljZShpLmxlbmd0aCkpOwogICAgICAgICAgICAgICAgICAgIGZvciAocyBp
biBULmZpbHRlcikgIShvID0gcHRbc10uZXhlYyhhKSkgfHwgbFtzXSAmJiAhKG8gPSBsW3NdKG8p
KSB8fCAoaSA9IG8uc2hpZnQoKSwgci5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFs
dWU6IGksCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IHMsCiAgICAgICAgICAgICAgICAg
ICAgICAgIG1hdGNoZXM6IG8KICAgICAgICAgICAgICAgICAgICB9KSwgYSA9IGEuc2xpY2UoaS5s
ZW5ndGgpKTsKICAgICAgICAgICAgICAgICAgICBpZiAoIWkpIGJyZWFrCiAgICAgICAgICAgICAg
ICB9CiAgICAgICAgICAgICAgICByZXR1cm4gbiA/IGEubGVuZ3RoIDogYSA/IGUuZXJyb3IodCkg
OiBCKHQsIHUpLnNsaWNlKDApCiAgICAgICAgICAgIH0sIEUgPSBlLmNvbXBpbGUgPSBmdW5jdGlv
bih0LCBlKSB7CiAgICAgICAgICAgICAgICB2YXIgbiwgaSA9IFtdLAogICAgICAgICAgICAgICAg
ICAgIG8gPSBbXSwKICAgICAgICAgICAgICAgICAgICByID0gelt0ICsgIiAiXTsKICAgICAgICAg
ICAgICAgIGlmICghcikgewogICAgICAgICAgICAgICAgICAgIGZvciAoZSB8fCAoZSA9IFModCkp
LCBuID0gZS5sZW5ndGg7IG4tLTspIHIgPSB2KGVbbl0pLCByW0ZdID8gaS5wdXNoKHIpIDogby5w
dXNoKHIpOwogICAgICAgICAgICAgICAgICAgIHIgPSB6KHQsIHkobywgaSkpLCByLnNlbGVjdG9y
ID0gdAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHIKICAgICAgICAg
ICAgfSwgQSA9IGUuc2VsZWN0ID0gZnVuY3Rpb24odCwgZSwgbiwgaSkgewogICAgICAgICAgICAg
ICAgdmFyIG8sIHIsIHMsIGEsIHUsIGMgPSAiZnVuY3Rpb24iID09IHR5cGVvZiB0ICYmIHQsCiAg
ICAgICAgICAgICAgICAgICAgaCA9ICFpICYmIFModCA9IGMuc2VsZWN0b3IgfHwgdCk7CiAgICAg
ICAgICAgICAgICBpZiAobiA9IG4gfHwgW10sIDEgPT09IGgubGVuZ3RoKSB7CiAgICAgICAgICAg
ICAgICAgICAgaWYgKHIgPSBoWzBdID0gaFswXS5zbGljZSgwKSwgci5sZW5ndGggPiAyICYmICJJ
RCIgPT09IChzID0gclswXSkudHlwZSAmJiA5ID09PSBlLm5vZGVUeXBlICYmICQgJiYgVC5yZWxh
dGl2ZVtyWzFdLnR5cGVdKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGUgPSAoVC5m
aW5kLklEKHMubWF0Y2hlc1swXS5yZXBsYWNlKHZ0LCB5dCksIGUpIHx8IFtdKVswXSkpIHJldHVy
biBuOwogICAgICAgICAgICAgICAgICAgICAgICBjICYmIChlID0gZS5wYXJlbnROb2RlKSwgdCA9
IHQuc2xpY2Uoci5zaGlmdCgpLnZhbHVlLmxlbmd0aCkKICAgICAgICAgICAgICAgICAgICB9CiAg
ICAgICAgICAgICAgICAgICAgZm9yIChvID0gcHQubmVlZHNDb250ZXh0LnRlc3QodCkgPyAwIDog
ci5sZW5ndGg7IG8tLSAmJiAocyA9IHJbb10sICFULnJlbGF0aXZlW2EgPSBzLnR5cGVdKTspCiAg
ICAgICAgICAgICAgICAgICAgICAgIGlmICgodSA9IFQuZmluZFthXSkgJiYgKGkgPSB1KHMubWF0
Y2hlc1swXS5yZXBsYWNlKHZ0LCB5dCksIG10LnRlc3QoclswXS50eXBlKSAmJiBsKGUucGFyZW50
Tm9kZSkgfHwgZSkpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoci5zcGxpY2Uo
bywgMSksICEodCA9IGkubGVuZ3RoICYmIHAocikpKSByZXR1cm4gRy5hcHBseShuLCBpKSwgbjsK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAg
IH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiAoYyB8fCBFKHQsIGgp
KShpLCBlLCAhJCwgbiwgIWUgfHwgbXQudGVzdCh0KSAmJiBsKGUucGFyZW50Tm9kZSkgfHwgZSks
IG4KICAgICAgICAgICAgfSwgYi5zb3J0U3RhYmxlID0gRi5zcGxpdCgiIikuc29ydChYKS5qb2lu
KCIiKSA9PT0gRiwgYi5kZXRlY3REdXBsaWNhdGVzID0gISFOLCBNKCksIGIuc29ydERldGFjaGVk
ID0gbyhmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gMSAmIHQuY29tcGFyZURv
Y3VtZW50UG9zaXRpb24oai5jcmVhdGVFbGVtZW50KCJmaWVsZHNldCIpKQogICAgICAgICAgICB9
KSwgbyhmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdC5pbm5lckhUTUwgPSAi
PGEgaHJlZj0nIyc+PC9hPiIsICIjIiA9PT0gdC5maXJzdENoaWxkLmdldEF0dHJpYnV0ZSgiaHJl
ZiIpCiAgICAgICAgICAgIH0pIHx8IHIoInR5cGV8aHJlZnxoZWlnaHR8d2lkdGgiLCBmdW5jdGlv
bih0LCBlLCBuKSB7CiAgICAgICAgICAgICAgICBpZiAoIW4pIHJldHVybiB0LmdldEF0dHJpYnV0
ZShlLCAidHlwZSIgPT09IGUudG9Mb3dlckNhc2UoKSA/IDEgOiAyKQogICAgICAgICAgICB9KSwg
Yi5hdHRyaWJ1dGVzICYmIG8oZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHQu
aW5uZXJIVE1MID0gIjxpbnB1dC8+IiwgdC5maXJzdENoaWxkLnNldEF0dHJpYnV0ZSgidmFsdWUi
LCAiIiksICIiID09PSB0LmZpcnN0Q2hpbGQuZ2V0QXR0cmlidXRlKCJ2YWx1ZSIpCiAgICAgICAg
ICAgIH0pIHx8IHIoInZhbHVlIiwgZnVuY3Rpb24odCwgZSwgbikgewogICAgICAgICAgICAgICAg
aWYgKCFuICYmICJpbnB1dCIgPT09IHQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSkgcmV0dXJuIHQu
ZGVmYXVsdFZhbHVlCiAgICAgICAgICAgIH0pLCBvKGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAg
ICAgIHJldHVybiBudWxsID09IHQuZ2V0QXR0cmlidXRlKCJkaXNhYmxlZCIpCiAgICAgICAgICAg
IH0pIHx8IHIoWiwgZnVuY3Rpb24odCwgZSwgbikgewogICAgICAgICAgICAgICAgdmFyIGk7CiAg
ICAgICAgICAgICAgICBpZiAoIW4pIHJldHVybiAhMCA9PT0gdFtlXSA/IGUudG9Mb3dlckNhc2Uo
KSA6IChpID0gdC5nZXRBdHRyaWJ1dGVOb2RlKGUpKSAmJiBpLnNwZWNpZmllZCA/IGkudmFsdWUg
OiBudWxsCiAgICAgICAgICAgIH0pLCBlCiAgICAgICAgfSh0KTsKICAgICAgICBndC5maW5kID0g
dnQsIGd0LmV4cHIgPSB2dC5zZWxlY3RvcnMsIGd0LmV4cHJbIjoiXSA9IGd0LmV4cHIucHNldWRv
cywgZ3QudW5pcXVlU29ydCA9IGd0LnVuaXF1ZSA9IHZ0LnVuaXF1ZVNvcnQsIGd0LnRleHQgPSB2
dC5nZXRUZXh0LCBndC5pc1hNTERvYyA9IHZ0LmlzWE1MLCBndC5jb250YWlucyA9IHZ0LmNvbnRh
aW5zLCBndC5lc2NhcGVTZWxlY3RvciA9IHZ0LmVzY2FwZTsKICAgICAgICB2YXIgeXQgPSBmdW5j
dGlvbih0LCBlLCBuKSB7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gW10sIG8gPSB2b2lk
IDAgIT09IG47CiAgICAgICAgICAgICAgICAgICAgKHQgPSB0W2VdKSAmJiA5ICE9PSB0Lm5vZGVU
eXBlOykKICAgICAgICAgICAgICAgICAgICBpZiAoMSA9PT0gdC5ub2RlVHlwZSkgewogICAgICAg
ICAgICAgICAgICAgICAgICBpZiAobyAmJiBndCh0KS5pcyhuKSkgYnJlYWs7CiAgICAgICAgICAg
ICAgICAgICAgICAgIGkucHVzaCh0KQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg
ICAgIHJldHVybiBpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHh0ID0gZnVuY3Rpb24odCwg
ZSkgewogICAgICAgICAgICAgICAgZm9yICh2YXIgbiA9IFtdOyB0OyB0ID0gdC5uZXh0U2libGlu
ZykgMSA9PT0gdC5ub2RlVHlwZSAmJiB0ICE9PSBlICYmIG4ucHVzaCh0KTsKICAgICAgICAgICAg
ICAgIHJldHVybiBuCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGJ0ID0gZ3QuZXhwci5tYXRj
aC5uZWVkc0NvbnRleHQsCiAgICAgICAgICAgIFR0ID0gL148KFthLXpdW15cL1wwPjpceDIwXHRc
clxuXGZdKilbXHgyMFx0XHJcblxmXSpcLz8+KD86PFwvXDE+fCkkL2ksCiAgICAgICAgICAgIHd0
ID0gL14uW146I1xbXC4sXSokLzsKICAgICAgICBndC5maWx0ZXIgPSBmdW5jdGlvbih0LCBlLCBu
KSB7CiAgICAgICAgICAgIHZhciBpID0gZVswXTsKICAgICAgICAgICAgcmV0dXJuIG4gJiYgKHQg
PSAiOm5vdCgiICsgdCArICIpIiksIDEgPT09IGUubGVuZ3RoICYmIDEgPT09IGkubm9kZVR5cGUg
PyBndC5maW5kLm1hdGNoZXNTZWxlY3RvcihpLCB0KSA/IFtpXSA6IFtdIDogZ3QuZmluZC5tYXRj
aGVzKHQsIGd0LmdyZXAoZSwgZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgcmV0dXJuIDEg
PT09IHQubm9kZVR5cGUKICAgICAgICAgICAgfSkpCiAgICAgICAgfSwgZ3QuZm4uZXh0ZW5kKHsK
ICAgICAgICAgICAgZmluZDogZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgdmFyIGUsIG4s
IGkgPSB0aGlzLmxlbmd0aCwKICAgICAgICAgICAgICAgICAgICBvID0gdGhpczsKICAgICAgICAg
ICAgICAgIGlmICgic3RyaW5nIiAhPSB0eXBlb2YgdCkgcmV0dXJuIHRoaXMucHVzaFN0YWNrKGd0
KHQpLmZpbHRlcihmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICBmb3IgKGUgPSAwOyBl
IDwgaTsgZSsrKQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ3QuY29udGFpbnMob1tlXSwg
dGhpcykpIHJldHVybiAhMAogICAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAgICAgZm9y
IChuID0gdGhpcy5wdXNoU3RhY2soW10pLCBlID0gMDsgZSA8IGk7IGUrKykgZ3QuZmluZCh0LCBv
W2VdLCBuKTsKICAgICAgICAgICAgICAgIHJldHVybiBpID4gMSA/IGd0LnVuaXF1ZVNvcnQobikg
OiBuCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGZpbHRlcjogZnVuY3Rpb24odCkgewogICAg
ICAgICAgICAgICAgcmV0dXJuIHRoaXMucHVzaFN0YWNrKHIodGhpcywgdCB8fCBbXSwgITEpKQog
ICAgICAgICAgICB9LAogICAgICAgICAgICBub3Q6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAg
ICAgIHJldHVybiB0aGlzLnB1c2hTdGFjayhyKHRoaXMsIHQgfHwgW10sICEwKSkKICAgICAgICAg
ICAgfSwKICAgICAgICAgICAgaXM6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIHJldHVy
biAhIXIodGhpcywgInN0cmluZyIgPT0gdHlwZW9mIHQgJiYgYnQudGVzdCh0KSA/IGd0KHQpIDog
dCB8fCBbXSwgITEpLmxlbmd0aAogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgdmFy
IEN0LCBTdCA9IC9eKD86XHMqKDxbXHdcV10rPilbXj5dKnwjKFtcdy1dKykpJC87CiAgICAgICAg
KGd0LmZuLmluaXQgPSBmdW5jdGlvbih0LCBlLCBuKSB7CiAgICAgICAgICAgIHZhciBpLCBvOwog
ICAgICAgICAgICBpZiAoIXQpIHJldHVybiB0aGlzOwogICAgICAgICAgICBpZiAobiA9IG4gfHwg
Q3QsICJzdHJpbmciID09IHR5cGVvZiB0KSB7CiAgICAgICAgICAgICAgICBpZiAoIShpID0gIjwi
ID09PSB0WzBdICYmICI+IiA9PT0gdFt0Lmxlbmd0aCAtIDFdICYmIHQubGVuZ3RoID49IDMgPyBb
bnVsbCwgdCwgbnVsbF0gOiBTdC5leGVjKHQpKSB8fCAhaVsxXSAmJiBlKSByZXR1cm4gIWUgfHwg
ZS5qcXVlcnkgPyAoZSB8fCBuKS5maW5kKHQpIDogdGhpcy5jb25zdHJ1Y3RvcihlKS5maW5kKHQp
OwogICAgICAgICAgICAgICAgaWYgKGlbMV0pIHsKICAgICAgICAgICAgICAgICAgICBpZiAoZSA9
IGUgaW5zdGFuY2VvZiBndCA/IGVbMF0gOiBlLCBndC5tZXJnZSh0aGlzLCBndC5wYXJzZUhUTUwo
aVsxXSwgZSAmJiBlLm5vZGVUeXBlID8gZS5vd25lckRvY3VtZW50IHx8IGUgOiBudCwgITApKSwg
VHQudGVzdChpWzFdKSAmJiBndC5pc1BsYWluT2JqZWN0KGUpKQogICAgICAgICAgICAgICAgICAg
ICAgICBmb3IgKGkgaW4gZSkgZ3QuaXNGdW5jdGlvbih0aGlzW2ldKSA/IHRoaXNbaV0oZVtpXSkg
OiB0aGlzLmF0dHIoaSwgZVtpXSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMKICAg
ICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBvID0gbnQuZ2V0RWxlbWVudEJ5
SWQoaVsyXSksIG8gJiYgKHRoaXNbMF0gPSBvLCB0aGlzLmxlbmd0aCA9IDEpLCB0aGlzCiAgICAg
ICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHQubm9kZVR5cGUgPyAodGhpc1swXSA9IHQsIHRo
aXMubGVuZ3RoID0gMSwgdGhpcykgOiBndC5pc0Z1bmN0aW9uKHQpID8gdm9pZCAwICE9PSBuLnJl
YWR5ID8gbi5yZWFkeSh0KSA6IHQoZ3QpIDogZ3QubWFrZUFycmF5KHQsIHRoaXMpCiAgICAgICAg
fSkucHJvdG90eXBlID0gZ3QuZm4sIEN0ID0gZ3QobnQpOwogICAgICAgIHZhciBFdCA9IC9eKD86
cGFyZW50c3xwcmV2KD86VW50aWx8QWxsKSkvLAogICAgICAgICAgICBBdCA9IHsKICAgICAgICAg
ICAgICAgIGNoaWxkcmVuOiAhMCwKICAgICAgICAgICAgICAgIGNvbnRlbnRzOiAhMCwKICAgICAg
ICAgICAgICAgIG5leHQ6ICEwLAogICAgICAgICAgICAgICAgcHJldjogITAKICAgICAgICAgICAg
fTsKICAgICAgICBndC5mbi5leHRlbmQoewogICAgICAgICAgICBoYXM6IGZ1bmN0aW9uKHQpIHsK
ICAgICAgICAgICAgICAgIHZhciBlID0gZ3QodCwgdGhpcyksCiAgICAgICAgICAgICAgICAgICAg
biA9IGUubGVuZ3RoOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmlsdGVyKGZ1bmN0aW9u
KCkgewogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHQgPSAwOyB0IDwgbjsgdCsrKQogICAg
ICAgICAgICAgICAgICAgICAgICBpZiAoZ3QuY29udGFpbnModGhpcywgZVt0XSkpIHJldHVybiAh
MAogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfSwKICAgICAgICAgICAgY2xvc2VzdDog
ZnVuY3Rpb24odCwgZSkgewogICAgICAgICAgICAgICAgdmFyIG4sIGkgPSAwLAogICAgICAgICAg
ICAgICAgICAgIG8gPSB0aGlzLmxlbmd0aCwKICAgICAgICAgICAgICAgICAgICByID0gW10sCiAg
ICAgICAgICAgICAgICAgICAgcyA9ICJzdHJpbmciICE9IHR5cGVvZiB0ICYmIGd0KHQpOwogICAg
ICAgICAgICAgICAgaWYgKCFidC50ZXN0KHQpKQogICAgICAgICAgICAgICAgICAgIGZvciAoOyBp
IDwgbzsgaSsrKQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKG4gPSB0aGlzW2ldOyBuICYm
IG4gIT09IGU7IG4gPSBuLnBhcmVudE5vZGUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBp
ZiAobi5ub2RlVHlwZSA8IDExICYmIChzID8gcy5pbmRleChuKSA+IC0xIDogMSA9PT0gbi5ub2Rl
VHlwZSAmJiBndC5maW5kLm1hdGNoZXNTZWxlY3RvcihuLCB0KSkpIHsKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICByLnB1c2gobik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJl
dHVybiB0aGlzLnB1c2hTdGFjayhyLmxlbmd0aCA+IDEgPyBndC51bmlxdWVTb3J0KHIpIDogcikK
ICAgICAgICAgICAgfSwKICAgICAgICAgICAgaW5kZXg6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAg
ICAgICAgIHJldHVybiB0ID8gInN0cmluZyIgPT0gdHlwZW9mIHQgPyBhdC5jYWxsKGd0KHQpLCB0
aGlzWzBdKSA6IGF0LmNhbGwodGhpcywgdC5qcXVlcnkgPyB0WzBdIDogdCkgOiB0aGlzWzBdICYm
IHRoaXNbMF0ucGFyZW50Tm9kZSA/IHRoaXMuZmlyc3QoKS5wcmV2QWxsKCkubGVuZ3RoIDogLTEK
ICAgICAgICAgICAgfSwKICAgICAgICAgICAgYWRkOiBmdW5jdGlvbih0LCBlKSB7CiAgICAgICAg
ICAgICAgICByZXR1cm4gdGhpcy5wdXNoU3RhY2soZ3QudW5pcXVlU29ydChndC5tZXJnZSh0aGlz
LmdldCgpLCBndCh0LCBlKSkpKQogICAgICAgICAgICB9LAogICAgICAgICAgICBhZGRCYWNrOiBm
dW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hZGQobnVsbCA9PSB0ID8g
dGhpcy5wcmV2T2JqZWN0IDogdGhpcy5wcmV2T2JqZWN0LmZpbHRlcih0KSkKICAgICAgICAgICAg
fQogICAgICAgIH0pLCBndC5lYWNoKHsKICAgICAgICAgICAgcGFyZW50OiBmdW5jdGlvbih0KSB7
CiAgICAgICAgICAgICAgICB2YXIgZSA9IHQucGFyZW50Tm9kZTsKICAgICAgICAgICAgICAgIHJl
dHVybiBlICYmIDExICE9PSBlLm5vZGVUeXBlID8gZSA6IG51bGwKICAgICAgICAgICAgfSwKICAg
ICAgICAgICAgcGFyZW50czogZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHl0
KHQsICJwYXJlbnROb2RlIikKICAgICAgICAgICAgfSwKICAgICAgICAgICAgcGFyZW50c1VudGls
OiBmdW5jdGlvbih0LCBlLCBuKSB7CiAgICAgICAgICAgICAgICByZXR1cm4geXQodCwgInBhcmVu
dE5vZGUiLCBuKQogICAgICAgICAgICB9LAogICAgICAgICAgICBuZXh0OiBmdW5jdGlvbih0KSB7
CiAgICAgICAgICAgICAgICByZXR1cm4gcyh0LCAibmV4dFNpYmxpbmciKQogICAgICAgICAgICB9
LAogICAgICAgICAgICBwcmV2OiBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4g
cyh0LCAicHJldmlvdXNTaWJsaW5nIikKICAgICAgICAgICAgfSwKICAgICAgICAgICAgbmV4dEFs
bDogZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHl0KHQsICJuZXh0U2libGlu
ZyIpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHByZXZBbGw6IGZ1bmN0aW9uKHQpIHsKICAg
ICAgICAgICAgICAgIHJldHVybiB5dCh0LCAicHJldmlvdXNTaWJsaW5nIikKICAgICAgICAgICAg
fSwKICAgICAgICAgICAgbmV4dFVudGlsOiBmdW5jdGlvbih0LCBlLCBuKSB7CiAgICAgICAgICAg
ICAgICByZXR1cm4geXQodCwgIm5leHRTaWJsaW5nIiwgbikKICAgICAgICAgICAgfSwKICAgICAg
ICAgICAgcHJldlVudGlsOiBmdW5jdGlvbih0LCBlLCBuKSB7CiAgICAgICAgICAgICAgICByZXR1
cm4geXQodCwgInByZXZpb3VzU2libGluZyIsIG4pCiAgICAgICAgICAgIH0sCiAgICAgICAgICAg
IHNpYmxpbmdzOiBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4geHQoKHQucGFy
ZW50Tm9kZSB8fCB7fSkuZmlyc3RDaGlsZCwgdCkKICAgICAgICAgICAgfSwKICAgICAgICAgICAg
Y2hpbGRyZW46IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIHJldHVybiB4dCh0LmZpcnN0
Q2hpbGQpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGNvbnRlbnRzOiBmdW5jdGlvbih0KSB7
CiAgICAgICAgICAgICAgICByZXR1cm4gbyh0LCAiaWZyYW1lIikgPyB0LmNvbnRlbnREb2N1bWVu
dCA6IChvKHQsICJ0ZW1wbGF0ZSIpICYmICh0ID0gdC5jb250ZW50IHx8IHQpLCBndC5tZXJnZShb
XSwgdC5jaGlsZE5vZGVzKSkKICAgICAgICAgICAgfQogICAgICAgIH0sIGZ1bmN0aW9uKHQsIGUp
IHsKICAgICAgICAgICAgZ3QuZm5bdF0gPSBmdW5jdGlvbihuLCBpKSB7CiAgICAgICAgICAgICAg
ICB2YXIgbyA9IGd0Lm1hcCh0aGlzLCBlLCBuKTsKICAgICAgICAgICAgICAgIHJldHVybiAiVW50
aWwiICE9PSB0LnNsaWNlKC01KSAmJiAoaSA9IG4pLCBpICYmICJzdHJpbmciID09IHR5cGVvZiBp
ICYmIChvID0gZ3QuZmlsdGVyKGksIG8pKSwgdGhpcy5sZW5ndGggPiAxICYmIChBdFt0XSB8fCBn
dC51bmlxdWVTb3J0KG8pLCBFdC50ZXN0KHQpICYmIG8ucmV2ZXJzZSgpKSwgdGhpcy5wdXNoU3Rh
Y2sobykKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIHZhciBrdCA9IC9bXlx4MjBc
dFxyXG5cZl0rL2c7CiAgICAgICAgZ3QuQ2FsbGJhY2tzID0gZnVuY3Rpb24odCkgewogICAgICAg
ICAgICB0ID0gInN0cmluZyIgPT0gdHlwZW9mIHQgPyBhKHQpIDogZ3QuZXh0ZW5kKHt9LCB0KTsK
ICAgICAgICAgICAgdmFyIGUsIG4sIGksIG8sIHIgPSBbXSwKICAgICAgICAgICAgICAgIHMgPSBb
XSwKICAgICAgICAgICAgICAgIHUgPSAtMSwKICAgICAgICAgICAgICAgIGwgPSBmdW5jdGlvbigp
IHsKICAgICAgICAgICAgICAgICAgICBmb3IgKG8gPSBvIHx8IHQub25jZSwgaSA9IGUgPSAhMDsg
cy5sZW5ndGg7IHUgPSAtMSkKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChuID0gcy5zaGlm
dCgpOyArK3UgPCByLmxlbmd0aDspICExID09PSByW3VdLmFwcGx5KG5bMF0sIG5bMV0pICYmIHQu
c3RvcE9uRmFsc2UgJiYgKHUgPSByLmxlbmd0aCwgbiA9ICExKTsKICAgICAgICAgICAgICAgICAg
ICB0Lm1lbW9yeSB8fCAobiA9ICExKSwgZSA9ICExLCBvICYmIChyID0gbiA/IFtdIDogIiIpCiAg
ICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgYyA9IHsKICAgICAgICAgICAgICAgICAg
ICBhZGQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gciAmJiAo
biAmJiAhZSAmJiAodSA9IHIubGVuZ3RoIC0gMSwgcy5wdXNoKG4pKSwgZnVuY3Rpb24gZShuKSB7
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBndC5lYWNoKG4sIGZ1bmN0aW9uKG4sIGkpIHsK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBndC5pc0Z1bmN0aW9uKGkpID8gdC51bmlx
dWUgJiYgYy5oYXMoaSkgfHwgci5wdXNoKGkpIDogaSAmJiBpLmxlbmd0aCAmJiAic3RyaW5nIiAh
PT0gZ3QudHlwZShpKSAmJiBlKGkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAg
ICAgICAgICAgICAgICAgICAgICB9KGFyZ3VtZW50cyksIG4gJiYgIWUgJiYgbCgpKSwgdGhpcwog
ICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlOiBmdW5jdGlv
bigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGd0LmVhY2goYXJndW1lbnRzLCBm
dW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBuOwog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChuID0gZ3QuaW5BcnJheShlLCByLCBuKSkg
PiAtMTspIHIuc3BsaWNlKG4sIDEpLCBuIDw9IHUgJiYgdS0tCiAgICAgICAgICAgICAgICAgICAg
ICAgIH0pLCB0aGlzCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBo
YXM6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQgPyBndC5p
bkFycmF5KHQsIHIpID4gLTEgOiByLmxlbmd0aCA+IDAKICAgICAgICAgICAgICAgICAgICB9LAog
ICAgICAgICAgICAgICAgICAgIGVtcHR5OiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAg
ICAgICAgcmV0dXJuIHIgJiYgKHIgPSBbXSksIHRoaXMKICAgICAgICAgICAgICAgICAgICB9LAog
ICAgICAgICAgICAgICAgICAgIGRpc2FibGU6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAg
ICAgICAgICByZXR1cm4gbyA9IHMgPSBbXSwgciA9IG4gPSAiIiwgdGhpcwogICAgICAgICAgICAg
ICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ6IGZ1bmN0aW9uKCkgewogICAg
ICAgICAgICAgICAgICAgICAgICByZXR1cm4gIXIKICAgICAgICAgICAgICAgICAgICB9LAogICAg
ICAgICAgICAgICAgICAgIGxvY2s6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAg
ICByZXR1cm4gbyA9IHMgPSBbXSwgbiB8fCBlIHx8IChyID0gbiA9ICIiKSwgdGhpcwogICAgICAg
ICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgbG9ja2VkOiBmdW5jdGlvbigpIHsK
ICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICEhbwogICAgICAgICAgICAgICAgICAgIH0s
CiAgICAgICAgICAgICAgICAgICAgZmlyZVdpdGg6IGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICAg
ICAgICAgICAgICAgICAgcmV0dXJuIG8gfHwgKG4gPSBuIHx8IFtdLCBuID0gW3QsIG4uc2xpY2Ug
PyBuLnNsaWNlKCkgOiBuXSwgcy5wdXNoKG4pLCBlIHx8IGwoKSksIHRoaXMKICAgICAgICAgICAg
ICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIGZpcmU6IGZ1bmN0aW9uKCkgewogICAgICAg
ICAgICAgICAgICAgICAgICByZXR1cm4gYy5maXJlV2l0aCh0aGlzLCBhcmd1bWVudHMpLCB0aGlz
CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBmaXJlZDogZnVuY3Rp
b24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhIWkKICAgICAgICAgICAgICAg
ICAgICB9CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICByZXR1cm4gYwogICAgICAgIH0s
IGd0LmV4dGVuZCh7CiAgICAgICAgICAgIERlZmVycmVkOiBmdW5jdGlvbihlKSB7CiAgICAgICAg
ICAgICAgICB2YXIgbiA9IFsKICAgICAgICAgICAgICAgICAgICAgICAgWyJub3RpZnkiLCAicHJv
Z3Jlc3MiLCBndC5DYWxsYmFja3MoIm1lbW9yeSIpLCBndC5DYWxsYmFja3MoIm1lbW9yeSIpLCAy
XSwKICAgICAgICAgICAgICAgICAgICAgICAgWyJyZXNvbHZlIiwgImRvbmUiLCBndC5DYWxsYmFj
a3MoIm9uY2UgbWVtb3J5IiksIGd0LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSwgMCwgInJlc29s
dmVkIl0sCiAgICAgICAgICAgICAgICAgICAgICAgIFsicmVqZWN0IiwgImZhaWwiLCBndC5DYWxs
YmFja3MoIm9uY2UgbWVtb3J5IiksIGd0LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSwgMSwgInJl
amVjdGVkIl0KICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgICAgIGkgPSAi
cGVuZGluZyIsCiAgICAgICAgICAgICAgICAgICAgbyA9IHsKICAgICAgICAgICAgICAgICAgICAg
ICAgc3RhdGU6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJu
IGkKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgYWx3
YXlzOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByLmRv
bmUoYXJndW1lbnRzKS5mYWlsKGFyZ3VtZW50cyksIHRoaXMKICAgICAgICAgICAgICAgICAgICAg
ICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2g6IGZ1bmN0aW9uKHQpIHsKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvLnRoZW4obnVsbCwgdCkKICAgICAgICAgICAg
ICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgcGlwZTogZnVuY3Rpb24oKSB7
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdCA9IGFyZ3VtZW50czsKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHJldHVybiBndC5EZWZlcnJlZChmdW5jdGlvbihlKSB7CiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3QuZWFjaChuLCBmdW5jdGlvbihuLCBpKSB7CiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvID0gZ3QuaXNGdW5jdGlvbih0
W2lbNF1dKSAmJiB0W2lbNF1dOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBy
W2lbMV1dKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgdmFyIHQgPSBvICYmIG8uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHQgJiYgZ3QuaXNGdW5jdGlvbih0LnByb21pc2UpID8g
dC5wcm9taXNlKCkucHJvZ3Jlc3MoZS5ub3RpZnkpLmRvbmUoZS5yZXNvbHZlKS5mYWlsKGUucmVq
ZWN0KSA6IGVbaVswXSArICJXaXRoIl0odGhpcywgbyA/IFt0XSA6IGFyZ3VtZW50cykKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB9KSwgdCA9IG51bGwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLnByb21p
c2UoKQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICB0
aGVuOiBmdW5jdGlvbihlLCBpLCBvKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5j
dGlvbiByKGUsIG4sIGksIG8pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1
cm4gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBh
ID0gdGhpcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBhcmd1
bWVudHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwID0gZnVuY3Rp
b24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHQs
IHA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoZSA8
IHMpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlm
ICgodCA9IGkuYXBwbHkoYSwgYykpID09PSBuLnByb21pc2UoKSkgdGhyb3cgbmV3IFR5cGVFcnJv
cigiVGhlbmFibGUgc2VsZi1yZXNvbHV0aW9uIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHAgPSB0ICYmICgib2JqZWN0IiA9PSB0eXBlb2YgdCB8fCAi
ZnVuY3Rpb24iID09IHR5cGVvZiB0KSAmJiB0LnRoZW4sIGd0LmlzRnVuY3Rpb24ocCkgPyBvID8g
cC5jYWxsKHQsIHIocywgbiwgdSwgbyksIHIocywgbiwgbCwgbykpIDogKHMrKywgcC5jYWxsKHQs
IHIocywgbiwgdSwgbyksIHIocywgbiwgbCwgbyksIHIocywgbiwgdSwgbi5ub3RpZnlXaXRoKSkp
IDogKGkgIT09IHUgJiYgKGEgPSB2b2lkIDAsIGMgPSBbdF0pLCAobyB8fCBuLnJlc29sdmVXaXRo
KShhLCBjKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgaCA9IG8gPyBwIDogZnVuY3Rpb24oKSB7CiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcCgpCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBndC5EZWZlcnJlZC5leGNlcHRpb25Ib29rICYm
IGd0LkRlZmVycmVkLmV4Y2VwdGlvbkhvb2sodCwgaC5zdGFja1RyYWNlKSwgZSArIDEgPj0gcyAm
JiAoaSAhPT0gbCAmJiAoYSA9IHZvaWQgMCwgYyA9IFt0XSksIG4ucmVqZWN0V2l0aChhLCBjKSkK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBlID8gaCgpIDogKGd0LkRlZmVycmVkLmdldFN0YWNrSG9vayAmJiAoaC5zdGFj
a1RyYWNlID0gZ3QuRGVmZXJyZWQuZ2V0U3RhY2tIb29rKCkpLCB0LnNldFRpbWVvdXQoaCkpCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHMgPSAwOwogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgcmV0dXJuIGd0LkRlZmVycmVkKGZ1bmN0aW9uKHQpIHsKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBuWzBdWzNdLmFkZChyKDAsIHQsIGd0LmlzRnVuY3Rpb24o
bykgPyBvIDogdSwgdC5ub3RpZnlXaXRoKSksIG5bMV1bM10uYWRkKHIoMCwgdCwgZ3QuaXNGdW5j
dGlvbihlKSA/IGUgOiB1KSksIG5bMl1bM10uYWRkKHIoMCwgdCwgZ3QuaXNGdW5jdGlvbihpKSA/
IGkgOiBsKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLnByb21pc2UoKQogICAgICAg
ICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBwcm9taXNlOiBmdW5j
dGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbCAhPSB0ID8g
Z3QuZXh0ZW5kKHQsIG8pIDogbwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg
ICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICByID0ge307CiAgICAgICAgICAgICAgICBy
ZXR1cm4gZ3QuZWFjaChuLCBmdW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAgICAgICAgICAgdmFy
IHMgPSBlWzJdLAogICAgICAgICAgICAgICAgICAgICAgICBhID0gZVs1XTsKICAgICAgICAgICAg
ICAgICAgICBvW2VbMV1dID0gcy5hZGQsIGEgJiYgcy5hZGQoZnVuY3Rpb24oKSB7CiAgICAgICAg
ICAgICAgICAgICAgICAgIGkgPSBhCiAgICAgICAgICAgICAgICAgICAgfSwgblszIC0gdF1bMl0u
ZGlzYWJsZSwgblswXVsyXS5sb2NrKSwgcy5hZGQoZVszXS5maXJlKSwgcltlWzBdXSA9IGZ1bmN0
aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcltlWzBdICsgIldpdGgiXSh0
aGlzID09PSByID8gdm9pZCAwIDogdGhpcywgYXJndW1lbnRzKSwgdGhpcwogICAgICAgICAgICAg
ICAgICAgIH0sIHJbZVswXSArICJXaXRoIl0gPSBzLmZpcmVXaXRoCiAgICAgICAgICAgICAgICB9
KSwgby5wcm9taXNlKHIpLCBlICYmIGUuY2FsbChyLCByKSwgcgogICAgICAgICAgICB9LAogICAg
ICAgICAgICB3aGVuOiBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICB2YXIgZSA9IGFyZ3Vt
ZW50cy5sZW5ndGgsCiAgICAgICAgICAgICAgICAgICAgbiA9IGUsCiAgICAgICAgICAgICAgICAg
ICAgaSA9IEFycmF5KG4pLAogICAgICAgICAgICAgICAgICAgIG8gPSBvdC5jYWxsKGFyZ3VtZW50
cyksCiAgICAgICAgICAgICAgICAgICAgciA9IGd0LkRlZmVycmVkKCksCiAgICAgICAgICAgICAg
ICAgICAgcyA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1
bmN0aW9uKG4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlbdF0gPSB0aGlzLCBvW3Rd
ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBvdC5jYWxsKGFyZ3VtZW50cykgOiBuLCAtLWUgfHwg
ci5yZXNvbHZlV2l0aChpLCBvKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg
ICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGlmIChlIDw9IDEgJiYgKGModCwgci5kb25lKHMo
bikpLnJlc29sdmUsIHIucmVqZWN0LCAhZSksICJwZW5kaW5nIiA9PT0gci5zdGF0ZSgpIHx8IGd0
LmlzRnVuY3Rpb24ob1tuXSAmJiBvW25dLnRoZW4pKSkgcmV0dXJuIHIudGhlbigpOwogICAgICAg
ICAgICAgICAgZm9yICg7IG4tLTspIGMob1tuXSwgcyhuKSwgci5yZWplY3QpOwogICAgICAgICAg
ICAgICAgcmV0dXJuIHIucHJvbWlzZSgpCiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAg
ICB2YXIgRHQgPSAvXihFdmFsfEludGVybmFsfFJhbmdlfFJlZmVyZW5jZXxTeW50YXh8VHlwZXxV
UkkpRXJyb3IkLzsKICAgICAgICBndC5EZWZlcnJlZC5leGNlcHRpb25Ib29rID0gZnVuY3Rpb24o
ZSwgbikgewogICAgICAgICAgICB0LmNvbnNvbGUgJiYgdC5jb25zb2xlLndhcm4gJiYgZSAmJiBE
dC50ZXN0KGUubmFtZSkgJiYgdC5jb25zb2xlLndhcm4oImpRdWVyeS5EZWZlcnJlZCBleGNlcHRp
b246ICIgKyBlLm1lc3NhZ2UsIGUuc3RhY2ssIG4pCiAgICAgICAgfSwgZ3QucmVhZHlFeGNlcHRp
b24gPSBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgIHQuc2V0VGltZW91dChmdW5jdGlvbigpIHsK
ICAgICAgICAgICAgICAgIHRocm93IGUKICAgICAgICAgICAgfSkKICAgICAgICB9OwogICAgICAg
IHZhciBOdCA9IGd0LkRlZmVycmVkKCk7CiAgICAgICAgZ3QuZm4ucmVhZHkgPSBmdW5jdGlvbih0
KSB7CiAgICAgICAgICAgIHJldHVybiBOdC50aGVuKHQpLmNhdGNoKGZ1bmN0aW9uKHQpIHsKICAg
ICAgICAgICAgICAgIGd0LnJlYWR5RXhjZXB0aW9uKHQpCiAgICAgICAgICAgIH0pLCB0aGlzCiAg
ICAgICAgfSwgZ3QuZXh0ZW5kKHsKICAgICAgICAgICAgaXNSZWFkeTogITEsCiAgICAgICAgICAg
IHJlYWR5V2FpdDogMSwKICAgICAgICAgICAgcmVhZHk6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAg
ICAgICAgICghMCA9PT0gdCA/IC0tZ3QucmVhZHlXYWl0IDogZ3QuaXNSZWFkeSkgfHwgKGd0Lmlz
UmVhZHkgPSAhMCwgITAgIT09IHQgJiYgLS1ndC5yZWFkeVdhaXQgPiAwIHx8IE50LnJlc29sdmVX
aXRoKG50LCBbZ3RdKSkKICAgICAgICAgICAgfQogICAgICAgIH0pLCBndC5yZWFkeS50aGVuID0g
TnQudGhlbiwgImNvbXBsZXRlIiA9PT0gbnQucmVhZHlTdGF0ZSB8fCAibG9hZGluZyIgIT09IG50
LnJlYWR5U3RhdGUgJiYgIW50LmRvY3VtZW50RWxlbWVudC5kb1Njcm9sbCA/IHQuc2V0VGltZW91
dChndC5yZWFkeSkgOiAobnQuYWRkRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsIHAp
LCB0LmFkZEV2ZW50TGlzdGVuZXIoImxvYWQiLCBwKSk7CiAgICAgICAgdmFyIE10ID0gZnVuY3Rp
b24odCwgZSwgbiwgaSwgbywgciwgcykgewogICAgICAgICAgICAgICAgdmFyIGEgPSAwLAogICAg
ICAgICAgICAgICAgICAgIHUgPSB0Lmxlbmd0aCwKICAgICAgICAgICAgICAgICAgICBsID0gbnVs
bCA9PSBuOwogICAgICAgICAgICAgICAgaWYgKCJvYmplY3QiID09PSBndC50eXBlKG4pKSB7CiAg
ICAgICAgICAgICAgICAgICAgbyA9ICEwOwogICAgICAgICAgICAgICAgICAgIGZvciAoYSBpbiBu
KSBNdCh0LCBlLCBhLCBuW2FdLCAhMCwgciwgcykKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAo
dm9pZCAwICE9PSBpICYmIChvID0gITAsIGd0LmlzRnVuY3Rpb24oaSkgfHwgKHMgPSAhMCksIGwg
JiYgKHMgPyAoZS5jYWxsKHQsIGkpLCBlID0gbnVsbCkgOiAobCA9IGUsIGUgPSBmdW5jdGlvbih0
LCBlLCBuKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsLmNhbGwoZ3QodCksIG4p
CiAgICAgICAgICAgICAgICAgICAgfSkpLCBlKSkKICAgICAgICAgICAgICAgICAgICBmb3IgKDsg
YSA8IHU7IGErKykgZSh0W2FdLCBuLCBzID8gaSA6IGkuY2FsbCh0W2FdLCBhLCBlKHRbYV0sIG4p
KSk7CiAgICAgICAgICAgICAgICByZXR1cm4gbyA/IHQgOiBsID8gZS5jYWxsKHQpIDogdSA/IGUo
dFswXSwgbikgOiByCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGp0ID0gZnVuY3Rpb24odCkg
ewogICAgICAgICAgICAgICAgcmV0dXJuIDEgPT09IHQubm9kZVR5cGUgfHwgOSA9PT0gdC5ub2Rl
VHlwZSB8fCAhK3Qubm9kZVR5cGUKICAgICAgICAgICAgfTsKICAgICAgICBoLnVpZCA9IDEsIGgu
cHJvdG90eXBlID0gewogICAgICAgICAgICBjYWNoZTogZnVuY3Rpb24odCkgewogICAgICAgICAg
ICAgICAgdmFyIGUgPSB0W3RoaXMuZXhwYW5kb107CiAgICAgICAgICAgICAgICByZXR1cm4gZSB8
fCAoZSA9IHt9LCBqdCh0KSAmJiAodC5ub2RlVHlwZSA/IHRbdGhpcy5leHBhbmRvXSA9IGUgOiBP
YmplY3QuZGVmaW5lUHJvcGVydHkodCwgdGhpcy5leHBhbmRvLCB7CiAgICAgICAgICAgICAgICAg
ICAgdmFsdWU6IGUsCiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiAhMAogICAgICAg
ICAgICAgICAgfSkpKSwgZQogICAgICAgICAgICB9LAogICAgICAgICAgICBzZXQ6IGZ1bmN0aW9u
KHQsIGUsIG4pIHsKICAgICAgICAgICAgICAgIHZhciBpLCBvID0gdGhpcy5jYWNoZSh0KTsKICAg
ICAgICAgICAgICAgIGlmICgic3RyaW5nIiA9PSB0eXBlb2YgZSkgb1tndC5jYW1lbENhc2UoZSld
ID0gbjsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBmb3IgKGkgaW4g
ZSkgb1tndC5jYW1lbENhc2UoaSldID0gZVtpXTsKICAgICAgICAgICAgICAgIHJldHVybiBvCiAg
ICAgICAgICAgIH0sCiAgICAgICAgICAgIGdldDogZnVuY3Rpb24odCwgZSkgewogICAgICAgICAg
ICAgICAgcmV0dXJuIHZvaWQgMCA9PT0gZSA/IHRoaXMuY2FjaGUodCkgOiB0W3RoaXMuZXhwYW5k
b10gJiYgdFt0aGlzLmV4cGFuZG9dW2d0LmNhbWVsQ2FzZShlKV0KICAgICAgICAgICAgfSwKICAg
ICAgICAgICAgYWNjZXNzOiBmdW5jdGlvbih0LCBlLCBuKSB7CiAgICAgICAgICAgICAgICByZXR1
cm4gdm9pZCAwID09PSBlIHx8IGUgJiYgInN0cmluZyIgPT0gdHlwZW9mIGUgJiYgdm9pZCAwID09
PSBuID8gdGhpcy5nZXQodCwgZSkgOiAodGhpcy5zZXQodCwgZSwgbiksIHZvaWQgMCAhPT0gbiA/
IG4gOiBlKQogICAgICAgICAgICB9LAogICAgICAgICAgICByZW1vdmU6IGZ1bmN0aW9uKHQsIGUp
IHsKICAgICAgICAgICAgICAgIHZhciBuLCBpID0gdFt0aGlzLmV4cGFuZG9dOwogICAgICAgICAg
ICAgICAgaWYgKHZvaWQgMCAhPT0gaSkgewogICAgICAgICAgICAgICAgICAgIGlmICh2b2lkIDAg
IT09IGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgQXJyYXkuaXNBcnJheShlKSA/IGUgPSBl
Lm1hcChndC5jYW1lbENhc2UpIDogKGUgPSBndC5jYW1lbENhc2UoZSksIGUgPSBlIGluIGkgPyBb
ZV0gOiBlLm1hdGNoKGt0KSB8fCBbXSksIG4gPSBlLmxlbmd0aDsKICAgICAgICAgICAgICAgICAg
ICAgICAgZm9yICg7IG4tLTspIGRlbGV0ZSBpW2Vbbl1dCiAgICAgICAgICAgICAgICAgICAgfSh2
b2lkIDAgPT09IGUgfHwgZ3QuaXNFbXB0eU9iamVjdChpKSkgJiYgKHQubm9kZVR5cGUgPyB0W3Ro
aXMuZXhwYW5kb10gPSB2b2lkIDAgOiBkZWxldGUgdFt0aGlzLmV4cGFuZG9dKQogICAgICAgICAg
ICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICBoYXNEYXRhOiBmdW5jdGlvbih0KSB7
CiAgICAgICAgICAgICAgICB2YXIgZSA9IHRbdGhpcy5leHBhbmRvXTsKICAgICAgICAgICAgICAg
IHJldHVybiB2b2lkIDAgIT09IGUgJiYgIWd0LmlzRW1wdHlPYmplY3QoZSkKICAgICAgICAgICAg
fQogICAgICAgIH07CiAgICAgICAgdmFyIEx0ID0gbmV3IGgsCiAgICAgICAgICAgICR0ID0gbmV3
IGgsCiAgICAgICAgICAgIFB0ID0gL14oPzpce1tcd1xXXSpcfXxcW1tcd1xXXSpcXSkkLywKICAg
ICAgICAgICAgcXQgPSAvW0EtWl0vZzsKICAgICAgICBndC5leHRlbmQoewogICAgICAgICAgICBo
YXNEYXRhOiBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gJHQuaGFzRGF0YSh0
KSB8fCBMdC5oYXNEYXRhKHQpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGRhdGE6IGZ1bmN0
aW9uKHQsIGUsIG4pIHsKICAgICAgICAgICAgICAgIHJldHVybiAkdC5hY2Nlc3ModCwgZSwgbikK
ICAgICAgICAgICAgfSwKICAgICAgICAgICAgcmVtb3ZlRGF0YTogZnVuY3Rpb24odCwgZSkgewog
ICAgICAgICAgICAgICAgJHQucmVtb3ZlKHQsIGUpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAg
IF9kYXRhOiBmdW5jdGlvbih0LCBlLCBuKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gTHQuYWNj
ZXNzKHQsIGUsIG4pCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIF9yZW1vdmVEYXRhOiBmdW5j
dGlvbih0LCBlKSB7CiAgICAgICAgICAgICAgICBMdC5yZW1vdmUodCwgZSkKICAgICAgICAgICAg
fQogICAgICAgIH0pLCBndC5mbi5leHRlbmQoewogICAgICAgICAgICBkYXRhOiBmdW5jdGlvbih0
LCBlKSB7CiAgICAgICAgICAgICAgICB2YXIgbiwgaSwgbywgciA9IHRoaXNbMF0sCiAgICAgICAg
ICAgICAgICAgICAgcyA9IHIgJiYgci5hdHRyaWJ1dGVzOwogICAgICAgICAgICAgICAgaWYgKHZv
aWQgMCA9PT0gdCkgewogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmxlbmd0aCAmJiAobyA9
ICR0LmdldChyKSwgMSA9PT0gci5ub2RlVHlwZSAmJiAhTHQuZ2V0KHIsICJoYXNEYXRhQXR0cnMi
KSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChuID0gcy5sZW5ndGg7IG4tLTspIHNb
bl0gJiYgKGkgPSBzW25dLm5hbWUsIDAgPT09IGkuaW5kZXhPZigiZGF0YS0iKSAmJiAoaSA9IGd0
LmNhbWVsQ2FzZShpLnNsaWNlKDUpKSwgZChyLCBpLCBvW2ldKSkpOwogICAgICAgICAgICAgICAg
ICAgICAgICBMdC5zZXQociwgImhhc0RhdGFBdHRycyIsICEwKQogICAgICAgICAgICAgICAgICAg
IH0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gbwogICAgICAgICAgICAgICAgfQogICAgICAg
ICAgICAgICAgcmV0dXJuICJvYmplY3QiID09IHR5cGVvZiB0ID8gdGhpcy5lYWNoKGZ1bmN0aW9u
KCkgewogICAgICAgICAgICAgICAgICAgICR0LnNldCh0aGlzLCB0KQogICAgICAgICAgICAgICAg
fSkgOiBNdCh0aGlzLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIG47CiAg
ICAgICAgICAgICAgICAgICAgaWYgKHIgJiYgdm9pZCAwID09PSBlKSB7CiAgICAgICAgICAgICAg
ICAgICAgICAgIGlmICh2b2lkIDAgIT09IChuID0gJHQuZ2V0KHIsIHQpKSkgcmV0dXJuIG47CiAg
ICAgICAgICAgICAgICAgICAgICAgIGlmICh2b2lkIDAgIT09IChuID0gZChyLCB0KSkpIHJldHVy
biBuCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHRoaXMuZWFjaChmdW5jdGlvbigpIHsKICAg
ICAgICAgICAgICAgICAgICAgICAgJHQuc2V0KHRoaXMsIHQsIGUpCiAgICAgICAgICAgICAgICAg
ICAgfSkKICAgICAgICAgICAgICAgIH0sIG51bGwsIGUsIGFyZ3VtZW50cy5sZW5ndGggPiAxLCBu
dWxsLCAhMCkKICAgICAgICAgICAgfSwKICAgICAgICAgICAgcmVtb3ZlRGF0YTogZnVuY3Rpb24o
dCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHsKICAgICAg
ICAgICAgICAgICAgICAkdC5yZW1vdmUodGhpcywgdCkKICAgICAgICAgICAgICAgIH0pCiAgICAg
ICAgICAgIH0KICAgICAgICB9KSwgZ3QuZXh0ZW5kKHsKICAgICAgICAgICAgcXVldWU6IGZ1bmN0
aW9uKHQsIGUsIG4pIHsKICAgICAgICAgICAgICAgIHZhciBpOwogICAgICAgICAgICAgICAgaWYg
KHQpIHJldHVybiBlID0gKGUgfHwgImZ4IikgKyAicXVldWUiLCBpID0gTHQuZ2V0KHQsIGUpLCBu
ICYmICghaSB8fCBBcnJheS5pc0FycmF5KG4pID8gaSA9IEx0LmFjY2Vzcyh0LCBlLCBndC5tYWtl
QXJyYXkobikpIDogaS5wdXNoKG4pKSwgaSB8fCBbXQogICAgICAgICAgICB9LAogICAgICAgICAg
ICBkZXF1ZXVlOiBmdW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAgICAgICBlID0gZSB8fCAiZngi
OwogICAgICAgICAgICAgICAgdmFyIG4gPSBndC5xdWV1ZSh0LCBlKSwKICAgICAgICAgICAgICAg
ICAgICBpID0gbi5sZW5ndGgsCiAgICAgICAgICAgICAgICAgICAgbyA9IG4uc2hpZnQoKSwKICAg
ICAgICAgICAgICAgICAgICByID0gZ3QuX3F1ZXVlSG9va3ModCwgZSksCiAgICAgICAgICAgICAg
ICAgICAgcyA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICBndC5kZXF1ZXVl
KHQsIGUpCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICJpbnByb2dyZXNz
IiA9PT0gbyAmJiAobyA9IG4uc2hpZnQoKSwgaS0tKSwgbyAmJiAoImZ4IiA9PT0gZSAmJiBuLnVu
c2hpZnQoImlucHJvZ3Jlc3MiKSwgZGVsZXRlIHIuc3RvcCwgby5jYWxsKHQsIHMsIHIpKSwgIWkg
JiYgciAmJiByLmVtcHR5LmZpcmUoKQogICAgICAgICAgICB9LAogICAgICAgICAgICBfcXVldWVI
b29rczogZnVuY3Rpb24odCwgZSkgewogICAgICAgICAgICAgICAgdmFyIG4gPSBlICsgInF1ZXVl
SG9va3MiOwogICAgICAgICAgICAgICAgcmV0dXJuIEx0LmdldCh0LCBuKSB8fCBMdC5hY2Nlc3Mo
dCwgbiwgewogICAgICAgICAgICAgICAgICAgIGVtcHR5OiBndC5DYWxsYmFja3MoIm9uY2UgbWVt
b3J5IikuYWRkKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICBMdC5yZW1vdmUo
dCwgW2UgKyAicXVldWUiLCBuXSkKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAg
ICAgfSkKICAgICAgICAgICAgfQogICAgICAgIH0pLCBndC5mbi5leHRlbmQoewogICAgICAgICAg
ICBxdWV1ZTogZnVuY3Rpb24odCwgZSkgewogICAgICAgICAgICAgICAgdmFyIG4gPSAyOwogICAg
ICAgICAgICAgICAgcmV0dXJuICJzdHJpbmciICE9IHR5cGVvZiB0ICYmIChlID0gdCwgdCA9ICJm
eCIsIG4tLSksIGFyZ3VtZW50cy5sZW5ndGggPCBuID8gZ3QucXVldWUodGhpc1swXSwgdCkgOiB2
b2lkIDAgPT09IGUgPyB0aGlzIDogdGhpcy5lYWNoKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAg
ICAgICAgIHZhciBuID0gZ3QucXVldWUodGhpcywgdCwgZSk7CiAgICAgICAgICAgICAgICAgICAg
Z3QuX3F1ZXVlSG9va3ModGhpcywgdCksICJmeCIgPT09IHQgJiYgImlucHJvZ3Jlc3MiICE9PSBu
WzBdICYmIGd0LmRlcXVldWUodGhpcywgdCkKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAg
IH0sCiAgICAgICAgICAgIGRlcXVldWU6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIHJl
dHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgZ3QuZGVxdWV1
ZSh0aGlzLCB0KQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfSwKICAgICAgICAgICAg
Y2xlYXJRdWV1ZTogZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucXVl
dWUodCB8fCAiZngiLCBbXSkKICAgICAgICAgICAgfSwKICAgICAgICAgICAgcHJvbWlzZTogZnVu
Y3Rpb24odCwgZSkgewogICAgICAgICAgICAgICAgdmFyIG4sIGkgPSAxLAogICAgICAgICAgICAg
ICAgICAgIG8gPSBndC5EZWZlcnJlZCgpLAogICAgICAgICAgICAgICAgICAgIHIgPSB0aGlzLAog
ICAgICAgICAgICAgICAgICAgIHMgPSB0aGlzLmxlbmd0aCwKICAgICAgICAgICAgICAgICAgICBh
ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC0taSB8fCBvLnJlc29sdmVX
aXRoKHIsIFtyXSkKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgZm9yICgi
c3RyaW5nIiAhPSB0eXBlb2YgdCAmJiAoZSA9IHQsIHQgPSB2b2lkIDApLCB0ID0gdCB8fCAiZngi
OyBzLS07KShuID0gTHQuZ2V0KHJbc10sIHQgKyAicXVldWVIb29rcyIpKSAmJiBuLmVtcHR5ICYm
IChpKyssIG4uZW1wdHkuYWRkKGEpKTsKICAgICAgICAgICAgICAgIHJldHVybiBhKCksIG8ucHJv
bWlzZShlKQogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgdmFyIFJ0ID0gL1srLV0/
KD86XGQqXC58KVxkKyg/OltlRV1bKy1dP1xkK3wpLy5zb3VyY2UsCiAgICAgICAgICAgIEl0ID0g
bmV3IFJlZ0V4cCgiXig/OihbKy1dKT18KSgiICsgUnQgKyAiKShbYS16JV0qKSQiLCAiaSIpLAog
ICAgICAgICAgICBGdCA9IFsiVG9wIiwgIlJpZ2h0IiwgIkJvdHRvbSIsICJMZWZ0Il0sCiAgICAg
ICAgICAgIE90ID0gZnVuY3Rpb24odCwgZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHQgPSBl
IHx8IHQsICJub25lIiA9PT0gdC5zdHlsZS5kaXNwbGF5IHx8ICIiID09PSB0LnN0eWxlLmRpc3Bs
YXkgJiYgZ3QuY29udGFpbnModC5vd25lckRvY3VtZW50LCB0KSAmJiAibm9uZSIgPT09IGd0LmNz
cyh0LCAiZGlzcGxheSIpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIEh0ID0gZnVuY3Rpb24o
dCwgZSwgbiwgaSkgewogICAgICAgICAgICAgICAgdmFyIG8sIHIsIHMgPSB7fTsKICAgICAgICAg
ICAgICAgIGZvciAociBpbiBlKSBzW3JdID0gdC5zdHlsZVtyXSwgdC5zdHlsZVtyXSA9IGVbcl07
CiAgICAgICAgICAgICAgICBvID0gbi5hcHBseSh0LCBpIHx8IFtdKTsKICAgICAgICAgICAgICAg
IGZvciAociBpbiBlKSB0LnN0eWxlW3JdID0gc1tyXTsKICAgICAgICAgICAgICAgIHJldHVybiBv
CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIFd0ID0ge307CiAgICAgICAgZ3QuZm4uZXh0ZW5k
KHsKICAgICAgICAgICAgc2hvdzogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICByZXR1cm4g
dih0aGlzLCAhMCkKICAgICAgICAgICAgfSwKICAgICAgICAgICAgaGlkZTogZnVuY3Rpb24oKSB7
CiAgICAgICAgICAgICAgICByZXR1cm4gdih0aGlzKQogICAgICAgICAgICB9LAogICAgICAgICAg
ICB0b2dnbGU6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIHJldHVybiAiYm9vbGVhbiIg
PT0gdHlwZW9mIHQgPyB0ID8gdGhpcy5zaG93KCkgOiB0aGlzLmhpZGUoKSA6IHRoaXMuZWFjaChm
dW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICBPdCh0aGlzKSA/IGd0KHRoaXMpLnNob3co
KSA6IGd0KHRoaXMpLmhpZGUoKQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfQogICAg
ICAgIH0pOwogICAgICAgIHZhciBfdCA9IC9eKD86Y2hlY2tib3h8cmFkaW8pJC9pLAogICAgICAg
ICAgICBCdCA9IC88KFthLXpdW15cL1wwPlx4MjBcdFxyXG5cZl0rKS9pLAogICAgICAgICAgICB6
dCA9IC9eJHxcLyg/OmphdmF8ZWNtYSlzY3JpcHQvaSwKICAgICAgICAgICAgWHQgPSB7CiAgICAg
ICAgICAgICAgICBvcHRpb246IFsxLCAiPHNlbGVjdCBtdWx0aXBsZT0nbXVsdGlwbGUnPiIsICI8
L3NlbGVjdD4iXSwKICAgICAgICAgICAgICAgIHRoZWFkOiBbMSwgIjx0YWJsZT4iLCAiPC90YWJs
ZT4iXSwKICAgICAgICAgICAgICAgIGNvbDogWzIsICI8dGFibGU+PGNvbGdyb3VwPiIsICI8L2Nv
bGdyb3VwPjwvdGFibGU+Il0sCiAgICAgICAgICAgICAgICB0cjogWzIsICI8dGFibGU+PHRib2R5
PiIsICI8L3Rib2R5PjwvdGFibGU+Il0sCiAgICAgICAgICAgICAgICB0ZDogWzMsICI8dGFibGU+
PHRib2R5Pjx0cj4iLCAiPC90cj48L3Rib2R5PjwvdGFibGU+Il0sCiAgICAgICAgICAgICAgICBf
ZGVmYXVsdDogWzAsICIiLCAiIl0KICAgICAgICAgICAgfTsKICAgICAgICBYdC5vcHRncm91cCA9
IFh0Lm9wdGlvbiwgWHQudGJvZHkgPSBYdC50Zm9vdCA9IFh0LmNvbGdyb3VwID0gWHQuY2FwdGlv
biA9IFh0LnRoZWFkLCBYdC50aCA9IFh0LnRkOwogICAgICAgIHZhciBZdCA9IC88fCYjP1x3Kzsv
OwogICAgICAgICEgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHZhciB0ID0gbnQuY3JlYXRlRG9j
dW1lbnRGcmFnbWVudCgpLAogICAgICAgICAgICAgICAgZSA9IHQuYXBwZW5kQ2hpbGQobnQuY3Jl
YXRlRWxlbWVudCgiZGl2IikpLAogICAgICAgICAgICAgICAgbiA9IG50LmNyZWF0ZUVsZW1lbnQo
ImlucHV0Iik7CiAgICAgICAgICAgIG4uc2V0QXR0cmlidXRlKCJ0eXBlIiwgInJhZGlvIiksIG4u
c2V0QXR0cmlidXRlKCJjaGVja2VkIiwgImNoZWNrZWQiKSwgbi5zZXRBdHRyaWJ1dGUoIm5hbWUi
LCAidCIpLCBlLmFwcGVuZENoaWxkKG4pLCBmdC5jaGVja0Nsb25lID0gZS5jbG9uZU5vZGUoITAp
LmNsb25lTm9kZSghMCkubGFzdENoaWxkLmNoZWNrZWQsIGUuaW5uZXJIVE1MID0gIjx0ZXh0YXJl
YT54PC90ZXh0YXJlYT4iLCBmdC5ub0Nsb25lQ2hlY2tlZCA9ICEhZS5jbG9uZU5vZGUoITApLmxh
c3RDaGlsZC5kZWZhdWx0VmFsdWUKICAgICAgICB9KCk7CiAgICAgICAgdmFyIFZ0ID0gbnQuZG9j
dW1lbnRFbGVtZW50LAogICAgICAgICAgICBVdCA9IC9ea2V5LywKICAgICAgICAgICAgUXQgPSAv
Xig/Om1vdXNlfHBvaW50ZXJ8Y29udGV4dG1lbnV8ZHJhZ3xkcm9wKXxjbGljay8sCiAgICAgICAg
ICAgIEd0ID0gL14oW14uXSopKD86XC4oLispfCkvOwogICAgICAgIGd0LmV2ZW50ID0gewogICAg
ICAgICAgICBnbG9iYWw6IHt9LAogICAgICAgICAgICBhZGQ6IGZ1bmN0aW9uKHQsIGUsIG4sIGks
IG8pIHsKICAgICAgICAgICAgICAgIHZhciByLCBzLCBhLCB1LCBsLCBjLCBwLCBoLCBmLCBkLCBn
LCBtID0gTHQuZ2V0KHQpOwogICAgICAgICAgICAgICAgaWYgKG0pCiAgICAgICAgICAgICAgICAg
ICAgZm9yIChuLmhhbmRsZXIgJiYgKHIgPSBuLCBuID0gci5oYW5kbGVyLCBvID0gci5zZWxlY3Rv
ciksIG8gJiYgZ3QuZmluZC5tYXRjaGVzU2VsZWN0b3IoVnQsIG8pLCBuLmd1aWQgfHwgKG4uZ3Vp
ZCA9IGd0Lmd1aWQrKyksICh1ID0gbS5ldmVudHMpIHx8ICh1ID0gbS5ldmVudHMgPSB7fSksIChz
ID0gbS5oYW5kbGUpIHx8IChzID0gbS5oYW5kbGUgPSBmdW5jdGlvbihlKSB7CiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICByZXR1cm4gdm9pZCAwICE9PSBndCAmJiBndC5ldmVudC50cmlnZ2Vy
ZWQgIT09IGUudHlwZSA/IGd0LmV2ZW50LmRpc3BhdGNoLmFwcGx5KHQsIGFyZ3VtZW50cykgOiB2
b2lkIDAKICAgICAgICAgICAgICAgICAgICAgICAgfSksIGUgPSAoZSB8fCAiIikubWF0Y2goa3Qp
IHx8IFsiIl0sIGwgPSBlLmxlbmd0aDsgbC0tOykgYSA9IEd0LmV4ZWMoZVtsXSkgfHwgW10sIGYg
PSBnID0gYVsxXSwgZCA9IChhWzJdIHx8ICIiKS5zcGxpdCgiLiIpLnNvcnQoKSwgZiAmJiAocCA9
IGd0LmV2ZW50LnNwZWNpYWxbZl0gfHwge30sIGYgPSAobyA/IHAuZGVsZWdhdGVUeXBlIDogcC5i
aW5kVHlwZSkgfHwgZiwgcCA9IGd0LmV2ZW50LnNwZWNpYWxbZl0gfHwge30sIGMgPSBndC5leHRl
bmQoewogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBmLAogICAgICAgICAgICAgICAgICAg
ICAgICBvcmlnVHlwZTogZywKICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogaSwKICAgICAg
ICAgICAgICAgICAgICAgICAgaGFuZGxlcjogbiwKICAgICAgICAgICAgICAgICAgICAgICAgZ3Vp
ZDogbi5ndWlkLAogICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RvcjogbywKICAgICAgICAg
ICAgICAgICAgICAgICAgbmVlZHNDb250ZXh0OiBvICYmIGd0LmV4cHIubWF0Y2gubmVlZHNDb250
ZXh0LnRlc3QobyksCiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVzcGFjZTogZC5qb2luKCIu
IikKICAgICAgICAgICAgICAgICAgICB9LCByKSwgKGggPSB1W2ZdKSB8fCAoaCA9IHVbZl0gPSBb
XSwgaC5kZWxlZ2F0ZUNvdW50ID0gMCwgcC5zZXR1cCAmJiAhMSAhPT0gcC5zZXR1cC5jYWxsKHQs
IGksIGQsIHMpIHx8IHQuYWRkRXZlbnRMaXN0ZW5lciAmJiB0LmFkZEV2ZW50TGlzdGVuZXIoZiwg
cykpLCBwLmFkZCAmJiAocC5hZGQuY2FsbCh0LCBjKSwgYy5oYW5kbGVyLmd1aWQgfHwgKGMuaGFu
ZGxlci5ndWlkID0gbi5ndWlkKSksIG8gPyBoLnNwbGljZShoLmRlbGVnYXRlQ291bnQrKywgMCwg
YykgOiBoLnB1c2goYyksIGd0LmV2ZW50Lmdsb2JhbFtmXSA9ICEwKQogICAgICAgICAgICB9LAog
ICAgICAgICAgICByZW1vdmU6IGZ1bmN0aW9uKHQsIGUsIG4sIGksIG8pIHsKICAgICAgICAgICAg
ICAgIHZhciByLCBzLCBhLCB1LCBsLCBjLCBwLCBoLCBmLCBkLCBnLCBtID0gTHQuaGFzRGF0YSh0
KSAmJiBMdC5nZXQodCk7CiAgICAgICAgICAgICAgICBpZiAobSAmJiAodSA9IG0uZXZlbnRzKSkg
ewogICAgICAgICAgICAgICAgICAgIGZvciAoZSA9IChlIHx8ICIiKS5tYXRjaChrdCkgfHwgWyIi
XSwgbCA9IGUubGVuZ3RoOyBsLS07KQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYSA9IEd0
LmV4ZWMoZVtsXSkgfHwgW10sIGYgPSBnID0gYVsxXSwgZCA9IChhWzJdIHx8ICIiKS5zcGxpdCgi
LiIpLnNvcnQoKSwgZikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChwID0gZ3Qu
ZXZlbnQuc3BlY2lhbFtmXSB8fCB7fSwgZiA9IChpID8gcC5kZWxlZ2F0ZVR5cGUgOiBwLmJpbmRU
eXBlKSB8fCBmLCBoID0gdVtmXSB8fCBbXSwgYSA9IGFbMl0gJiYgbmV3IFJlZ0V4cCgiKF58XFwu
KSIgKyBkLmpvaW4oIlxcLig/Oi4qXFwufCkiKSArICIoXFwufCQpIiksIHMgPSByID0gaC5sZW5n
dGg7IHItLTspIGMgPSBoW3JdLCAhbyAmJiBnICE9PSBjLm9yaWdUeXBlIHx8IG4gJiYgbi5ndWlk
ICE9PSBjLmd1aWQgfHwgYSAmJiAhYS50ZXN0KGMubmFtZXNwYWNlKSB8fCBpICYmIGkgIT09IGMu
c2VsZWN0b3IgJiYgKCIqKiIgIT09IGkgfHwgIWMuc2VsZWN0b3IpIHx8IChoLnNwbGljZShyLCAx
KSwgYy5zZWxlY3RvciAmJiBoLmRlbGVnYXRlQ291bnQtLSwgcC5yZW1vdmUgJiYgcC5yZW1vdmUu
Y2FsbCh0LCBjKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzICYmICFoLmxlbmd0aCAm
JiAocC50ZWFyZG93biAmJiAhMSAhPT0gcC50ZWFyZG93bi5jYWxsKHQsIGQsIG0uaGFuZGxlKSB8
fCBndC5yZW1vdmVFdmVudCh0LCBmLCBtLmhhbmRsZSksIGRlbGV0ZSB1W2ZdKQogICAgICAgICAg
ICAgICAgICAgICAgICB9IGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoZiBp
biB1KSBndC5ldmVudC5yZW1vdmUodCwgZiArIGVbbF0sIG4sIGksICEwKTsKICAgICAgICAgICAg
ICAgICAgICBndC5pc0VtcHR5T2JqZWN0KHUpICYmIEx0LnJlbW92ZSh0LCAiaGFuZGxlIGV2ZW50
cyIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGRpc3BhdGNo
OiBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICB2YXIgZSwgbiwgaSwgbywgciwgcywgYSA9
IGd0LmV2ZW50LmZpeCh0KSwKICAgICAgICAgICAgICAgICAgICB1ID0gbmV3IEFycmF5KGFyZ3Vt
ZW50cy5sZW5ndGgpLAogICAgICAgICAgICAgICAgICAgIGwgPSAoTHQuZ2V0KHRoaXMsICJldmVu
dHMiKSB8fCB7fSlbYS50eXBlXSB8fCBbXSwKICAgICAgICAgICAgICAgICAgICBjID0gZ3QuZXZl
bnQuc3BlY2lhbFthLnR5cGVdIHx8IHt9OwogICAgICAgICAgICAgICAgZm9yICh1WzBdID0gYSwg
ZSA9IDE7IGUgPCBhcmd1bWVudHMubGVuZ3RoOyBlKyspIHVbZV0gPSBhcmd1bWVudHNbZV07CiAg
ICAgICAgICAgICAgICBpZiAoYS5kZWxlZ2F0ZVRhcmdldCA9IHRoaXMsICFjLnByZURpc3BhdGNo
IHx8ICExICE9PSBjLnByZURpc3BhdGNoLmNhbGwodGhpcywgYSkpIHsKICAgICAgICAgICAgICAg
ICAgICBmb3IgKHMgPSBndC5ldmVudC5oYW5kbGVycy5jYWxsKHRoaXMsIGEsIGwpLCBlID0gMDsK
ICAgICAgICAgICAgICAgICAgICAgICAgKG8gPSBzW2UrK10pICYmICFhLmlzUHJvcGFnYXRpb25T
dG9wcGVkKCk7KQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGEuY3VycmVudFRhcmdldCA9
IG8uZWxlbSwgbiA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAociA9IG8uaGFuZGxl
cnNbbisrXSkgJiYgIWEuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQoKTspIGEucm5hbWVz
cGFjZSAmJiAhYS5ybmFtZXNwYWNlLnRlc3Qoci5uYW1lc3BhY2UpIHx8IChhLmhhbmRsZU9iaiA9
IHIsIGEuZGF0YSA9IHIuZGF0YSwgdm9pZCAwICE9PSAoaSA9ICgoZ3QuZXZlbnQuc3BlY2lhbFty
Lm9yaWdUeXBlXSB8fCB7fSkuaGFuZGxlIHx8IHIuaGFuZGxlcikuYXBwbHkoby5lbGVtLCB1KSkg
JiYgITEgPT09IChhLnJlc3VsdCA9IGkpICYmIChhLnByZXZlbnREZWZhdWx0KCksIGEuc3RvcFBy
b3BhZ2F0aW9uKCkpKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gYy5wb3N0RGlzcGF0Y2gg
JiYgYy5wb3N0RGlzcGF0Y2guY2FsbCh0aGlzLCBhKSwgYS5yZXN1bHQKICAgICAgICAgICAgICAg
IH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgaGFuZGxlcnM6IGZ1bmN0aW9uKHQsIGUpIHsK
ICAgICAgICAgICAgICAgIHZhciBuLCBpLCBvLCByLCBzLCBhID0gW10sCiAgICAgICAgICAgICAg
ICAgICAgdSA9IGUuZGVsZWdhdGVDb3VudCwKICAgICAgICAgICAgICAgICAgICBsID0gdC50YXJn
ZXQ7CiAgICAgICAgICAgICAgICBpZiAodSAmJiBsLm5vZGVUeXBlICYmICEoImNsaWNrIiA9PT0g
dC50eXBlICYmIHQuYnV0dG9uID49IDEpKQogICAgICAgICAgICAgICAgICAgIGZvciAoOyBsICE9
PSB0aGlzOyBsID0gbC5wYXJlbnROb2RlIHx8IHRoaXMpCiAgICAgICAgICAgICAgICAgICAgICAg
IGlmICgxID09PSBsLm5vZGVUeXBlICYmICgiY2xpY2siICE9PSB0LnR5cGUgfHwgITAgIT09IGwu
ZGlzYWJsZWQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHIgPSBbXSwgcyA9
IHt9LCBuID0gMDsgbiA8IHU7IG4rKykgaSA9IGVbbl0sIG8gPSBpLnNlbGVjdG9yICsgIiAiLCB2
b2lkIDAgPT09IHNbb10gJiYgKHNbb10gPSBpLm5lZWRzQ29udGV4dCA/IGd0KG8sIHRoaXMpLmlu
ZGV4KGwpID4gLTEgOiBndC5maW5kKG8sIHRoaXMsIG51bGwsIFtsXSkubGVuZ3RoKSwgc1tvXSAm
JiByLnB1c2goaSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByLmxlbmd0aCAmJiBhLnB1
c2goewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW06IGwsCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgaGFuZGxlcnM6IHIKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBs
ID0gdGhpcywgdSA8IGUubGVuZ3RoICYmIGEucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgZWxl
bTogbCwKICAgICAgICAgICAgICAgICAgICBoYW5kbGVyczogZS5zbGljZSh1KQogICAgICAgICAg
ICAgICAgfSksIGEKICAgICAgICAgICAgfSwKICAgICAgICAgICAgYWRkUHJvcDogZnVuY3Rpb24o
dCwgZSkgewogICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGd0LkV2ZW50LnBy
b3RvdHlwZSwgdCwgewogICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6ICEwLAogICAgICAg
ICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogITAsCiAgICAgICAgICAgICAgICAgICAgZ2V0OiBn
dC5pc0Z1bmN0aW9uKGUpID8gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlm
ICh0aGlzLm9yaWdpbmFsRXZlbnQpIHJldHVybiBlKHRoaXMub3JpZ2luYWxFdmVudCkKICAgICAg
ICAgICAgICAgICAgICB9IDogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlm
ICh0aGlzLm9yaWdpbmFsRXZlbnQpIHJldHVybiB0aGlzLm9yaWdpbmFsRXZlbnRbdF0KICAgICAg
ICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHNldDogZnVuY3Rpb24oZSkgewog
ICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgdCwgewog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogITAsCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBjb25maWd1cmFibGU6ICEwLAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgd3JpdGFibGU6ICEwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGUKICAg
ICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg
ICAgICB9KQogICAgICAgICAgICB9LAogICAgICAgICAgICBmaXg6IGZ1bmN0aW9uKHQpIHsKICAg
ICAgICAgICAgICAgIHJldHVybiB0W2d0LmV4cGFuZG9dID8gdCA6IG5ldyBndC5FdmVudCh0KQog
ICAgICAgICAgICB9LAogICAgICAgICAgICBzcGVjaWFsOiB7CiAgICAgICAgICAgICAgICBsb2Fk
OiB7CiAgICAgICAgICAgICAgICAgICAgbm9CdWJibGU6ICEwCiAgICAgICAgICAgICAgICB9LAog
ICAgICAgICAgICAgICAgZm9jdXM6IHsKICAgICAgICAgICAgICAgICAgICB0cmlnZ2VyOiBmdW5j
dGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMgIT09IEMoKSAmJiB0aGlz
LmZvY3VzKSByZXR1cm4gdGhpcy5mb2N1cygpLCAhMQogICAgICAgICAgICAgICAgICAgIH0sCiAg
ICAgICAgICAgICAgICAgICAgZGVsZWdhdGVUeXBlOiAiZm9jdXNpbiIKICAgICAgICAgICAgICAg
IH0sCiAgICAgICAgICAgICAgICBibHVyOiB7CiAgICAgICAgICAgICAgICAgICAgdHJpZ2dlcjog
ZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzID09PSBDKCkgJiYg
dGhpcy5ibHVyKSByZXR1cm4gdGhpcy5ibHVyKCksICExCiAgICAgICAgICAgICAgICAgICAgfSwK
ICAgICAgICAgICAgICAgICAgICBkZWxlZ2F0ZVR5cGU6ICJmb2N1c291dCIKICAgICAgICAgICAg
ICAgIH0sCiAgICAgICAgICAgICAgICBjbGljazogewogICAgICAgICAgICAgICAgICAgIHRyaWdn
ZXI6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoImNoZWNrYm94IiA9
PT0gdGhpcy50eXBlICYmIHRoaXMuY2xpY2sgJiYgbyh0aGlzLCAiaW5wdXQiKSkgcmV0dXJuIHRo
aXMuY2xpY2soKSwgITEKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAg
IF9kZWZhdWx0OiBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBv
KHQudGFyZ2V0LCAiYSIpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwK
ICAgICAgICAgICAgICAgIGJlZm9yZXVubG9hZDogewogICAgICAgICAgICAgICAgICAgIHBvc3RE
aXNwYXRjaDogZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgICAgICB2b2lkIDAgIT09
IHQucmVzdWx0ICYmIHQub3JpZ2luYWxFdmVudCAmJiAodC5vcmlnaW5hbEV2ZW50LnJldHVyblZh
bHVlID0gdC5yZXN1bHQpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQog
ICAgICAgICAgICB9CiAgICAgICAgfSwgZ3QucmVtb3ZlRXZlbnQgPSBmdW5jdGlvbih0LCBlLCBu
KSB7CiAgICAgICAgICAgIHQucmVtb3ZlRXZlbnRMaXN0ZW5lciAmJiB0LnJlbW92ZUV2ZW50TGlz
dGVuZXIoZSwgbikKICAgICAgICB9LCBndC5FdmVudCA9IGZ1bmN0aW9uKHQsIGUpIHsKICAgICAg
ICAgICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBndC5FdmVudCA/ICh0ICYmIHQudHlwZSA/ICh0
aGlzLm9yaWdpbmFsRXZlbnQgPSB0LCB0aGlzLnR5cGUgPSB0LnR5cGUsIHRoaXMuaXNEZWZhdWx0
UHJldmVudGVkID0gdC5kZWZhdWx0UHJldmVudGVkIHx8IHZvaWQgMCA9PT0gdC5kZWZhdWx0UHJl
dmVudGVkICYmICExID09PSB0LnJldHVyblZhbHVlID8gVCA6IHcsIHRoaXMudGFyZ2V0ID0gdC50
YXJnZXQgJiYgMyA9PT0gdC50YXJnZXQubm9kZVR5cGUgPyB0LnRhcmdldC5wYXJlbnROb2RlIDog
dC50YXJnZXQsIHRoaXMuY3VycmVudFRhcmdldCA9IHQuY3VycmVudFRhcmdldCwgdGhpcy5yZWxh
dGVkVGFyZ2V0ID0gdC5yZWxhdGVkVGFyZ2V0KSA6IHRoaXMudHlwZSA9IHQsIGUgJiYgZ3QuZXh0
ZW5kKHRoaXMsIGUpLCB0aGlzLnRpbWVTdGFtcCA9IHQgJiYgdC50aW1lU3RhbXAgfHwgZ3Qubm93
KCksIHZvaWQodGhpc1tndC5leHBhbmRvXSA9ICEwKSkgOiBuZXcgZ3QuRXZlbnQodCwgZSkKICAg
ICAgICB9LCBndC5FdmVudC5wcm90b3R5cGUgPSB7CiAgICAgICAgICAgIGNvbnN0cnVjdG9yOiBn
dC5FdmVudCwKICAgICAgICAgICAgaXNEZWZhdWx0UHJldmVudGVkOiB3LAogICAgICAgICAgICBp
c1Byb3BhZ2F0aW9uU3RvcHBlZDogdywKICAgICAgICAgICAgaXNJbW1lZGlhdGVQcm9wYWdhdGlv
blN0b3BwZWQ6IHcsCiAgICAgICAgICAgIGlzU2ltdWxhdGVkOiAhMSwKICAgICAgICAgICAgcHJl
dmVudERlZmF1bHQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdmFyIHQgPSB0aGlzLm9y
aWdpbmFsRXZlbnQ7CiAgICAgICAgICAgICAgICB0aGlzLmlzRGVmYXVsdFByZXZlbnRlZCA9IFQs
IHQgJiYgIXRoaXMuaXNTaW11bGF0ZWQgJiYgdC5wcmV2ZW50RGVmYXVsdCgpCiAgICAgICAgICAg
IH0sCiAgICAgICAgICAgIHN0b3BQcm9wYWdhdGlvbjogZnVuY3Rpb24oKSB7CiAgICAgICAgICAg
ICAgICB2YXIgdCA9IHRoaXMub3JpZ2luYWxFdmVudDsKICAgICAgICAgICAgICAgIHRoaXMuaXNQ
cm9wYWdhdGlvblN0b3BwZWQgPSBULCB0ICYmICF0aGlzLmlzU2ltdWxhdGVkICYmIHQuc3RvcFBy
b3BhZ2F0aW9uKCkKICAgICAgICAgICAgfSwKICAgICAgICAgICAgc3RvcEltbWVkaWF0ZVByb3Bh
Z2F0aW9uOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHZhciB0ID0gdGhpcy5vcmlnaW5h
bEV2ZW50OwogICAgICAgICAgICAgICAgdGhpcy5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBl
ZCA9IFQsIHQgJiYgIXRoaXMuaXNTaW11bGF0ZWQgJiYgdC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRp
b24oKSwgdGhpcy5zdG9wUHJvcGFnYXRpb24oKQogICAgICAgICAgICB9CiAgICAgICAgfSwgZ3Qu
ZWFjaCh7CiAgICAgICAgICAgIGFsdEtleTogITAsCiAgICAgICAgICAgIGJ1YmJsZXM6ICEwLAog
ICAgICAgICAgICBjYW5jZWxhYmxlOiAhMCwKICAgICAgICAgICAgY2hhbmdlZFRvdWNoZXM6ICEw
LAogICAgICAgICAgICBjdHJsS2V5OiAhMCwKICAgICAgICAgICAgZGV0YWlsOiAhMCwKICAgICAg
ICAgICAgZXZlbnRQaGFzZTogITAsCiAgICAgICAgICAgIG1ldGFLZXk6ICEwLAogICAgICAgICAg
ICBwYWdlWDogITAsCiAgICAgICAgICAgIHBhZ2VZOiAhMCwKICAgICAgICAgICAgc2hpZnRLZXk6
ICEwLAogICAgICAgICAgICB2aWV3OiAhMCwKICAgICAgICAgICAgY2hhcjogITAsCiAgICAgICAg
ICAgIGNoYXJDb2RlOiAhMCwKICAgICAgICAgICAga2V5OiAhMCwKICAgICAgICAgICAga2V5Q29k
ZTogITAsCiAgICAgICAgICAgIGJ1dHRvbjogITAsCiAgICAgICAgICAgIGJ1dHRvbnM6ICEwLAog
ICAgICAgICAgICBjbGllbnRYOiAhMCwKICAgICAgICAgICAgY2xpZW50WTogITAsCiAgICAgICAg
ICAgIG9mZnNldFg6ICEwLAogICAgICAgICAgICBvZmZzZXRZOiAhMCwKICAgICAgICAgICAgcG9p
bnRlcklkOiAhMCwKICAgICAgICAgICAgcG9pbnRlclR5cGU6ICEwLAogICAgICAgICAgICBzY3Jl
ZW5YOiAhMCwKICAgICAgICAgICAgc2NyZWVuWTogITAsCiAgICAgICAgICAgIHRhcmdldFRvdWNo
ZXM6ICEwLAogICAgICAgICAgICB0b0VsZW1lbnQ6ICEwLAogICAgICAgICAgICB0b3VjaGVzOiAh
MCwKICAgICAgICAgICAgd2hpY2g6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIHZhciBl
ID0gdC5idXR0b247CiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbCA9PSB0LndoaWNoICYmIFV0
LnRlc3QodC50eXBlKSA/IG51bGwgIT0gdC5jaGFyQ29kZSA/IHQuY2hhckNvZGUgOiB0LmtleUNv
ZGUgOiAhdC53aGljaCAmJiB2b2lkIDAgIT09IGUgJiYgUXQudGVzdCh0LnR5cGUpID8gMSAmIGUg
PyAxIDogMiAmIGUgPyAzIDogNCAmIGUgPyAyIDogMCA6IHQud2hpY2gKICAgICAgICAgICAgfQog
ICAgICAgIH0sIGd0LmV2ZW50LmFkZFByb3ApLCBndC5lYWNoKHsKICAgICAgICAgICAgbW91c2Vl
bnRlcjogIm1vdXNlb3ZlciIsCiAgICAgICAgICAgIG1vdXNlbGVhdmU6ICJtb3VzZW91dCIsCiAg
ICAgICAgICAgIHBvaW50ZXJlbnRlcjogInBvaW50ZXJvdmVyIiwKICAgICAgICAgICAgcG9pbnRl
cmxlYXZlOiAicG9pbnRlcm91dCIKICAgICAgICB9LCBmdW5jdGlvbih0LCBlKSB7CiAgICAgICAg
ICAgIGd0LmV2ZW50LnNwZWNpYWxbdF0gPSB7CiAgICAgICAgICAgICAgICBkZWxlZ2F0ZVR5cGU6
IGUsCiAgICAgICAgICAgICAgICBiaW5kVHlwZTogZSwKICAgICAgICAgICAgICAgIGhhbmRsZTog
ZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgIHZhciBuLCBpID0gdGhpcywKICAgICAg
ICAgICAgICAgICAgICAgICAgbyA9IHQucmVsYXRlZFRhcmdldCwKICAgICAgICAgICAgICAgICAg
ICAgICAgciA9IHQuaGFuZGxlT2JqOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBvICYmIChv
ID09PSBpIHx8IGd0LmNvbnRhaW5zKGksIG8pKSB8fCAodC50eXBlID0gci5vcmlnVHlwZSwgbiA9
IHIuaGFuZGxlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpLCB0LnR5cGUgPSBlKSwgbgogICAgICAg
ICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSksIGd0LmZuLmV4dGVuZCh7CiAgICAg
ICAgICAgIG9uOiBmdW5jdGlvbih0LCBlLCBuLCBpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4g
Uyh0aGlzLCB0LCBlLCBuLCBpKQogICAgICAgICAgICB9LAogICAgICAgICAgICBvbmU6IGZ1bmN0
aW9uKHQsIGUsIG4sIGkpIHsKICAgICAgICAgICAgICAgIHJldHVybiBTKHRoaXMsIHQsIGUsIG4s
IGksIDEpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG9mZjogZnVuY3Rpb24odCwgZSwgbikg
ewogICAgICAgICAgICAgICAgdmFyIGksIG87CiAgICAgICAgICAgICAgICBpZiAodCAmJiB0LnBy
ZXZlbnREZWZhdWx0ICYmIHQuaGFuZGxlT2JqKSByZXR1cm4gaSA9IHQuaGFuZGxlT2JqLCBndCh0
LmRlbGVnYXRlVGFyZ2V0KS5vZmYoaS5uYW1lc3BhY2UgPyBpLm9yaWdUeXBlICsgIi4iICsgaS5u
YW1lc3BhY2UgOiBpLm9yaWdUeXBlLCBpLnNlbGVjdG9yLCBpLmhhbmRsZXIpLCB0aGlzOwogICAg
ICAgICAgICAgICAgaWYgKCJvYmplY3QiID09IHR5cGVvZiB0KSB7CiAgICAgICAgICAgICAgICAg
ICAgZm9yIChvIGluIHQpIHRoaXMub2ZmKG8sIGUsIHRbb10pOwogICAgICAgICAgICAgICAgICAg
IHJldHVybiB0aGlzCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gITEg
IT09IGUgJiYgImZ1bmN0aW9uIiAhPSB0eXBlb2YgZSB8fCAobiA9IGUsIGUgPSB2b2lkIDApLCAh
MSA9PT0gbiAmJiAobiA9IHcpLCB0aGlzLmVhY2goZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAg
ICAgICAgZ3QuZXZlbnQucmVtb3ZlKHRoaXMsIHQsIG4sIGUpCiAgICAgICAgICAgICAgICB9KQog
ICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgdmFyIEp0ID0gLzxzY3JpcHR8PHN0eWxl
fDxsaW5rL2ksCiAgICAgICAgICAgIEt0ID0gL2NoZWNrZWRccyooPzpbXj1dfD1ccyouY2hlY2tl
ZC4pL2ksCiAgICAgICAgICAgIFp0ID0gL150cnVlXC8oLiopLywKICAgICAgICAgICAgdGUgPSAv
XlxzKjwhKD86XFtDREFUQVxbfC0tKXwoPzpcXVxdfC0tKT5ccyokL2c7CiAgICAgICAgZ3QuZXh0
ZW5kKHsKICAgICAgICAgICAgaHRtbFByZWZpbHRlcjogZnVuY3Rpb24odCkgewogICAgICAgICAg
ICAgICAgcmV0dXJuIHQucmVwbGFjZSgvPCg/IWFyZWF8YnJ8Y29sfGVtYmVkfGhyfGltZ3xpbnB1
dHxsaW5rfG1ldGF8cGFyYW0pKChbYS16XVteXC9cMD5ceDIwXHRcclxuXGZdKilbXj5dKilcLz4v
Z2ksICI8JDE+PC8kMj4iKQogICAgICAgICAgICB9LAogICAgICAgICAgICBjbG9uZTogZnVuY3Rp
b24odCwgZSwgbikgewogICAgICAgICAgICAgICAgdmFyIGksIG8sIHIsIHMsIGEgPSB0LmNsb25l
Tm9kZSghMCksCiAgICAgICAgICAgICAgICAgICAgdSA9IGd0LmNvbnRhaW5zKHQub3duZXJEb2N1
bWVudCwgdCk7CiAgICAgICAgICAgICAgICBpZiAoIShmdC5ub0Nsb25lQ2hlY2tlZCB8fCAxICE9
PSB0Lm5vZGVUeXBlICYmIDExICE9PSB0Lm5vZGVUeXBlIHx8IGd0LmlzWE1MRG9jKHQpKSkKICAg
ICAgICAgICAgICAgICAgICBmb3IgKHMgPSB5KGEpLCByID0geSh0KSwgaSA9IDAsIG8gPSByLmxl
bmd0aDsgaSA8IG87IGkrKykgTihyW2ldLCBzW2ldKTsKICAgICAgICAgICAgICAgIGlmIChlKQog
ICAgICAgICAgICAgICAgICAgIGlmIChuKQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHIg
PSByIHx8IHkodCksIHMgPSBzIHx8IHkoYSksIGkgPSAwLCBvID0gci5sZW5ndGg7IGkgPCBvOyBp
KyspIEQocltpXSwgc1tpXSk7CiAgICAgICAgICAgICAgICAgICAgZWxzZSBEKHQsIGEpOwogICAg
ICAgICAgICAgICAgcmV0dXJuIHMgPSB5KGEsICJzY3JpcHQiKSwgcy5sZW5ndGggPiAwICYmIHgo
cywgIXUgJiYgeSh0LCAic2NyaXB0IikpLCBhCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGNs
ZWFuRGF0YTogZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgZm9yICh2YXIgZSwgbiwgaSwg
byA9IGd0LmV2ZW50LnNwZWNpYWwsIHIgPSAwOyB2b2lkIDAgIT09IChuID0gdFtyXSk7IHIrKykK
ICAgICAgICAgICAgICAgICAgICBpZiAoanQobikpIHsKICAgICAgICAgICAgICAgICAgICAgICAg
aWYgKGUgPSBuW0x0LmV4cGFuZG9dKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAo
ZS5ldmVudHMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpIGluIGUuZXZl
bnRzKSBvW2ldID8gZ3QuZXZlbnQucmVtb3ZlKG4sIGkpIDogZ3QucmVtb3ZlRXZlbnQobiwgaSwg
ZS5oYW5kbGUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbltMdC5leHBhbmRvXSA9IHZv
aWQgMAogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIG5b
JHQuZXhwYW5kb10gJiYgKG5bJHQuZXhwYW5kb10gPSB2b2lkIDApCiAgICAgICAgICAgICAgICAg
ICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSksIGd0LmZuLmV4dGVuZCh7CiAgICAgICAgICAg
IGRldGFjaDogZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgcmV0dXJuIGoodGhpcywgdCwg
ITApCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHJlbW92ZTogZnVuY3Rpb24odCkgewogICAg
ICAgICAgICAgICAgcmV0dXJuIGoodGhpcywgdCkKICAgICAgICAgICAgfSwKICAgICAgICAgICAg
dGV4dDogZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgcmV0dXJuIE10KHRoaXMsIGZ1bmN0
aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdm9pZCAwID09PSB0ID8gZ3QudGV4
dCh0aGlzKSA6IHRoaXMuZW1wdHkoKS5lYWNoKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAg
ICAgICAgICAxICE9PSB0aGlzLm5vZGVUeXBlICYmIDExICE9PSB0aGlzLm5vZGVUeXBlICYmIDkg
IT09IHRoaXMubm9kZVR5cGUgfHwgKHRoaXMudGV4dENvbnRlbnQgPSB0KQogICAgICAgICAgICAg
ICAgICAgIH0pCiAgICAgICAgICAgICAgICB9LCBudWxsLCB0LCBhcmd1bWVudHMubGVuZ3RoKQog
ICAgICAgICAgICB9LAogICAgICAgICAgICBhcHBlbmQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAg
ICAgICAgcmV0dXJuIE0odGhpcywgYXJndW1lbnRzLCBmdW5jdGlvbih0KSB7CiAgICAgICAgICAg
ICAgICAgICAgaWYgKDEgPT09IHRoaXMubm9kZVR5cGUgfHwgMTEgPT09IHRoaXMubm9kZVR5cGUg
fHwgOSA9PT0gdGhpcy5ub2RlVHlwZSkgewogICAgICAgICAgICAgICAgICAgICAgICBFKHRoaXMs
IHQpLmFwcGVuZENoaWxkKHQpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg
fSkKICAgICAgICAgICAgfSwKICAgICAgICAgICAgcHJlcGVuZDogZnVuY3Rpb24oKSB7CiAgICAg
ICAgICAgICAgICByZXR1cm4gTSh0aGlzLCBhcmd1bWVudHMsIGZ1bmN0aW9uKHQpIHsKICAgICAg
ICAgICAgICAgICAgICBpZiAoMSA9PT0gdGhpcy5ub2RlVHlwZSB8fCAxMSA9PT0gdGhpcy5ub2Rl
VHlwZSB8fCA5ID09PSB0aGlzLm5vZGVUeXBlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZh
ciBlID0gRSh0aGlzLCB0KTsKICAgICAgICAgICAgICAgICAgICAgICAgZS5pbnNlcnRCZWZvcmUo
dCwgZS5maXJzdENoaWxkKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0p
CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGJlZm9yZTogZnVuY3Rpb24oKSB7CiAgICAgICAg
ICAgICAgICByZXR1cm4gTSh0aGlzLCBhcmd1bWVudHMsIGZ1bmN0aW9uKHQpIHsKICAgICAgICAg
ICAgICAgICAgICB0aGlzLnBhcmVudE5vZGUgJiYgdGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9y
ZSh0LCB0aGlzKQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfSwKICAgICAgICAgICAg
YWZ0ZXI6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIE0odGhpcywgYXJndW1l
bnRzLCBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnROb2RlICYm
IHRoaXMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUodCwgdGhpcy5uZXh0U2libGluZykKICAgICAg
ICAgICAgICAgIH0pCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGVtcHR5OiBmdW5jdGlvbigp
IHsKICAgICAgICAgICAgICAgIGZvciAodmFyIHQsIGUgPSAwOyBudWxsICE9ICh0ID0gdGhpc1tl
XSk7IGUrKykgMSA9PT0gdC5ub2RlVHlwZSAmJiAoZ3QuY2xlYW5EYXRhKHkodCwgITEpKSwgdC50
ZXh0Q29udGVudCA9ICIiKTsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzCiAgICAgICAgICAg
IH0sCiAgICAgICAgICAgIGNsb25lOiBmdW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAgICAgICBy
ZXR1cm4gdCA9IG51bGwgIT0gdCAmJiB0LCBlID0gbnVsbCA9PSBlID8gdCA6IGUsIHRoaXMubWFw
KGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBndC5jbG9uZSh0aGlzLCB0
LCBlKQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfSwKICAgICAgICAgICAgaHRtbDog
ZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgcmV0dXJuIE10KHRoaXMsIGZ1bmN0aW9uKHQp
IHsKICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IHRoaXNbMF0gfHwge30sCiAgICAgICAgICAg
ICAgICAgICAgICAgIG4gPSAwLAogICAgICAgICAgICAgICAgICAgICAgICBpID0gdGhpcy5sZW5n
dGg7CiAgICAgICAgICAgICAgICAgICAgaWYgKHZvaWQgMCA9PT0gdCAmJiAxID09PSBlLm5vZGVU
eXBlKSByZXR1cm4gZS5pbm5lckhUTUw7CiAgICAgICAgICAgICAgICAgICAgaWYgKCJzdHJpbmci
ID09IHR5cGVvZiB0ICYmICFKdC50ZXN0KHQpICYmICFYdFsoQnQuZXhlYyh0KSB8fCBbIiIsICIi
XSlbMV0udG9Mb3dlckNhc2UoKV0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgdCA9IGd0Lmh0
bWxQcmVmaWx0ZXIodCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBmb3IgKDsgbiA8IGk7IG4rKykgZSA9IHRoaXNbbl0gfHwge30sIDEg
PT09IGUubm9kZVR5cGUgJiYgKGd0LmNsZWFuRGF0YSh5KGUsICExKSksIGUuaW5uZXJIVE1MID0g
dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlID0gMAogICAgICAgICAgICAgICAgICAg
ICAgICB9IGNhdGNoICh0KSB7fQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg
ICAgICBlICYmIHRoaXMuZW1wdHkoKS5hcHBlbmQodCkKICAgICAgICAgICAgICAgIH0sIG51bGws
IHQsIGFyZ3VtZW50cy5sZW5ndGgpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHJlcGxhY2VX
aXRoOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHZhciB0ID0gW107CiAgICAgICAgICAg
ICAgICByZXR1cm4gTSh0aGlzLCBhcmd1bWVudHMsIGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAg
ICAgICAgICB2YXIgbiA9IHRoaXMucGFyZW50Tm9kZTsKICAgICAgICAgICAgICAgICAgICBndC5p
bkFycmF5KHRoaXMsIHQpIDwgMCAmJiAoZ3QuY2xlYW5EYXRhKHkodGhpcykpLCBuICYmIG4ucmVw
bGFjZUNoaWxkKGUsIHRoaXMpKQogICAgICAgICAgICAgICAgfSwgdCkKICAgICAgICAgICAgfQog
ICAgICAgIH0pLCBndC5lYWNoKHsKICAgICAgICAgICAgYXBwZW5kVG86ICJhcHBlbmQiLAogICAg
ICAgICAgICBwcmVwZW5kVG86ICJwcmVwZW5kIiwKICAgICAgICAgICAgaW5zZXJ0QmVmb3JlOiAi
YmVmb3JlIiwKICAgICAgICAgICAgaW5zZXJ0QWZ0ZXI6ICJhZnRlciIsCiAgICAgICAgICAgIHJl
cGxhY2VBbGw6ICJyZXBsYWNlV2l0aCIKICAgICAgICB9LCBmdW5jdGlvbih0LCBlKSB7CiAgICAg
ICAgICAgIGd0LmZuW3RdID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgZm9yICh2YXIg
biwgaSA9IFtdLCBvID0gZ3QodCksIHIgPSBvLmxlbmd0aCAtIDEsIHMgPSAwOyBzIDw9IHI7IHMr
KykgbiA9IHMgPT09IHIgPyB0aGlzIDogdGhpcy5jbG9uZSghMCksIGd0KG9bc10pW2VdKG4pLCBz
dC5hcHBseShpLCBuLmdldCgpKTsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnB1c2hTdGFj
ayhpKQogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgdmFyIGVlID0gL15tYXJnaW4v
LAogICAgICAgICAgICBuZSA9IG5ldyBSZWdFeHAoIl4oIiArIFJ0ICsgIikoPyFweClbYS16JV0r
JCIsICJpIiksCiAgICAgICAgICAgIGllID0gZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgICAg
dmFyIG4gPSBlLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXc7CiAgICAgICAgICAgICAgICByZXR1
cm4gbiAmJiBuLm9wZW5lciB8fCAobiA9IHQpLCBuLmdldENvbXB1dGVkU3R5bGUoZSkKICAgICAg
ICAgICAgfTsKICAgICAgICAhIGZ1bmN0aW9uKCkgewogICAgICAgICAgICBmdW5jdGlvbiBlKCkg
ewogICAgICAgICAgICAgICAgaWYgKGEpIHsKICAgICAgICAgICAgICAgICAgICBhLnN0eWxlLmNz
c1RleHQgPSAiYm94LXNpemluZzpib3JkZXItYm94O3Bvc2l0aW9uOnJlbGF0aXZlO2Rpc3BsYXk6
YmxvY2s7bWFyZ2luOmF1dG87Ym9yZGVyOjFweDtwYWRkaW5nOjFweDt0b3A6MSU7d2lkdGg6NTAl
IiwgYS5pbm5lckhUTUwgPSAiIiwgVnQuYXBwZW5kQ2hpbGQocyk7CiAgICAgICAgICAgICAgICAg
ICAgdmFyIGUgPSB0LmdldENvbXB1dGVkU3R5bGUoYSk7CiAgICAgICAgICAgICAgICAgICAgbiA9
ICIxJSIgIT09IGUudG9wLCByID0gIjJweCIgPT09IGUubWFyZ2luTGVmdCwgaSA9ICI0cHgiID09
PSBlLndpZHRoLCBhLnN0eWxlLm1hcmdpblJpZ2h0ID0gIjUwJSIsIG8gPSAiNHB4IiA9PT0gZS5t
YXJnaW5SaWdodCwgVnQucmVtb3ZlQ2hpbGQocyksIGEgPSBudWxsCiAgICAgICAgICAgICAgICB9
CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdmFyIG4sIGksIG8sIHIsIHMgPSBudC5jcmVhdGVF
bGVtZW50KCJkaXYiKSwKICAgICAgICAgICAgICAgIGEgPSBudC5jcmVhdGVFbGVtZW50KCJkaXYi
KTsKICAgICAgICAgICAgYS5zdHlsZSAmJiAoYS5zdHlsZS5iYWNrZ3JvdW5kQ2xpcCA9ICJjb250
ZW50LWJveCIsIGEuY2xvbmVOb2RlKCEwKS5zdHlsZS5iYWNrZ3JvdW5kQ2xpcCA9ICIiLCBmdC5j
bGVhckNsb25lU3R5bGUgPSAiY29udGVudC1ib3giID09PSBhLnN0eWxlLmJhY2tncm91bmRDbGlw
LCBzLnN0eWxlLmNzc1RleHQgPSAiYm9yZGVyOjA7d2lkdGg6OHB4O2hlaWdodDowO3RvcDowO2xl
ZnQ6LTk5OTlweDtwYWRkaW5nOjA7bWFyZ2luLXRvcDoxcHg7cG9zaXRpb246YWJzb2x1dGUiLCBz
LmFwcGVuZENoaWxkKGEpLCBndC5leHRlbmQoZnQsIHsKICAgICAgICAgICAgICAgIHBpeGVsUG9z
aXRpb246IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBlKCksIG4KICAg
ICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBib3hTaXppbmdSZWxpYWJsZTogZnVuY3Rp
b24oKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGUoKSwgaQogICAgICAgICAgICAgICAg
fSwKICAgICAgICAgICAgICAgIHBpeGVsTWFyZ2luUmlnaHQ6IGZ1bmN0aW9uKCkgewogICAgICAg
ICAgICAgICAgICAgIHJldHVybiBlKCksIG8KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAg
ICAgICByZWxpYWJsZU1hcmdpbkxlZnQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAg
IHJldHVybiBlKCksIHIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkpCiAgICAgICAg
fSgpOwogICAgICAgIHZhciBvZSA9IC9eKG5vbmV8dGFibGUoPyEtY1tlYV0pLispLywKICAgICAg
ICAgICAgcmUgPSAvXi0tLywKICAgICAgICAgICAgc2UgPSB7CiAgICAgICAgICAgICAgICBwb3Np
dGlvbjogImFic29sdXRlIiwKICAgICAgICAgICAgICAgIHZpc2liaWxpdHk6ICJoaWRkZW4iLAog
ICAgICAgICAgICAgICAgZGlzcGxheTogImJsb2NrIgogICAgICAgICAgICB9LAogICAgICAgICAg
ICBhZSA9IHsKICAgICAgICAgICAgICAgIGxldHRlclNwYWNpbmc6ICIwIiwKICAgICAgICAgICAg
ICAgIGZvbnRXZWlnaHQ6ICI0MDAiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHVlID0gWyJX
ZWJraXQiLCAiTW96IiwgIm1zIl0sCiAgICAgICAgICAgIGxlID0gbnQuY3JlYXRlRWxlbWVudCgi
ZGl2Iikuc3R5bGU7CiAgICAgICAgZ3QuZXh0ZW5kKHsKICAgICAgICAgICAgY3NzSG9va3M6IHsK
ICAgICAgICAgICAgICAgIG9wYWNpdHk6IHsKICAgICAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0
aW9uKHQsIGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUpIHsKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHZhciBuID0gTCh0LCAib3BhY2l0eSIpOwogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgcmV0dXJuICIiID09PSBuID8gIjEiIDogbgogICAgICAgICAgICAgICAgICAg
ICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAg
ICB9LAogICAgICAgICAgICBjc3NOdW1iZXI6IHsKICAgICAgICAgICAgICAgIGFuaW1hdGlvbkl0
ZXJhdGlvbkNvdW50OiAhMCwKICAgICAgICAgICAgICAgIGNvbHVtbkNvdW50OiAhMCwKICAgICAg
ICAgICAgICAgIGZpbGxPcGFjaXR5OiAhMCwKICAgICAgICAgICAgICAgIGZsZXhHcm93OiAhMCwK
ICAgICAgICAgICAgICAgIGZsZXhTaHJpbms6ICEwLAogICAgICAgICAgICAgICAgZm9udFdlaWdo
dDogITAsCiAgICAgICAgICAgICAgICBsaW5lSGVpZ2h0OiAhMCwKICAgICAgICAgICAgICAgIG9w
YWNpdHk6ICEwLAogICAgICAgICAgICAgICAgb3JkZXI6ICEwLAogICAgICAgICAgICAgICAgb3Jw
aGFuczogITAsCiAgICAgICAgICAgICAgICB3aWRvd3M6ICEwLAogICAgICAgICAgICAgICAgeklu
ZGV4OiAhMCwKICAgICAgICAgICAgICAgIHpvb206ICEwCiAgICAgICAgICAgIH0sCiAgICAgICAg
ICAgIGNzc1Byb3BzOiB7CiAgICAgICAgICAgICAgICBmbG9hdDogImNzc0Zsb2F0IgogICAgICAg
ICAgICB9LAogICAgICAgICAgICBzdHlsZTogZnVuY3Rpb24odCwgZSwgbiwgaSkgewogICAgICAg
ICAgICAgICAgaWYgKHQgJiYgMyAhPT0gdC5ub2RlVHlwZSAmJiA4ICE9PSB0Lm5vZGVUeXBlICYm
IHQuc3R5bGUpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgbywgciwgcywgYSA9IGd0LmNhbWVs
Q2FzZShlKSwKICAgICAgICAgICAgICAgICAgICAgICAgdSA9IHJlLnRlc3QoZSksCiAgICAgICAg
ICAgICAgICAgICAgICAgIGwgPSB0LnN0eWxlOwogICAgICAgICAgICAgICAgICAgIHJldHVybiB1
IHx8IChlID0gcShhKSksIHMgPSBndC5jc3NIb29rc1tlXSB8fCBndC5jc3NIb29rc1thXSwgdm9p
ZCAwID09PSBuID8gcyAmJiAiZ2V0IiBpbiBzICYmIHZvaWQgMCAhPT0gKG8gPSBzLmdldCh0LCAh
MSwgaSkpID8gbyA6IGxbZV0gOiAociA9IHR5cGVvZiBuLCAic3RyaW5nIiA9PT0gciAmJiAobyA9
IEl0LmV4ZWMobikpICYmIG9bMV0gJiYgKG4gPSBnKHQsIGUsIG8pLCByID0gIm51bWJlciIpLCB2
b2lkKG51bGwgIT0gbiAmJiBuID09PSBuICYmICgibnVtYmVyIiA9PT0gciAmJiAobiArPSBvICYm
IG9bM10gfHwgKGd0LmNzc051bWJlclthXSA/ICIiIDogInB4IikpLCBmdC5jbGVhckNsb25lU3R5
bGUgfHwgIiIgIT09IG4gfHwgMCAhPT0gZS5pbmRleE9mKCJiYWNrZ3JvdW5kIikgfHwgKGxbZV0g
PSAiaW5oZXJpdCIpLCBzICYmICJzZXQiIGluIHMgJiYgdm9pZCAwID09PSAobiA9IHMuc2V0KHQs
IG4sIGkpKSB8fCAodSA/IGwuc2V0UHJvcGVydHkoZSwgbikgOiBsW2VdID0gbikpKSkKICAgICAg
ICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgY3NzOiBmdW5jdGlvbih0LCBl
LCBuLCBpKSB7CiAgICAgICAgICAgICAgICB2YXIgbywgciwgcywgYSA9IGd0LmNhbWVsQ2FzZShl
KTsKICAgICAgICAgICAgICAgIHJldHVybiByZS50ZXN0KGUpIHx8IChlID0gcShhKSksIHMgPSBn
dC5jc3NIb29rc1tlXSB8fCBndC5jc3NIb29rc1thXSwgcyAmJiAiZ2V0IiBpbiBzICYmIChvID0g
cy5nZXQodCwgITAsIG4pKSwgdm9pZCAwID09PSBvICYmIChvID0gTCh0LCBlLCBpKSksICJub3Jt
YWwiID09PSBvICYmIGUgaW4gYWUgJiYgKG8gPSBhZVtlXSksICIiID09PSBuIHx8IG4gPyAociA9
IHBhcnNlRmxvYXQobyksICEwID09PSBuIHx8IGlzRmluaXRlKHIpID8gciB8fCAwIDogbykgOiBv
CiAgICAgICAgICAgIH0KICAgICAgICB9KSwgZ3QuZWFjaChbImhlaWdodCIsICJ3aWR0aCJdLCBm
dW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAgIGd0LmNzc0hvb2tzW2VdID0gewogICAgICAgICAg
ICAgICAgZ2V0OiBmdW5jdGlvbih0LCBuLCBpKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKG4p
IHJldHVybiAhb2UudGVzdChndC5jc3ModCwgImRpc3BsYXkiKSkgfHwgdC5nZXRDbGllbnRSZWN0
cygpLmxlbmd0aCAmJiB0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoID8gRih0LCBlLCBp
KSA6IEh0KHQsIHNlLCBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJu
IEYodCwgZSwgaSkKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfSwKICAg
ICAgICAgICAgICAgIHNldDogZnVuY3Rpb24odCwgbiwgaSkgewogICAgICAgICAgICAgICAgICAg
IHZhciBvLCByID0gaSAmJiBpZSh0KSwKICAgICAgICAgICAgICAgICAgICAgICAgcyA9IGkgJiYg
SSh0LCBlLCBpLCAiYm9yZGVyLWJveCIgPT09IGd0LmNzcyh0LCAiYm94U2l6aW5nIiwgITEsIHIp
LCByKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcyAmJiAobyA9IEl0LmV4ZWMobikpICYm
ICJweCIgIT09IChvWzNdIHx8ICJweCIpICYmICh0LnN0eWxlW2VdID0gbiwgbiA9IGd0LmNzcyh0
LCBlKSksIFIodCwgbiwgcykKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAg
IH0pLCBndC5jc3NIb29rcy5tYXJnaW5MZWZ0ID0gJChmdC5yZWxpYWJsZU1hcmdpbkxlZnQsIGZ1
bmN0aW9uKHQsIGUpIHsKICAgICAgICAgICAgaWYgKGUpIHJldHVybiAocGFyc2VGbG9hdChMKHQs
ICJtYXJnaW5MZWZ0IikpIHx8IHQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdCAtIEh0KHQs
IHsKICAgICAgICAgICAgICAgIG1hcmdpbkxlZnQ6IDAKICAgICAgICAgICAgfSwgZnVuY3Rpb24o
KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0
CiAgICAgICAgICAgIH0pKSArICJweCIKICAgICAgICB9KSwgZ3QuZWFjaCh7CiAgICAgICAgICAg
IG1hcmdpbjogIiIsCiAgICAgICAgICAgIHBhZGRpbmc6ICIiLAogICAgICAgICAgICBib3JkZXI6
ICJXaWR0aCIKICAgICAgICB9LCBmdW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAgIGd0LmNzc0hv
b2tzW3QgKyBlXSA9IHsKICAgICAgICAgICAgICAgIGV4cGFuZDogZnVuY3Rpb24obikgewogICAg
ICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBvID0ge30sIHIgPSAic3RyaW5nIiA9PSB0
eXBlb2YgbiA/IG4uc3BsaXQoIiAiKSA6IFtuXTsgaSA8IDQ7IGkrKykgb1t0ICsgRnRbaV0gKyBl
XSA9IHJbaV0gfHwgcltpIC0gMl0gfHwgclswXTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4g
bwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCBlZS50ZXN0KHQpIHx8IChndC5jc3NI
b29rc1t0ICsgZV0uc2V0ID0gUikKICAgICAgICB9KSwgZ3QuZm4uZXh0ZW5kKHsKICAgICAgICAg
ICAgY3NzOiBmdW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gTXQodGhpcywg
ZnVuY3Rpb24odCwgZSwgbikgewogICAgICAgICAgICAgICAgICAgIHZhciBpLCBvLCByID0ge30s
CiAgICAgICAgICAgICAgICAgICAgICAgIHMgPSAwOwogICAgICAgICAgICAgICAgICAgIGlmIChB
cnJheS5pc0FycmF5KGUpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IGllKHQp
LCBvID0gZS5sZW5ndGg7IHMgPCBvOyBzKyspIHJbZVtzXV0gPSBndC5jc3ModCwgZVtzXSwgITEs
IGkpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcgogICAgICAgICAgICAgICAgICAg
IH0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdm9pZCAwICE9PSBuID8gZ3Quc3R5bGUodCwg
ZSwgbikgOiBndC5jc3ModCwgZSkKICAgICAgICAgICAgICAgIH0sIHQsIGUsIGFyZ3VtZW50cy5s
ZW5ndGggPiAxKQogICAgICAgICAgICB9CiAgICAgICAgfSksIGd0LlR3ZWVuID0gTywgTy5wcm90
b3R5cGUgPSB7CiAgICAgICAgICAgIGNvbnN0cnVjdG9yOiBPLAogICAgICAgICAgICBpbml0OiBm
dW5jdGlvbih0LCBlLCBuLCBpLCBvLCByKSB7CiAgICAgICAgICAgICAgICB0aGlzLmVsZW0gPSB0
LCB0aGlzLnByb3AgPSBuLCB0aGlzLmVhc2luZyA9IG8gfHwgZ3QuZWFzaW5nLl9kZWZhdWx0LCB0
aGlzLm9wdGlvbnMgPSBlLCB0aGlzLnN0YXJ0ID0gdGhpcy5ub3cgPSB0aGlzLmN1cigpLCB0aGlz
LmVuZCA9IGksIHRoaXMudW5pdCA9IHIgfHwgKGd0LmNzc051bWJlcltuXSA/ICIiIDogInB4IikK
ICAgICAgICAgICAgfSwKICAgICAgICAgICAgY3VyOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAg
ICAgIHZhciB0ID0gTy5wcm9wSG9va3NbdGhpcy5wcm9wXTsKICAgICAgICAgICAgICAgIHJldHVy
biB0ICYmIHQuZ2V0ID8gdC5nZXQodGhpcykgOiBPLnByb3BIb29rcy5fZGVmYXVsdC5nZXQodGhp
cykKICAgICAgICAgICAgfSwKICAgICAgICAgICAgcnVuOiBmdW5jdGlvbih0KSB7CiAgICAgICAg
ICAgICAgICB2YXIgZSwgbiA9IE8ucHJvcEhvb2tzW3RoaXMucHJvcF07CiAgICAgICAgICAgICAg
ICByZXR1cm4gdGhpcy5vcHRpb25zLmR1cmF0aW9uID8gdGhpcy5wb3MgPSBlID0gZ3QuZWFzaW5n
W3RoaXMuZWFzaW5nXSh0LCB0aGlzLm9wdGlvbnMuZHVyYXRpb24gKiB0LCAwLCAxLCB0aGlzLm9w
dGlvbnMuZHVyYXRpb24pIDogdGhpcy5wb3MgPSBlID0gdCwgdGhpcy5ub3cgPSAodGhpcy5lbmQg
LSB0aGlzLnN0YXJ0KSAqIGUgKyB0aGlzLnN0YXJ0LCB0aGlzLm9wdGlvbnMuc3RlcCAmJiB0aGlz
Lm9wdGlvbnMuc3RlcC5jYWxsKHRoaXMuZWxlbSwgdGhpcy5ub3csIHRoaXMpLCBuICYmIG4uc2V0
ID8gbi5zZXQodGhpcykgOiBPLnByb3BIb29rcy5fZGVmYXVsdC5zZXQodGhpcyksIHRoaXMKICAg
ICAgICAgICAgfQogICAgICAgIH0sIE8ucHJvdG90eXBlLmluaXQucHJvdG90eXBlID0gTy5wcm90
b3R5cGUsIE8ucHJvcEhvb2tzID0gewogICAgICAgICAgICBfZGVmYXVsdDogewogICAgICAgICAg
ICAgICAgZ2V0OiBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGU7CiAgICAg
ICAgICAgICAgICAgICAgcmV0dXJuIDEgIT09IHQuZWxlbS5ub2RlVHlwZSB8fCBudWxsICE9IHQu
ZWxlbVt0LnByb3BdICYmIG51bGwgPT0gdC5lbGVtLnN0eWxlW3QucHJvcF0gPyB0LmVsZW1bdC5w
cm9wXSA6IChlID0gZ3QuY3NzKHQuZWxlbSwgdC5wcm9wLCAiIiksIGUgJiYgImF1dG8iICE9PSBl
ID8gZSA6IDApCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgc2V0OiBmdW5jdGlv
bih0KSB7CiAgICAgICAgICAgICAgICAgICAgZ3QuZnguc3RlcFt0LnByb3BdID8gZ3QuZnguc3Rl
cFt0LnByb3BdKHQpIDogMSAhPT0gdC5lbGVtLm5vZGVUeXBlIHx8IG51bGwgPT0gdC5lbGVtLnN0
eWxlW2d0LmNzc1Byb3BzW3QucHJvcF1dICYmICFndC5jc3NIb29rc1t0LnByb3BdID8gdC5lbGVt
W3QucHJvcF0gPSB0Lm5vdyA6IGd0LnN0eWxlKHQuZWxlbSwgdC5wcm9wLCB0Lm5vdyArIHQudW5p
dCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0sIE8ucHJvcEhvb2tz
LnNjcm9sbFRvcCA9IE8ucHJvcEhvb2tzLnNjcm9sbExlZnQgPSB7CiAgICAgICAgICAgIHNldDog
ZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgdC5lbGVtLm5vZGVUeXBlICYmIHQuZWxlbS5w
YXJlbnROb2RlICYmICh0LmVsZW1bdC5wcm9wXSA9IHQubm93KQogICAgICAgICAgICB9CiAgICAg
ICAgfSwgZ3QuZWFzaW5nID0gewogICAgICAgICAgICBsaW5lYXI6IGZ1bmN0aW9uKHQpIHsKICAg
ICAgICAgICAgICAgIHJldHVybiB0CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHN3aW5nOiBm
dW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gLjUgLSBNYXRoLmNvcyh0ICogTWF0
aC5QSSkgLyAyCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIF9kZWZhdWx0OiAic3dpbmciCiAg
ICAgICAgfSwgZ3QuZnggPSBPLnByb3RvdHlwZS5pbml0LCBndC5meC5zdGVwID0ge307CiAgICAg
ICAgdmFyIGNlLCBwZSwgaGUgPSAvXig/OnRvZ2dsZXxzaG93fGhpZGUpJC8sCiAgICAgICAgICAg
IGZlID0gL3F1ZXVlSG9va3MkLzsKICAgICAgICBndC5BbmltYXRpb24gPSBndC5leHRlbmQoWSwg
ewogICAgICAgICAgICAgICAgdHdlZW5lcnM6IHsKICAgICAgICAgICAgICAgICAgICAiKiI6IFtm
dW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuID0gdGhpcy5jcmVh
dGVUd2Vlbih0LCBlKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGcobi5lbGVtLCB0
LCBJdC5leGVjKGUpLCBuKSwgbgogICAgICAgICAgICAgICAgICAgIH1dCiAgICAgICAgICAgICAg
ICB9LAogICAgICAgICAgICAgICAgdHdlZW5lcjogZnVuY3Rpb24odCwgZSkgewogICAgICAgICAg
ICAgICAgICAgIGd0LmlzRnVuY3Rpb24odCkgPyAoZSA9IHQsIHQgPSBbIioiXSkgOiB0ID0gdC5t
YXRjaChrdCk7CiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgbiwgaSA9IDAsIG8gPSB0Lmxl
bmd0aDsgaSA8IG87IGkrKykgbiA9IHRbaV0sIFkudHdlZW5lcnNbbl0gPSBZLnR3ZWVuZXJzW25d
IHx8IFtdLCBZLnR3ZWVuZXJzW25dLnVuc2hpZnQoZSkKICAgICAgICAgICAgICAgIH0sCiAgICAg
ICAgICAgICAgICBwcmVmaWx0ZXJzOiBbel0sCiAgICAgICAgICAgICAgICBwcmVmaWx0ZXI6IGZ1
bmN0aW9uKHQsIGUpIHsKICAgICAgICAgICAgICAgICAgICBlID8gWS5wcmVmaWx0ZXJzLnVuc2hp
ZnQodCkgOiBZLnByZWZpbHRlcnMucHVzaCh0KQogICAgICAgICAgICAgICAgfQogICAgICAgICAg
ICB9KSwgZ3Quc3BlZWQgPSBmdW5jdGlvbih0LCBlLCBuKSB7CiAgICAgICAgICAgICAgICB2YXIg
aSA9IHQgJiYgIm9iamVjdCIgPT0gdHlwZW9mIHQgPyBndC5leHRlbmQoe30sIHQpIDogewogICAg
ICAgICAgICAgICAgICAgIGNvbXBsZXRlOiBuIHx8ICFuICYmIGUgfHwgZ3QuaXNGdW5jdGlvbih0
KSAmJiB0LAogICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiB0LAogICAgICAgICAgICAgICAg
ICAgIGVhc2luZzogbiAmJiBlIHx8IGUgJiYgIWd0LmlzRnVuY3Rpb24oZSkgJiYgZQogICAgICAg
ICAgICAgICAgfTsKICAgICAgICAgICAgICAgIHJldHVybiBndC5meC5vZmYgPyBpLmR1cmF0aW9u
ID0gMCA6ICJudW1iZXIiICE9IHR5cGVvZiBpLmR1cmF0aW9uICYmIChpLmR1cmF0aW9uIGluIGd0
LmZ4LnNwZWVkcyA/IGkuZHVyYXRpb24gPSBndC5meC5zcGVlZHNbaS5kdXJhdGlvbl0gOiBpLmR1
cmF0aW9uID0gZ3QuZnguc3BlZWRzLl9kZWZhdWx0KSwgbnVsbCAhPSBpLnF1ZXVlICYmICEwICE9
PSBpLnF1ZXVlIHx8IChpLnF1ZXVlID0gImZ4IiksIGkub2xkID0gaS5jb21wbGV0ZSwKICAgICAg
ICAgICAgICAgICAgICBpLmNvbXBsZXRlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAg
ICAgICAgIGd0LmlzRnVuY3Rpb24oaS5vbGQpICYmIGkub2xkLmNhbGwodGhpcyksIGkucXVldWUg
JiYgZ3QuZGVxdWV1ZSh0aGlzLCBpLnF1ZXVlKQogICAgICAgICAgICAgICAgICAgIH0sIGkKICAg
ICAgICAgICAgfSwgZ3QuZm4uZXh0ZW5kKHsKICAgICAgICAgICAgICAgIGZhZGVUbzogZnVuY3Rp
b24odCwgZSwgbiwgaSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZpbHRlcihP
dCkuY3NzKCJvcGFjaXR5IiwgMCkuc2hvdygpLmVuZCgpLmFuaW1hdGUoewogICAgICAgICAgICAg
ICAgICAgICAgICBvcGFjaXR5OiBlCiAgICAgICAgICAgICAgICAgICAgfSwgdCwgbiwgaSkKICAg
ICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBhbmltYXRlOiBmdW5jdGlvbih0LCBlLCBu
LCBpKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIG8gPSBndC5pc0VtcHR5T2JqZWN0KHQpLAog
ICAgICAgICAgICAgICAgICAgICAgICByID0gZ3Quc3BlZWQoZSwgbiwgaSksCiAgICAgICAgICAg
ICAgICAgICAgICAgIHMgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHZhciBlID0gWSh0aGlzLCBndC5leHRlbmQoe30sIHQpLCByKTsKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIChvIHx8IEx0LmdldCh0aGlzLCAiZmluaXNoIikpICYmIGUuc3RvcCghMCkKICAg
ICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcy5maW5p
c2ggPSBzLCBvIHx8ICExID09PSByLnF1ZXVlID8gdGhpcy5lYWNoKHMpIDogdGhpcy5xdWV1ZShy
LnF1ZXVlLCBzKQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHN0b3A6IGZ1bmN0
aW9uKHQsIGUsIG4pIHsKICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IGZ1bmN0aW9uKHQpIHsK
ICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSB0LnN0b3A7CiAgICAgICAgICAgICAgICAg
ICAgICAgIGRlbGV0ZSB0LnN0b3AsIGUobikKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAg
ICAgICAgICAgICAgIHJldHVybiAic3RyaW5nIiAhPSB0eXBlb2YgdCAmJiAobiA9IGUsIGUgPSB0
LCB0ID0gdm9pZCAwKSwgZSAmJiAhMSAhPT0gdCAmJiB0aGlzLnF1ZXVlKHQgfHwgImZ4IiwgW10p
LCB0aGlzLmVhY2goZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlID0g
ITAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvID0gbnVsbCAhPSB0ICYmIHQgKyAicXVl
dWVIb29rcyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByID0gZ3QudGltZXJzLAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgcyA9IEx0LmdldCh0aGlzKTsKICAgICAgICAgICAgICAg
ICAgICAgICAgaWYgKG8pIHNbb10gJiYgc1tvXS5zdG9wICYmIGkoc1tvXSk7CiAgICAgICAgICAg
ICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobyBpbiBz
KSBzW29dICYmIHNbb10uc3RvcCAmJiBmZS50ZXN0KG8pICYmIGkoc1tvXSk7CiAgICAgICAgICAg
ICAgICAgICAgICAgIGZvciAobyA9IHIubGVuZ3RoOyBvLS07KSByW29dLmVsZW0gIT09IHRoaXMg
fHwgbnVsbCAhPSB0ICYmIHJbb10ucXVldWUgIT09IHQgfHwgKHJbb10uYW5pbS5zdG9wKG4pLCBl
ID0gITEsIHIuc3BsaWNlKG8sIDEpKTsKICAgICAgICAgICAgICAgICAgICAgICAgIWUgJiYgbiB8
fCBndC5kZXF1ZXVlKHRoaXMsIHQpCiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAg
ICAgIH0sCiAgICAgICAgICAgICAgICBmaW5pc2g6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAg
ICAgICAgICByZXR1cm4gITEgIT09IHQgJiYgKHQgPSB0IHx8ICJmeCIpLCB0aGlzLmVhY2goZnVu
Y3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlLCBuID0gTHQuZ2V0KHRoaXMp
LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaSA9IG5bdCArICJxdWV1ZSJdLAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgbyA9IG5bdCArICJxdWV1ZUhvb2tzIl0sCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICByID0gZ3QudGltZXJzLAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgcyA9IGkgPyBpLmxlbmd0aCA6IDA7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobi5m
aW5pc2ggPSAhMCwgZ3QucXVldWUodGhpcywgdCwgW10pLCBvICYmIG8uc3RvcCAmJiBvLnN0b3Au
Y2FsbCh0aGlzLCAhMCksIGUgPSByLmxlbmd0aDsgZS0tOykgcltlXS5lbGVtID09PSB0aGlzICYm
IHJbZV0ucXVldWUgPT09IHQgJiYgKHJbZV0uYW5pbS5zdG9wKCEwKSwgci5zcGxpY2UoZSwgMSkp
OwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGUgPSAwOyBlIDwgczsgZSsrKSBpW2VdICYm
IGlbZV0uZmluaXNoICYmIGlbZV0uZmluaXNoLmNhbGwodGhpcyk7CiAgICAgICAgICAgICAgICAg
ICAgICAgIGRlbGV0ZSBuLmZpbmlzaAogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAg
ICAgICB9CiAgICAgICAgICAgIH0pLCBndC5lYWNoKFsidG9nZ2xlIiwgInNob3ciLCAiaGlkZSJd
LCBmdW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAgICAgICB2YXIgbiA9IGd0LmZuW2VdOwogICAg
ICAgICAgICAgICAgZ3QuZm5bZV0gPSBmdW5jdGlvbih0LCBpLCBvKSB7CiAgICAgICAgICAgICAg
ICAgICAgcmV0dXJuIG51bGwgPT0gdCB8fCAiYm9vbGVhbiIgPT0gdHlwZW9mIHQgPyBuLmFwcGx5
KHRoaXMsIGFyZ3VtZW50cykgOiB0aGlzLmFuaW1hdGUoXyhlLCAhMCksIHQsIGksIG8pCiAgICAg
ICAgICAgICAgICB9CiAgICAgICAgICAgIH0pLCBndC5lYWNoKHsKICAgICAgICAgICAgICAgIHNs
aWRlRG93bjogXygic2hvdyIpLAogICAgICAgICAgICAgICAgc2xpZGVVcDogXygiaGlkZSIpLAog
ICAgICAgICAgICAgICAgc2xpZGVUb2dnbGU6IF8oInRvZ2dsZSIpLAogICAgICAgICAgICAgICAg
ZmFkZUluOiB7CiAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogInNob3ciCiAgICAgICAgICAg
ICAgICB9LAogICAgICAgICAgICAgICAgZmFkZU91dDogewogICAgICAgICAgICAgICAgICAgIG9w
YWNpdHk6ICJoaWRlIgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGZhZGVUb2dn
bGU6IHsKICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiAidG9nZ2xlIgogICAgICAgICAgICAg
ICAgfQogICAgICAgICAgICB9LCBmdW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAgICAgICBndC5m
blt0XSA9IGZ1bmN0aW9uKHQsIG4sIGkpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhp
cy5hbmltYXRlKGUsIHQsIG4sIGkpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pLCBn
dC50aW1lcnMgPSBbXSwgZ3QuZngudGljayA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAg
dmFyIHQsIGUgPSAwLAogICAgICAgICAgICAgICAgICAgIG4gPSBndC50aW1lcnM7CiAgICAgICAg
ICAgICAgICBmb3IgKGNlID0gZ3Qubm93KCk7IGUgPCBuLmxlbmd0aDsgZSsrKSh0ID0gbltlXSko
KSB8fCBuW2VdICE9PSB0IHx8IG4uc3BsaWNlKGUtLSwgMSk7CiAgICAgICAgICAgICAgICBuLmxl
bmd0aCB8fCBndC5meC5zdG9wKCksIGNlID0gdm9pZCAwCiAgICAgICAgICAgIH0sIGd0LmZ4LnRp
bWVyID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgZ3QudGltZXJzLnB1c2godCksIGd0
LmZ4LnN0YXJ0KCkKICAgICAgICAgICAgfSwgZ3QuZnguaW50ZXJ2YWwgPSAxMywgZ3QuZnguc3Rh
cnQgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHBlIHx8IChwZSA9ICEwLCBIKCkpCiAg
ICAgICAgICAgIH0sIGd0LmZ4LnN0b3AgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHBl
ID0gbnVsbAogICAgICAgICAgICB9LCBndC5meC5zcGVlZHMgPSB7CiAgICAgICAgICAgICAgICBz
bG93OiA2MDAsCiAgICAgICAgICAgICAgICBmYXN0OiAyMDAsCiAgICAgICAgICAgICAgICBfZGVm
YXVsdDogNDAwCiAgICAgICAgICAgIH0sIGd0LmZuLmRlbGF5ID0gZnVuY3Rpb24oZSwgbikgewog
ICAgICAgICAgICAgICAgcmV0dXJuIGUgPSBndC5meCA/IGd0LmZ4LnNwZWVkc1tlXSB8fCBlIDog
ZSwgbiA9IG4gfHwgImZ4IiwgdGhpcy5xdWV1ZShuLCBmdW5jdGlvbihuLCBpKSB7CiAgICAgICAg
ICAgICAgICAgICAgdmFyIG8gPSB0LnNldFRpbWVvdXQobiwgZSk7CiAgICAgICAgICAgICAgICAg
ICAgaS5zdG9wID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHQuY2xlYXJU
aW1lb3V0KG8pCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSkKICAgICAg
ICAgICAgfSwKICAgICAgICAgICAgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB2YXIgdCA9
IG50LmNyZWF0ZUVsZW1lbnQoImlucHV0IiksCiAgICAgICAgICAgICAgICAgICAgZSA9IG50LmNy
ZWF0ZUVsZW1lbnQoInNlbGVjdCIpLAogICAgICAgICAgICAgICAgICAgIG4gPSBlLmFwcGVuZENo
aWxkKG50LmNyZWF0ZUVsZW1lbnQoIm9wdGlvbiIpKTsKICAgICAgICAgICAgICAgIHQudHlwZSA9
ICJjaGVja2JveCIsIGZ0LmNoZWNrT24gPSAiIiAhPT0gdC52YWx1ZSwgZnQub3B0U2VsZWN0ZWQg
PSBuLnNlbGVjdGVkLCB0ID0gbnQuY3JlYXRlRWxlbWVudCgiaW5wdXQiKSwgdC52YWx1ZSA9ICJ0
IiwgdC50eXBlID0gInJhZGlvIiwgZnQucmFkaW9WYWx1ZSA9ICJ0IiA9PT0gdC52YWx1ZQogICAg
ICAgICAgICB9KCk7CiAgICAgICAgdmFyIGRlLCBnZSA9IGd0LmV4cHIuYXR0ckhhbmRsZTsKICAg
ICAgICBndC5mbi5leHRlbmQoewogICAgICAgICAgICBhdHRyOiBmdW5jdGlvbih0LCBlKSB7CiAg
ICAgICAgICAgICAgICByZXR1cm4gTXQodGhpcywgZ3QuYXR0ciwgdCwgZSwgYXJndW1lbnRzLmxl
bmd0aCA+IDEpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHJlbW92ZUF0dHI6IGZ1bmN0aW9u
KHQpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7CiAgICAg
ICAgICAgICAgICAgICAgZ3QucmVtb3ZlQXR0cih0aGlzLCB0KQogICAgICAgICAgICAgICAgfSkK
ICAgICAgICAgICAgfQogICAgICAgIH0pLCBndC5leHRlbmQoewogICAgICAgICAgICBhdHRyOiBm
dW5jdGlvbih0LCBlLCBuKSB7CiAgICAgICAgICAgICAgICB2YXIgaSwgbywgciA9IHQubm9kZVR5
cGU7CiAgICAgICAgICAgICAgICBpZiAoMyAhPT0gciAmJiA4ICE9PSByICYmIDIgIT09IHIpIHJl
dHVybiB2b2lkIDAgPT09IHQuZ2V0QXR0cmlidXRlID8gZ3QucHJvcCh0LCBlLCBuKSA6ICgxID09
PSByICYmIGd0LmlzWE1MRG9jKHQpIHx8IChvID0gZ3QuYXR0ckhvb2tzW2UudG9Mb3dlckNhc2Uo
KV0gfHwgKGd0LmV4cHIubWF0Y2guYm9vbC50ZXN0KGUpID8gZGUgOiB2b2lkIDApKSwgdm9pZCAw
ICE9PSBuID8gbnVsbCA9PT0gbiA/IHZvaWQgZ3QucmVtb3ZlQXR0cih0LCBlKSA6IG8gJiYgInNl
dCIgaW4gbyAmJiB2b2lkIDAgIT09IChpID0gby5zZXQodCwgbiwgZSkpID8gaSA6ICh0LnNldEF0
dHJpYnV0ZShlLCBuICsgIiIpLCBuKSA6IG8gJiYgImdldCIgaW4gbyAmJiBudWxsICE9PSAoaSA9
IG8uZ2V0KHQsIGUpKSA/IGkgOiAoaSA9IGd0LmZpbmQuYXR0cih0LCBlKSwgbnVsbCA9PSBpID8g
dm9pZCAwIDogaSkpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGF0dHJIb29rczogewogICAg
ICAgICAgICAgICAgdHlwZTogewogICAgICAgICAgICAgICAgICAgIHNldDogZnVuY3Rpb24odCwg
ZSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWZ0LnJhZGlvVmFsdWUgJiYgInJhZGlv
IiA9PT0gZSAmJiBvKHQsICJpbnB1dCIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2
YXIgbiA9IHQudmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5zZXRB
dHRyaWJ1dGUoInR5cGUiLCBlKSwgbiAmJiAodC52YWx1ZSA9IG4pLCBlCiAgICAgICAgICAgICAg
ICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAg
ICAgICAgIH0sCiAgICAgICAgICAgIHJlbW92ZUF0dHI6IGZ1bmN0aW9uKHQsIGUpIHsKICAgICAg
ICAgICAgICAgIHZhciBuLCBpID0gMCwKICAgICAgICAgICAgICAgICAgICBvID0gZSAmJiBlLm1h
dGNoKGt0KTsKICAgICAgICAgICAgICAgIGlmIChvICYmIDEgPT09IHQubm9kZVR5cGUpCiAgICAg
ICAgICAgICAgICAgICAgZm9yICg7IG4gPSBvW2krK107KSB0LnJlbW92ZUF0dHJpYnV0ZShuKQog
ICAgICAgICAgICB9CiAgICAgICAgfSksIGRlID0gewogICAgICAgICAgICBzZXQ6IGZ1bmN0aW9u
KHQsIGUsIG4pIHsKICAgICAgICAgICAgICAgIHJldHVybiAhMSA9PT0gZSA/IGd0LnJlbW92ZUF0
dHIodCwgbikgOiB0LnNldEF0dHJpYnV0ZShuLCBuKSwgbgogICAgICAgICAgICB9CiAgICAgICAg
fSwgZ3QuZWFjaChndC5leHByLm1hdGNoLmJvb2wuc291cmNlLm1hdGNoKC9cdysvZyksIGZ1bmN0
aW9uKHQsIGUpIHsKICAgICAgICAgICAgdmFyIG4gPSBnZVtlXSB8fCBndC5maW5kLmF0dHI7CiAg
ICAgICAgICAgIGdlW2VdID0gZnVuY3Rpb24odCwgZSwgaSkgewogICAgICAgICAgICAgICAgdmFy
IG8sIHIsIHMgPSBlLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgICAgICAgICByZXR1cm4gaSB8fCAo
ciA9IGdlW3NdLCBnZVtzXSA9IG8sIG8gPSBudWxsICE9IG4odCwgZSwgaSkgPyBzIDogbnVsbCwg
Z2Vbc10gPSByKSwgbwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgdmFyIG1lID0g
L14oPzppbnB1dHxzZWxlY3R8dGV4dGFyZWF8YnV0dG9uKSQvaSwKICAgICAgICAgICAgdmUgPSAv
Xig/OmF8YXJlYSkkL2k7CiAgICAgICAgZ3QuZm4uZXh0ZW5kKHsKICAgICAgICAgICAgcHJvcDog
ZnVuY3Rpb24odCwgZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIE10KHRoaXMsIGd0LnByb3As
IHQsIGUsIGFyZ3VtZW50cy5sZW5ndGggPiAxKQogICAgICAgICAgICB9LAogICAgICAgICAgICBy
ZW1vdmVQcm9wOiBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5lYWNo
KGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzW2d0LnByb3BGaXhb
dF0gfHwgdF0KICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICB9KSwgZ3Qu
ZXh0ZW5kKHsKICAgICAgICAgICAgcHJvcDogZnVuY3Rpb24odCwgZSwgbikgewogICAgICAgICAg
ICAgICAgdmFyIGksIG8sIHIgPSB0Lm5vZGVUeXBlOwogICAgICAgICAgICAgICAgaWYgKDMgIT09
IHIgJiYgOCAhPT0gciAmJiAyICE9PSByKSByZXR1cm4gMSA9PT0gciAmJiBndC5pc1hNTERvYyh0
KSB8fCAoZSA9IGd0LnByb3BGaXhbZV0gfHwgZSwgbyA9IGd0LnByb3BIb29rc1tlXSksIHZvaWQg
MCAhPT0gbiA/IG8gJiYgInNldCIgaW4gbyAmJiB2b2lkIDAgIT09IChpID0gby5zZXQodCwgbiwg
ZSkpID8gaSA6IHRbZV0gPSBuIDogbyAmJiAiZ2V0IiBpbiBvICYmIG51bGwgIT09IChpID0gby5n
ZXQodCwgZSkpID8gaSA6IHRbZV0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgcHJvcEhvb2tz
OiB7CiAgICAgICAgICAgICAgICB0YWJJbmRleDogewogICAgICAgICAgICAgICAgICAgIGdldDog
ZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IGd0LmZpbmQuYXR0
cih0LCAidGFiaW5kZXgiKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGUgPyBwYXJz
ZUludChlLCAxMCkgOiBtZS50ZXN0KHQubm9kZU5hbWUpIHx8IHZlLnRlc3QodC5ub2RlTmFtZSkg
JiYgdC5ocmVmID8gMCA6IC0xCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg
fQogICAgICAgICAgICB9LAogICAgICAgICAgICBwcm9wRml4OiB7CiAgICAgICAgICAgICAgICBm
b3I6ICJodG1sRm9yIiwKICAgICAgICAgICAgICAgIGNsYXNzOiAiY2xhc3NOYW1lIgogICAgICAg
ICAgICB9CiAgICAgICAgfSksIGZ0Lm9wdFNlbGVjdGVkIHx8IChndC5wcm9wSG9va3Muc2VsZWN0
ZWQgPSB7CiAgICAgICAgICAgIGdldDogZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgdmFy
IGUgPSB0LnBhcmVudE5vZGU7CiAgICAgICAgICAgICAgICByZXR1cm4gZSAmJiBlLnBhcmVudE5v
ZGUgJiYgZS5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXgsIG51bGwKICAgICAgICAgICAgfSwKICAg
ICAgICAgICAgc2V0OiBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICB2YXIgZSA9IHQucGFy
ZW50Tm9kZTsKICAgICAgICAgICAgICAgIGUgJiYgKGUuc2VsZWN0ZWRJbmRleCwgZS5wYXJlbnRO
b2RlICYmIGUucGFyZW50Tm9kZS5zZWxlY3RlZEluZGV4KQogICAgICAgICAgICB9CiAgICAgICAg
fSksIGd0LmVhY2goWyJ0YWJJbmRleCIsICJyZWFkT25seSIsICJtYXhMZW5ndGgiLCAiY2VsbFNw
YWNpbmciLCAiY2VsbFBhZGRpbmciLCAicm93U3BhbiIsICJjb2xTcGFuIiwgInVzZU1hcCIsICJm
cmFtZUJvcmRlciIsICJjb250ZW50RWRpdGFibGUiXSwgZnVuY3Rpb24oKSB7CiAgICAgICAgICAg
IGd0LnByb3BGaXhbdGhpcy50b0xvd2VyQ2FzZSgpXSA9IHRoaXMKICAgICAgICB9KSwgZ3QuZm4u
ZXh0ZW5kKHsKICAgICAgICAgICAgYWRkQ2xhc3M6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAg
ICAgIHZhciBlLCBuLCBpLCBvLCByLCBzLCBhLCB1ID0gMDsKICAgICAgICAgICAgICAgIGlmIChn
dC5pc0Z1bmN0aW9uKHQpKSByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGUpIHsKICAgICAgICAg
ICAgICAgICAgICBndCh0aGlzKS5hZGRDbGFzcyh0LmNhbGwodGhpcywgZSwgVSh0aGlzKSkpCiAg
ICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGlmICgic3RyaW5nIiA9PSB0eXBlb2Yg
dCAmJiB0KQogICAgICAgICAgICAgICAgICAgIGZvciAoZSA9IHQubWF0Y2goa3QpIHx8IFtdOyBu
ID0gdGhpc1t1KytdOykKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG8gPSBVKG4pLCBpID0g
MSA9PT0gbi5ub2RlVHlwZSAmJiAiICIgKyBWKG8pICsgIiAiKSB7CiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBmb3IgKHMgPSAwOyByID0gZVtzKytdOykgaS5pbmRleE9mKCIgIiArIHIgKyAi
ICIpIDwgMCAmJiAoaSArPSByICsgIiAiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEg
PSBWKGkpLCBvICE9PSBhICYmIG4uc2V0QXR0cmlidXRlKCJjbGFzcyIsIGEpCiAgICAgICAgICAg
ICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzCiAgICAgICAgICAgIH0s
CiAgICAgICAgICAgIHJlbW92ZUNsYXNzOiBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICB2
YXIgZSwgbiwgaSwgbywgciwgcywgYSwgdSA9IDA7CiAgICAgICAgICAgICAgICBpZiAoZ3QuaXNG
dW5jdGlvbih0KSkgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAg
ICAgICAgZ3QodGhpcykucmVtb3ZlQ2xhc3ModC5jYWxsKHRoaXMsIGUsIFUodGhpcykpKQogICAg
ICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHJl
dHVybiB0aGlzLmF0dHIoImNsYXNzIiwgIiIpOwogICAgICAgICAgICAgICAgaWYgKCJzdHJpbmci
ID09IHR5cGVvZiB0ICYmIHQpCiAgICAgICAgICAgICAgICAgICAgZm9yIChlID0gdC5tYXRjaChr
dCkgfHwgW107IG4gPSB0aGlzW3UrK107KQogICAgICAgICAgICAgICAgICAgICAgICBpZiAobyA9
IFUobiksIGkgPSAxID09PSBuLm5vZGVUeXBlICYmICIgIiArIFYobykgKyAiICIpIHsKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGZvciAocyA9IDA7IHIgPSBlW3MrK107KQogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGZvciAoOyBpLmluZGV4T2YoIiAiICsgciArICIgIikgPiAt
MTspIGkgPSBpLnJlcGxhY2UoIiAiICsgciArICIgIiwgIiAiKTsKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGEgPSBWKGkpLCBvICE9PSBhICYmIG4uc2V0QXR0cmlidXRlKCJjbGFzcyIsIGEp
CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0aGlzCiAg
ICAgICAgICAgIH0sCiAgICAgICAgICAgIHRvZ2dsZUNsYXNzOiBmdW5jdGlvbih0LCBlKSB7CiAg
ICAgICAgICAgICAgICB2YXIgbiA9IHR5cGVvZiB0OwogICAgICAgICAgICAgICAgcmV0dXJuICJi
b29sZWFuIiA9PSB0eXBlb2YgZSAmJiAic3RyaW5nIiA9PT0gbiA/IGUgPyB0aGlzLmFkZENsYXNz
KHQpIDogdGhpcy5yZW1vdmVDbGFzcyh0KSA6IGd0LmlzRnVuY3Rpb24odCkgPyB0aGlzLmVhY2go
ZnVuY3Rpb24obikgewogICAgICAgICAgICAgICAgICAgIGd0KHRoaXMpLnRvZ2dsZUNsYXNzKHQu
Y2FsbCh0aGlzLCBuLCBVKHRoaXMpLCBlKSwgZSkKICAgICAgICAgICAgICAgIH0pIDogdGhpcy5l
YWNoKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHZhciBlLCBpLCBvLCByOwogICAg
ICAgICAgICAgICAgICAgIGlmICgic3RyaW5nIiA9PT0gbikKICAgICAgICAgICAgICAgICAgICAg
ICAgZm9yIChpID0gMCwgbyA9IGd0KHRoaXMpLCByID0gdC5tYXRjaChrdCkgfHwgW107IGUgPSBy
W2krK107KSBvLmhhc0NsYXNzKGUpID8gby5yZW1vdmVDbGFzcyhlKSA6IG8uYWRkQ2xhc3MoZSk7
CiAgICAgICAgICAgICAgICAgICAgZWxzZSB2b2lkIDAgIT09IHQgJiYgImJvb2xlYW4iICE9PSBu
IHx8IChlID0gVSh0aGlzKSwgZSAmJiBMdC5zZXQodGhpcywgIl9fY2xhc3NOYW1lX18iLCBlKSwg
dGhpcy5zZXRBdHRyaWJ1dGUgJiYgdGhpcy5zZXRBdHRyaWJ1dGUoImNsYXNzIiwgZSB8fCAhMSA9
PT0gdCA/ICIiIDogTHQuZ2V0KHRoaXMsICJfX2NsYXNzTmFtZV9fIikgfHwgIiIpKQogICAgICAg
ICAgICAgICAgfSkKICAgICAgICAgICAgfSwKICAgICAgICAgICAgaGFzQ2xhc3M6IGZ1bmN0aW9u
KHQpIHsKICAgICAgICAgICAgICAgIHZhciBlLCBuLCBpID0gMDsKICAgICAgICAgICAgICAgIGZv
ciAoZSA9ICIgIiArIHQgKyAiICI7IG4gPSB0aGlzW2krK107KQogICAgICAgICAgICAgICAgICAg
IGlmICgxID09PSBuLm5vZGVUeXBlICYmICgiICIgKyBWKFUobikpICsgIiAiKS5pbmRleE9mKGUp
ID4gLTEpIHJldHVybiAhMDsKICAgICAgICAgICAgICAgIHJldHVybiAhMQogICAgICAgICAgICB9
CiAgICAgICAgfSk7CiAgICAgICAgZ3QuZm4uZXh0ZW5kKHsKICAgICAgICAgICAgdmFsOiBmdW5j
dGlvbih0KSB7CiAgICAgICAgICAgICAgICB2YXIgZSwgbiwgaSwgbyA9IHRoaXNbMF07CiAgICAg
ICAgICAgICAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA/IChpID0gZ3QuaXNGdW5jdGlvbih0
KSwgdGhpcy5lYWNoKGZ1bmN0aW9uKG4pIHsKICAgICAgICAgICAgICAgICAgICB2YXIgbzsKICAg
ICAgICAgICAgICAgICAgICAxID09PSB0aGlzLm5vZGVUeXBlICYmIChvID0gaSA/IHQuY2FsbCh0
aGlzLCBuLCBndCh0aGlzKS52YWwoKSkgOiB0LCBudWxsID09IG8gPyBvID0gIiIgOiAibnVtYmVy
IiA9PSB0eXBlb2YgbyA/IG8gKz0gIiIgOiBBcnJheS5pc0FycmF5KG8pICYmIChvID0gZ3QubWFw
KG8sIGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGwgPT0g
dCA/ICIiIDogdCArICIiCiAgICAgICAgICAgICAgICAgICAgfSkpLCAoZSA9IGd0LnZhbEhvb2tz
W3RoaXMudHlwZV0gfHwgZ3QudmFsSG9va3NbdGhpcy5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpXSkg
JiYgInNldCIgaW4gZSAmJiB2b2lkIDAgIT09IGUuc2V0KHRoaXMsIG8sICJ2YWx1ZSIpIHx8ICh0
aGlzLnZhbHVlID0gbykpCiAgICAgICAgICAgICAgICB9KSkgOiBvID8gKGUgPSBndC52YWxIb29r
c1tvLnR5cGVdIHx8IGd0LnZhbEhvb2tzW28ubm9kZU5hbWUudG9Mb3dlckNhc2UoKV0sIGUgJiYg
ImdldCIgaW4gZSAmJiB2b2lkIDAgIT09IChuID0gZS5nZXQobywgInZhbHVlIikpID8gbiA6IChu
ID0gby52YWx1ZSwgInN0cmluZyIgPT0gdHlwZW9mIG4gPyBuLnJlcGxhY2UoL1xyL2csICIiKSA6
IG51bGwgPT0gbiA/ICIiIDogbikpIDogdm9pZCAwCiAgICAgICAgICAgIH0KICAgICAgICB9KSwg
Z3QuZXh0ZW5kKHsKICAgICAgICAgICAgdmFsSG9va3M6IHsKICAgICAgICAgICAgICAgIG9wdGlv
bjogewogICAgICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24odCkgewogICAgICAgICAgICAg
ICAgICAgICAgICB2YXIgZSA9IGd0LmZpbmQuYXR0cih0LCAidmFsdWUiKTsKICAgICAgICAgICAg
ICAgICAgICAgICAgcmV0dXJuIG51bGwgIT0gZSA/IGUgOiBWKGd0LnRleHQodCkpCiAgICAgICAg
ICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHNlbGVjdDog
ewogICAgICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAg
ICAgICAgICB2YXIgZSwgbiwgaSwgciA9IHQub3B0aW9ucywKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHMgPSB0LnNlbGVjdGVkSW5kZXgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBh
ID0gInNlbGVjdC1vbmUiID09PSB0LnR5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1
ID0gYSA/IG51bGwgOiBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwgPSBhID8gcyAr
IDEgOiByLmxlbmd0aDsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gcyA8IDAgPyBs
IDogYSA/IHMgOiAwOyBpIDwgbDsgaSsrKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYg
KG4gPSByW2ldLCAobi5zZWxlY3RlZCB8fCBpID09PSBzKSAmJiAhbi5kaXNhYmxlZCAmJiAoIW4u
cGFyZW50Tm9kZS5kaXNhYmxlZCB8fCAhbyhuLnBhcmVudE5vZGUsICJvcHRncm91cCIpKSkgewog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlID0gZ3QobikudmFsKCksIGEpIHJl
dHVybiBlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUucHVzaChlKQogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdQog
ICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbih0
LCBlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIG4sIGksIG8gPSB0Lm9wdGlv
bnMsIHIgPSBndC5tYWtlQXJyYXkoZSksIHMgPSBvLmxlbmd0aDsgcy0tOykgaSA9IG9bc10sIChp
LnNlbGVjdGVkID0gZ3QuaW5BcnJheShndC52YWxIb29rcy5vcHRpb24uZ2V0KGkpLCByKSA+IC0x
KSAmJiAobiA9ICEwKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG4gfHwgKHQuc2Vs
ZWN0ZWRJbmRleCA9IC0xKSwgcgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg
IH0KICAgICAgICAgICAgfQogICAgICAgIH0pLCBndC5lYWNoKFsicmFkaW8iLCAiY2hlY2tib3gi
XSwgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGd0LnZhbEhvb2tzW3RoaXNdID0gewogICAgICAg
ICAgICAgICAgc2V0OiBmdW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKEFy
cmF5LmlzQXJyYXkoZSkpIHJldHVybiB0LmNoZWNrZWQgPSBndC5pbkFycmF5KGd0KHQpLnZhbCgp
LCBlKSA+IC0xCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIGZ0LmNoZWNrT24gfHwg
KGd0LnZhbEhvb2tzW3RoaXNdLmdldCA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIHJl
dHVybiBudWxsID09PSB0LmdldEF0dHJpYnV0ZSgidmFsdWUiKSA/ICJvbiIgOiB0LnZhbHVlCiAg
ICAgICAgICAgIH0pCiAgICAgICAgfSk7CiAgICAgICAgdmFyIHllID0gL14oPzpmb2N1c2luZm9j
dXN8Zm9jdXNvdXRibHVyKSQvOwogICAgICAgIGd0LmV4dGVuZChndC5ldmVudCwgewogICAgICAg
ICAgICB0cmlnZ2VyOiBmdW5jdGlvbihlLCBuLCBpLCBvKSB7CiAgICAgICAgICAgICAgICB2YXIg
ciwgcywgYSwgdSwgbCwgYywgcCwgaCA9IFtpIHx8IG50XSwKICAgICAgICAgICAgICAgICAgICBm
ID0gY3QuY2FsbChlLCAidHlwZSIpID8gZS50eXBlIDogZSwKICAgICAgICAgICAgICAgICAgICBk
ID0gY3QuY2FsbChlLCAibmFtZXNwYWNlIikgPyBlLm5hbWVzcGFjZS5zcGxpdCgiLiIpIDogW107
CiAgICAgICAgICAgICAgICBpZiAocyA9IGEgPSBpID0gaSB8fCBudCwgMyAhPT0gaS5ub2RlVHlw
ZSAmJiA4ICE9PSBpLm5vZGVUeXBlICYmICF5ZS50ZXN0KGYgKyBndC5ldmVudC50cmlnZ2VyZWQp
ICYmIChmLmluZGV4T2YoIi4iKSA+IC0xICYmIChkID0gZi5zcGxpdCgiLiIpLCBmID0gZC5zaGlm
dCgpLCBkLnNvcnQoKSksIGwgPSBmLmluZGV4T2YoIjoiKSA8IDAgJiYgIm9uIiArIGYsIGUgPSBl
W2d0LmV4cGFuZG9dID8gZSA6IG5ldyBndC5FdmVudChmLCAib2JqZWN0IiA9PSB0eXBlb2YgZSAm
JiBlKSwgZS5pc1RyaWdnZXIgPSBvID8gMiA6IDMsIGUubmFtZXNwYWNlID0gZC5qb2luKCIuIiks
IGUucm5hbWVzcGFjZSA9IGUubmFtZXNwYWNlID8gbmV3IFJlZ0V4cCgiKF58XFwuKSIgKyBkLmpv
aW4oIlxcLig/Oi4qXFwufCkiKSArICIoXFwufCQpIikgOiBudWxsLCBlLnJlc3VsdCA9IHZvaWQg
MCwgZS50YXJnZXQgfHwgKGUudGFyZ2V0ID0gaSksIG4gPSBudWxsID09IG4gPyBbZV0gOiBndC5t
YWtlQXJyYXkobiwgW2VdKSwgcCA9IGd0LmV2ZW50LnNwZWNpYWxbZl0gfHwge30sIG8gfHwgIXAu
dHJpZ2dlciB8fCAhMSAhPT0gcC50cmlnZ2VyLmFwcGx5KGksIG4pKSkgewogICAgICAgICAgICAg
ICAgICAgIGlmICghbyAmJiAhcC5ub0J1YmJsZSAmJiAhZ3QuaXNXaW5kb3coaSkpIHsKICAgICAg
ICAgICAgICAgICAgICAgICAgZm9yICh1ID0gcC5kZWxlZ2F0ZVR5cGUgfHwgZiwgeWUudGVzdCh1
ICsgZikgfHwgKHMgPSBzLnBhcmVudE5vZGUpOyBzOyBzID0gcy5wYXJlbnROb2RlKSBoLnB1c2go
cyksIGEgPSBzOwogICAgICAgICAgICAgICAgICAgICAgICBhID09PSAoaS5vd25lckRvY3VtZW50
IHx8IG50KSAmJiBoLnB1c2goYS5kZWZhdWx0VmlldyB8fCBhLnBhcmVudFdpbmRvdyB8fCB0KQog
ICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBmb3IgKHIgPSAwOwogICAg
ICAgICAgICAgICAgICAgICAgICAocyA9IGhbcisrXSkgJiYgIWUuaXNQcm9wYWdhdGlvblN0b3Bw
ZWQoKTspIGUudHlwZSA9IHIgPiAxID8gdSA6IHAuYmluZFR5cGUgfHwgZiwgYyA9IChMdC5nZXQo
cywgImV2ZW50cyIpIHx8IHt9KVtlLnR5cGVdICYmIEx0LmdldChzLCAiaGFuZGxlIiksIGMgJiYg
Yy5hcHBseShzLCBuKSwgKGMgPSBsICYmIHNbbF0pICYmIGMuYXBwbHkgJiYganQocykgJiYgKGUu
cmVzdWx0ID0gYy5hcHBseShzLCBuKSwgITEgPT09IGUucmVzdWx0ICYmIGUucHJldmVudERlZmF1
bHQoKSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGUudHlwZSA9IGYsIG8gfHwgZS5pc0Rl
ZmF1bHRQcmV2ZW50ZWQoKSB8fCBwLl9kZWZhdWx0ICYmICExICE9PSBwLl9kZWZhdWx0LmFwcGx5
KGgucG9wKCksIG4pIHx8ICFqdChpKSB8fCBsICYmIGd0LmlzRnVuY3Rpb24oaVtmXSkgJiYgIWd0
LmlzV2luZG93KGkpICYmIChhID0gaVtsXSwgYSAmJiAoaVtsXSA9IG51bGwpLCBndC5ldmVudC50
cmlnZ2VyZWQgPSBmLCBpW2ZdKCksIGd0LmV2ZW50LnRyaWdnZXJlZCA9IHZvaWQgMCwgYSAmJiAo
aVtsXSA9IGEpKSwgZS5yZXN1bHQKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAg
ICAgICAgICAgc2ltdWxhdGU6IGZ1bmN0aW9uKHQsIGUsIG4pIHsKICAgICAgICAgICAgICAgIHZh
ciBpID0gZ3QuZXh0ZW5kKG5ldyBndC5FdmVudCwgbiwgewogICAgICAgICAgICAgICAgICAgIHR5
cGU6IHQsCiAgICAgICAgICAgICAgICAgICAgaXNTaW11bGF0ZWQ6ICEwCiAgICAgICAgICAgICAg
ICB9KTsKICAgICAgICAgICAgICAgIGd0LmV2ZW50LnRyaWdnZXIoaSwgbnVsbCwgZSkKICAgICAg
ICAgICAgfQogICAgICAgIH0pLCBndC5mbi5leHRlbmQoewogICAgICAgICAgICB0cmlnZ2VyOiBm
dW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9u
KCkgewogICAgICAgICAgICAgICAgICAgIGd0LmV2ZW50LnRyaWdnZXIodCwgZSwgdGhpcykKICAg
ICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHRyaWdnZXJIYW5kbGVy
OiBmdW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAgICAgICB2YXIgbiA9IHRoaXNbMF07CiAgICAg
ICAgICAgICAgICBpZiAobikgcmV0dXJuIGd0LmV2ZW50LnRyaWdnZXIodCwgZSwgbiwgITApCiAg
ICAgICAgICAgIH0KICAgICAgICB9KSwgZ3QuZWFjaCgiYmx1ciBmb2N1cyBmb2N1c2luIGZvY3Vz
b3V0IHJlc2l6ZSBzY3JvbGwgY2xpY2sgZGJsY2xpY2sgbW91c2Vkb3duIG1vdXNldXAgbW91c2Vt
b3ZlIG1vdXNlb3ZlciBtb3VzZW91dCBtb3VzZWVudGVyIG1vdXNlbGVhdmUgY2hhbmdlIHNlbGVj
dCBzdWJtaXQga2V5ZG93biBrZXlwcmVzcyBrZXl1cCBjb250ZXh0bWVudSIuc3BsaXQoIiAiKSwg
ZnVuY3Rpb24odCwgZSkgewogICAgICAgICAgICBndC5mbltlXSA9IGZ1bmN0aW9uKHQsIG4pIHsK
ICAgICAgICAgICAgICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID4gMCA/IHRoaXMub24oZSwg
bnVsbCwgdCwgbikgOiB0aGlzLnRyaWdnZXIoZSkKICAgICAgICAgICAgfQogICAgICAgIH0pLCBn
dC5mbi5leHRlbmQoewogICAgICAgICAgICBob3ZlcjogZnVuY3Rpb24odCwgZSkgewogICAgICAg
ICAgICAgICAgcmV0dXJuIHRoaXMubW91c2VlbnRlcih0KS5tb3VzZWxlYXZlKGUgfHwgdCkKICAg
ICAgICAgICAgfQogICAgICAgIH0pLCBmdC5mb2N1c2luID0gIm9uZm9jdXNpbiIgaW4gdCwgZnQu
Zm9jdXNpbiB8fCBndC5lYWNoKHsKICAgICAgICAgICAgZm9jdXM6ICJmb2N1c2luIiwKICAgICAg
ICAgICAgYmx1cjogImZvY3Vzb3V0IgogICAgICAgIH0sIGZ1bmN0aW9uKHQsIGUpIHsKICAgICAg
ICAgICAgdmFyIG4gPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICBndC5ldmVudC5zaW11
bGF0ZShlLCB0LnRhcmdldCwgZ3QuZXZlbnQuZml4KHQpKQogICAgICAgICAgICB9OwogICAgICAg
ICAgICBndC5ldmVudC5zcGVjaWFsW2VdID0gewogICAgICAgICAgICAgICAgc2V0dXA6IGZ1bmN0
aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHZhciBpID0gdGhpcy5vd25lckRvY3VtZW50IHx8
IHRoaXMsCiAgICAgICAgICAgICAgICAgICAgICAgIG8gPSBMdC5hY2Nlc3MoaSwgZSk7CiAgICAg
ICAgICAgICAgICAgICAgbyB8fCBpLmFkZEV2ZW50TGlzdGVuZXIodCwgbiwgITApLCBMdC5hY2Nl
c3MoaSwgZSwgKG8gfHwgMCkgKyAxKQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAg
IHRlYXJkb3duOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IHRoaXMu
b3duZXJEb2N1bWVudCB8fCB0aGlzLAogICAgICAgICAgICAgICAgICAgICAgICBvID0gTHQuYWNj
ZXNzKGksIGUpIC0gMTsKICAgICAgICAgICAgICAgICAgICBvID8gTHQuYWNjZXNzKGksIGUsIG8p
IDogKGkucmVtb3ZlRXZlbnRMaXN0ZW5lcih0LCBuLCAhMCksIEx0LnJlbW92ZShpLCBlKSkKICAg
ICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIHZhciB4ZSA9
IHQubG9jYXRpb24sCiAgICAgICAgICAgIGJlID0gZ3Qubm93KCksCiAgICAgICAgICAgIFRlID0g
L1w/LzsKICAgICAgICBndC5wYXJzZVhNTCA9IGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgdmFy
IG47CiAgICAgICAgICAgIGlmICghZSB8fCAic3RyaW5nIiAhPSB0eXBlb2YgZSkgcmV0dXJuIG51
bGw7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBuID0gKG5ldyB0LkRPTVBhcnNl
cikucGFyc2VGcm9tU3RyaW5nKGUsICJ0ZXh0L3htbCIpCiAgICAgICAgICAgIH0gY2F0Y2ggKHQp
IHsKICAgICAgICAgICAgICAgIG4gPSB2b2lkIDAKICAgICAgICAgICAgfQogICAgICAgICAgICBy
ZXR1cm4gbiAmJiAhbi5nZXRFbGVtZW50c0J5VGFnTmFtZSgicGFyc2VyZXJyb3IiKS5sZW5ndGgg
fHwgZ3QuZXJyb3IoIkludmFsaWQgWE1MOiAiICsgZSksIG4KICAgICAgICB9OwogICAgICAgIHZh
ciB3ZSA9IC9cW1xdJC8sCiAgICAgICAgICAgIENlID0gL14oPzpzdWJtaXR8YnV0dG9ufGltYWdl
fHJlc2V0fGZpbGUpJC9pLAogICAgICAgICAgICBTZSA9IC9eKD86aW5wdXR8c2VsZWN0fHRleHRh
cmVhfGtleWdlbikvaTsKICAgICAgICBndC5wYXJhbSA9IGZ1bmN0aW9uKHQsIGUpIHsKICAgICAg
ICAgICAgdmFyIG4sIGkgPSBbXSwKICAgICAgICAgICAgICAgIG8gPSBmdW5jdGlvbih0LCBlKSB7
CiAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSBndC5pc0Z1bmN0aW9uKGUpID8gZSgpIDogZTsK
ICAgICAgICAgICAgICAgICAgICBpW2kubGVuZ3RoXSA9IGVuY29kZVVSSUNvbXBvbmVudCh0KSAr
ICI9IiArIGVuY29kZVVSSUNvbXBvbmVudChudWxsID09IG4gPyAiIiA6IG4pCiAgICAgICAgICAg
ICAgICB9OwogICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh0KSB8fCB0LmpxdWVyeSAmJiAh
Z3QuaXNQbGFpbk9iamVjdCh0KSkgZ3QuZWFjaCh0LCBmdW5jdGlvbigpIHsKICAgICAgICAgICAg
ICAgIG8odGhpcy5uYW1lLCB0aGlzLnZhbHVlKQogICAgICAgICAgICB9KTsKICAgICAgICAgICAg
ZWxzZQogICAgICAgICAgICAgICAgZm9yIChuIGluIHQpIFEobiwgdFtuXSwgZSwgbyk7CiAgICAg
ICAgICAgIHJldHVybiBpLmpvaW4oIiYiKQogICAgICAgIH0sIGd0LmZuLmV4dGVuZCh7CiAgICAg
ICAgICAgIHNlcmlhbGl6ZTogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZ3Qu
cGFyYW0odGhpcy5zZXJpYWxpemVBcnJheSgpKQogICAgICAgICAgICB9LAogICAgICAgICAgICBz
ZXJpYWxpemVBcnJheTogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5t
YXAoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHQgPSBndC5wcm9wKHRoaXMs
ICJlbGVtZW50cyIpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiB0ID8gZ3QubWFrZUFycmF5
KHQpIDogdGhpcwogICAgICAgICAgICAgICAgfSkuZmlsdGVyKGZ1bmN0aW9uKCkgewogICAgICAg
ICAgICAgICAgICAgIHZhciB0ID0gdGhpcy50eXBlOwogICAgICAgICAgICAgICAgICAgIHJldHVy
biB0aGlzLm5hbWUgJiYgIWd0KHRoaXMpLmlzKCI6ZGlzYWJsZWQiKSAmJiBTZS50ZXN0KHRoaXMu
bm9kZU5hbWUpICYmICFDZS50ZXN0KHQpICYmICh0aGlzLmNoZWNrZWQgfHwgIV90LnRlc3QodCkp
CiAgICAgICAgICAgICAgICB9KS5tYXAoZnVuY3Rpb24odCwgZSkgewogICAgICAgICAgICAgICAg
ICAgIHZhciBuID0gZ3QodGhpcykudmFsKCk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51
bGwgPT0gbiA/IG51bGwgOiBBcnJheS5pc0FycmF5KG4pID8gZ3QubWFwKG4sIGZ1bmN0aW9uKHQp
IHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIG5hbWU6IGUubmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0
LnJlcGxhY2UoL1xyP1xuL2csICJcclxuIikKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAg
ICAgICAgICAgICAgICAgIH0pIDogewogICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBlLm5h
bWUsCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBuLnJlcGxhY2UoL1xyP1xuL2csICJc
clxuIikKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KS5nZXQoKQogICAg
ICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgdmFyIEVlID0gL14oLio/KTpbIFx0XSooW15c
clxuXSopJC9nbSwKICAgICAgICAgICAgQWUgPSAvXig/OmFib3V0fGFwcHxhcHAtc3RvcmFnZXwu
Ky1leHRlbnNpb258ZmlsZXxyZXN8d2lkZ2V0KTokLywKICAgICAgICAgICAga2UgPSAvXig/OkdF
VHxIRUFEKSQvLAogICAgICAgICAgICBEZSA9IHt9LAogICAgICAgICAgICBOZSA9IHt9LAogICAg
ICAgICAgICBNZSA9ICIqLyIuY29uY2F0KCIqIiksCiAgICAgICAgICAgIGplID0gbnQuY3JlYXRl
RWxlbWVudCgiYSIpOwogICAgICAgIGplLmhyZWYgPSB4ZS5ocmVmLCBndC5leHRlbmQoewogICAg
ICAgICAgICBhY3RpdmU6IDAsCiAgICAgICAgICAgIGxhc3RNb2RpZmllZDoge30sCiAgICAgICAg
ICAgIGV0YWc6IHt9LAogICAgICAgICAgICBhamF4U2V0dGluZ3M6IHsKICAgICAgICAgICAgICAg
IHVybDogeGUuaHJlZiwKICAgICAgICAgICAgICAgIHR5cGU6ICJHRVQiLAogICAgICAgICAgICAg
ICAgaXNMb2NhbDogQWUudGVzdCh4ZS5wcm90b2NvbCksCiAgICAgICAgICAgICAgICBnbG9iYWw6
ICEwLAogICAgICAgICAgICAgICAgcHJvY2Vzc0RhdGE6ICEwLAogICAgICAgICAgICAgICAgYXN5
bmM6ICEwLAogICAgICAgICAgICAgICAgY29udGVudFR5cGU6ICJhcHBsaWNhdGlvbi94LXd3dy1m
b3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9VVRGLTgiLAogICAgICAgICAgICAgICAgYWNjZXB0czog
ewogICAgICAgICAgICAgICAgICAgICIqIjogTWUsCiAgICAgICAgICAgICAgICAgICAgdGV4dDog
InRleHQvcGxhaW4iLAogICAgICAgICAgICAgICAgICAgIGh0bWw6ICJ0ZXh0L2h0bWwiLAogICAg
ICAgICAgICAgICAgICAgIHhtbDogImFwcGxpY2F0aW9uL3htbCwgdGV4dC94bWwiLAogICAgICAg
ICAgICAgICAgICAgIGpzb246ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L2phdmFzY3JpcHQiCiAg
ICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgY29udGVudHM6IHsKICAgICAgICAgICAg
ICAgICAgICB4bWw6IC9cYnhtbFxiLywKICAgICAgICAgICAgICAgICAgICBodG1sOiAvXGJodG1s
LywKICAgICAgICAgICAgICAgICAgICBqc29uOiAvXGJqc29uXGIvCiAgICAgICAgICAgICAgICB9
LAogICAgICAgICAgICAgICAgcmVzcG9uc2VGaWVsZHM6IHsKICAgICAgICAgICAgICAgICAgICB4
bWw6ICJyZXNwb25zZVhNTCIsCiAgICAgICAgICAgICAgICAgICAgdGV4dDogInJlc3BvbnNlVGV4
dCIsCiAgICAgICAgICAgICAgICAgICAganNvbjogInJlc3BvbnNlSlNPTiIKICAgICAgICAgICAg
ICAgIH0sCiAgICAgICAgICAgICAgICBjb252ZXJ0ZXJzOiB7CiAgICAgICAgICAgICAgICAgICAg
IiogdGV4dCI6IFN0cmluZywKICAgICAgICAgICAgICAgICAgICAidGV4dCBodG1sIjogITAsCiAg
ICAgICAgICAgICAgICAgICAgInRleHQganNvbiI6IEpTT04ucGFyc2UsCiAgICAgICAgICAgICAg
ICAgICAgInRleHQgeG1sIjogZ3QucGFyc2VYTUwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAg
ICAgICAgICBmbGF0T3B0aW9uczogewogICAgICAgICAgICAgICAgICAgIHVybDogITAsCiAgICAg
ICAgICAgICAgICAgICAgY29udGV4dDogITAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg
fSwKICAgICAgICAgICAgYWpheFNldHVwOiBmdW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAgICAg
ICByZXR1cm4gZSA/IEsoSyh0LCBndC5hamF4U2V0dGluZ3MpLCBlKSA6IEsoZ3QuYWpheFNldHRp
bmdzLCB0KQogICAgICAgICAgICB9LAogICAgICAgICAgICBhamF4UHJlZmlsdGVyOiBHKERlKSwK
ICAgICAgICAgICAgYWpheFRyYW5zcG9ydDogRyhOZSksCiAgICAgICAgICAgIGFqYXg6IGZ1bmN0
aW9uKGUsIG4pIHsKICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGkoZSwgbiwgaSwgYSkgewogICAg
ICAgICAgICAgICAgICAgIHZhciBsLCBoLCBmLCBiLCBULCB3ID0gbjsKICAgICAgICAgICAgICAg
ICAgICBjIHx8IChjID0gITAsIHUgJiYgdC5jbGVhclRpbWVvdXQodSksIG8gPSB2b2lkIDAsIHMg
PSBhIHx8ICIiLCBDLnJlYWR5U3RhdGUgPSBlID4gMCA/IDQgOiAwLCBsID0gZSA+PSAyMDAgJiYg
ZSA8IDMwMCB8fCAzMDQgPT09IGUsIGkgJiYgKGIgPSBaKGQsIEMsIGkpKSwgYiA9IHR0KGQsIGIs
IEMsIGwpLCBsID8gKGQuaWZNb2RpZmllZCAmJiAoVCA9IEMuZ2V0UmVzcG9uc2VIZWFkZXIoIkxh
c3QtTW9kaWZpZWQiKSwgVCAmJiAoZ3QubGFzdE1vZGlmaWVkW3JdID0gVCksIChUID0gQy5nZXRS
ZXNwb25zZUhlYWRlcigiZXRhZyIpKSAmJiAoZ3QuZXRhZ1tyXSA9IFQpKSwgMjA0ID09PSBlIHx8
ICJIRUFEIiA9PT0gZC50eXBlID8gdyA9ICJub2NvbnRlbnQiIDogMzA0ID09PSBlID8gdyA9ICJu
b3Rtb2RpZmllZCIgOiAodyA9IGIuc3RhdGUsIGggPSBiLmRhdGEsIGYgPSBiLmVycm9yLCBsID0g
IWYpKSA6IChmID0gdywgIWUgJiYgdyB8fCAodyA9ICJlcnJvciIsIGUgPCAwICYmIChlID0gMCkp
KSwgQy5zdGF0dXMgPSBlLCBDLnN0YXR1c1RleHQgPSAobiB8fCB3KSArICIiLCBsID8gdi5yZXNv
bHZlV2l0aChnLCBbaCwgdywgQ10pIDogdi5yZWplY3RXaXRoKGcsIFtDLCB3LCBmXSksIEMuc3Rh
dHVzQ29kZSh4KSwgeCA9IHZvaWQgMCwgcCAmJiBtLnRyaWdnZXIobCA/ICJhamF4U3VjY2VzcyIg
OiAiYWpheEVycm9yIiwgW0MsIGQsIGwgPyBoIDogZl0pLCB5LmZpcmVXaXRoKGcsIFtDLCB3XSks
IHAgJiYgKG0udHJpZ2dlcigiYWpheENvbXBsZXRlIiwgW0MsIGRdKSwgLS1ndC5hY3RpdmUgfHwg
Z3QuZXZlbnQudHJpZ2dlcigiYWpheFN0b3AiKSkpCiAgICAgICAgICAgICAgICB9CiAgICAgICAg
ICAgICAgICAib2JqZWN0IiA9PSB0eXBlb2YgZSAmJiAobiA9IGUsIGUgPSB2b2lkIDApLCBuID0g
biB8fCB7fTsKICAgICAgICAgICAgICAgIHZhciBvLCByLCBzLCBhLCB1LCBsLCBjLCBwLCBoLCBm
LCBkID0gZ3QuYWpheFNldHVwKHt9LCBuKSwKICAgICAgICAgICAgICAgICAgICBnID0gZC5jb250
ZXh0IHx8IGQsCiAgICAgICAgICAgICAgICAgICAgbSA9IGQuY29udGV4dCAmJiAoZy5ub2RlVHlw
ZSB8fCBnLmpxdWVyeSkgPyBndChnKSA6IGd0LmV2ZW50LAogICAgICAgICAgICAgICAgICAgIHYg
PSBndC5EZWZlcnJlZCgpLAogICAgICAgICAgICAgICAgICAgIHkgPSBndC5DYWxsYmFja3MoIm9u
Y2UgbWVtb3J5IiksCiAgICAgICAgICAgICAgICAgICAgeCA9IGQuc3RhdHVzQ29kZSB8fCB7fSwK
ICAgICAgICAgICAgICAgICAgICBiID0ge30sCiAgICAgICAgICAgICAgICAgICAgVCA9IHt9LAog
ICAgICAgICAgICAgICAgICAgIHcgPSAiY2FuY2VsZWQiLAogICAgICAgICAgICAgICAgICAgIEMg
PSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlYWR5U3RhdGU6IDAsCiAgICAgICAgICAgICAg
ICAgICAgICAgIGdldFJlc3BvbnNlSGVhZGVyOiBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB2YXIgZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjKSB7
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhKQogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBmb3IgKGEgPSB7fTsgZSA9IEVlLmV4ZWMocyk7KSBhW2VbMV0u
dG9Mb3dlckNhc2UoKV0gPSBlWzJdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUg
PSBhW3QudG9Mb3dlckNhc2UoKV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsID09IGUgPyBudWxsIDogZQogICAgICAg
ICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBnZXRBbGxSZXNwb25z
ZUhlYWRlcnM6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJu
IGMgPyBzIDogbnVsbAogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAg
ICAgICAgICBzZXRSZXF1ZXN0SGVhZGVyOiBmdW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICByZXR1cm4gbnVsbCA9PSBjICYmICh0ID0gVFt0LnRvTG93ZXJDYXNlKCld
ID0gVFt0LnRvTG93ZXJDYXNlKCldIHx8IHQsIGJbdF0gPSBlKSwgdGhpcwogICAgICAgICAgICAg
ICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBvdmVycmlkZU1pbWVUeXBlOiBm
dW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbCA9PSBj
ICYmIChkLm1pbWVUeXBlID0gdCksIHRoaXMKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAg
ICAgICAgICAgICAgICAgICAgICAgc3RhdHVzQ29kZTogZnVuY3Rpb24odCkgewogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdmFyIGU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAo
dCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYykgQy5hbHdheXModFtDLnN0
YXR1c10pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChlIGluIHQpIHhbZV0gPSBbeFtlXSwgdFtlXV07
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcwogICAgICAgICAgICAgICAg
ICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBhYm9ydDogZnVuY3Rpb24odCkgewog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSB0IHx8IHc7CiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICByZXR1cm4gbyAmJiBvLmFib3J0KGUpLCBpKDAsIGUpLCB0aGlzCiAgICAg
ICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAg
ICAgaWYgKHYucHJvbWlzZShDKSwgZC51cmwgPSAoKGUgfHwgZC51cmwgfHwgeGUuaHJlZikgKyAi
IikucmVwbGFjZSgvXlwvXC8vLCB4ZS5wcm90b2NvbCArICIvLyIpLCBkLnR5cGUgPSBuLm1ldGhv
ZCB8fCBuLnR5cGUgfHwgZC5tZXRob2QgfHwgZC50eXBlLCBkLmRhdGFUeXBlcyA9IChkLmRhdGFU
eXBlIHx8ICIqIikudG9Mb3dlckNhc2UoKS5tYXRjaChrdCkgfHwgWyIiXSwgbnVsbCA9PSBkLmNy
b3NzRG9tYWluKSB7CiAgICAgICAgICAgICAgICAgICAgbCA9IG50LmNyZWF0ZUVsZW1lbnQoImEi
KTsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICBsLmhy
ZWYgPSBkLnVybCwgbC5ocmVmID0gbC5ocmVmLCBkLmNyb3NzRG9tYWluID0gamUucHJvdG9jb2wg
KyAiLy8iICsgamUuaG9zdCAhPSBsLnByb3RvY29sICsgIi8vIiArIGwuaG9zdAogICAgICAgICAg
ICAgICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZC5jcm9zc0Rv
bWFpbiA9ICEwCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAg
ICAgICAgICAgaWYgKGQuZGF0YSAmJiBkLnByb2Nlc3NEYXRhICYmICJzdHJpbmciICE9IHR5cGVv
ZiBkLmRhdGEgJiYgKGQuZGF0YSA9IGd0LnBhcmFtKGQuZGF0YSwgZC50cmFkaXRpb25hbCkpLCBK
KERlLCBkLCBuLCBDKSwgYykgcmV0dXJuIEM7CiAgICAgICAgICAgICAgICBwID0gZ3QuZXZlbnQg
JiYgZC5nbG9iYWwsIHAgJiYgMCA9PSBndC5hY3RpdmUrKyAmJiBndC5ldmVudC50cmlnZ2VyKCJh
amF4U3RhcnQiKSwgZC50eXBlID0gZC50eXBlLnRvVXBwZXJDYXNlKCksIGQuaGFzQ29udGVudCA9
ICFrZS50ZXN0KGQudHlwZSksIHIgPSBkLnVybC5yZXBsYWNlKC8jLiokLywgIiIpLCBkLmhhc0Nv
bnRlbnQgPyBkLmRhdGEgJiYgZC5wcm9jZXNzRGF0YSAmJiAwID09PSAoZC5jb250ZW50VHlwZSB8
fCAiIikuaW5kZXhPZigiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIikgJiYgKGQu
ZGF0YSA9IGQuZGF0YS5yZXBsYWNlKC8lMjAvZywgIisiKSkgOiAoZiA9IGQudXJsLnNsaWNlKHIu
bGVuZ3RoKSwgZC5kYXRhICYmIChyICs9IChUZS50ZXN0KHIpID8gIiYiIDogIj8iKSArIGQuZGF0
YSwgZGVsZXRlIGQuZGF0YSksICExID09PSBkLmNhY2hlICYmIChyID0gci5yZXBsYWNlKC8oWz8m
XSlfPVteJl0qLywgIiQxIiksIGYgPSAoVGUudGVzdChyKSA/ICImIiA6ICI/IikgKyAiXz0iICsg
YmUrKyArZiksIGQudXJsID0gciArIGYpLCBkLmlmTW9kaWZpZWQgJiYgKGd0Lmxhc3RNb2RpZmll
ZFtyXSAmJiBDLnNldFJlcXVlc3RIZWFkZXIoIklmLU1vZGlmaWVkLVNpbmNlIiwgZ3QubGFzdE1v
ZGlmaWVkW3JdKSwgZ3QuZXRhZ1tyXSAmJiBDLnNldFJlcXVlc3RIZWFkZXIoIklmLU5vbmUtTWF0
Y2giLCBndC5ldGFnW3JdKSksIChkLmRhdGEgJiYgZC5oYXNDb250ZW50ICYmICExICE9PSBkLmNv
bnRlbnRUeXBlIHx8IG4uY29udGVudFR5cGUpICYmIEMuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVu
dC1UeXBlIiwgZC5jb250ZW50VHlwZSksIEMuc2V0UmVxdWVzdEhlYWRlcigiQWNjZXB0IiwgZC5k
YXRhVHlwZXNbMF0gJiYgZC5hY2NlcHRzW2QuZGF0YVR5cGVzWzBdXSA/IGQuYWNjZXB0c1tkLmRh
dGFUeXBlc1swXV0gKyAoIioiICE9PSBkLmRhdGFUeXBlc1swXSA/ICIsICIgKyBNZSArICI7IHE9
MC4wMSIgOiAiIikgOiBkLmFjY2VwdHNbIioiXSk7CiAgICAgICAgICAgICAgICBmb3IgKGggaW4g
ZC5oZWFkZXJzKSBDLnNldFJlcXVlc3RIZWFkZXIoaCwgZC5oZWFkZXJzW2hdKTsKICAgICAgICAg
ICAgICAgIGlmIChkLmJlZm9yZVNlbmQgJiYgKCExID09PSBkLmJlZm9yZVNlbmQuY2FsbChnLCBD
LCBkKSB8fCBjKSkgcmV0dXJuIEMuYWJvcnQoKTsKICAgICAgICAgICAgICAgIGlmICh3ID0gImFi
b3J0IiwgeS5hZGQoZC5jb21wbGV0ZSksIEMuZG9uZShkLnN1Y2Nlc3MpLCBDLmZhaWwoZC5lcnJv
ciksIG8gPSBKKE5lLCBkLCBuLCBDKSkgewogICAgICAgICAgICAgICAgICAgIGlmIChDLnJlYWR5
U3RhdGUgPSAxLCBwICYmIG0udHJpZ2dlcigiYWpheFNlbmQiLCBbQywgZF0pLCBjKSByZXR1cm4g
QzsKICAgICAgICAgICAgICAgICAgICBkLmFzeW5jICYmIGQudGltZW91dCA+IDAgJiYgKHUgPSB0
LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIEMuYWJvcnQo
InRpbWVvdXQiKQogICAgICAgICAgICAgICAgICAgIH0sIGQudGltZW91dCkpOwogICAgICAgICAg
ICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSAhMSwgby5zZW5kKGIs
IGkpCiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgICAgICAgICAg
ICAgICBpZiAoYykgdGhyb3cgdDsKICAgICAgICAgICAgICAgICAgICAgICAgaSgtMSwgdCkKICAg
ICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgaSgtMSwgIk5vIFRyYW5z
cG9ydCIpOwogICAgICAgICAgICAgICAgcmV0dXJuIEMKICAgICAgICAgICAgfSwKICAgICAgICAg
ICAgZ2V0SlNPTjogZnVuY3Rpb24odCwgZSwgbikgewogICAgICAgICAgICAgICAgcmV0dXJuIGd0
LmdldCh0LCBlLCBuLCAianNvbiIpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGdldFNjcmlw
dDogZnVuY3Rpb24odCwgZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGd0LmdldCh0LCB2b2lk
IDAsIGUsICJzY3JpcHQiKQogICAgICAgICAgICB9CiAgICAgICAgfSksIGd0LmVhY2goWyJnZXQi
LCAicG9zdCJdLCBmdW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAgIGd0W2VdID0gZnVuY3Rpb24o
dCwgbiwgaSwgbykgewogICAgICAgICAgICAgICAgcmV0dXJuIGd0LmlzRnVuY3Rpb24obikgJiYg
KG8gPSBvIHx8IGksIGkgPSBuLCBuID0gdm9pZCAwKSwgZ3QuYWpheChndC5leHRlbmQoewogICAg
ICAgICAgICAgICAgICAgIHVybDogdCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiBlLAogICAg
ICAgICAgICAgICAgICAgIGRhdGFUeXBlOiBvLAogICAgICAgICAgICAgICAgICAgIGRhdGE6IG4s
CiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogaQogICAgICAgICAgICAgICAgfSwgZ3QuaXNQ
bGFpbk9iamVjdCh0KSAmJiB0KSkKICAgICAgICAgICAgfQogICAgICAgIH0pLCBndC5fZXZhbFVy
bCA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgcmV0dXJuIGd0LmFqYXgoewogICAgICAgICAg
ICAgICAgdXJsOiB0LAogICAgICAgICAgICAgICAgdHlwZTogIkdFVCIsCiAgICAgICAgICAgICAg
ICBkYXRhVHlwZTogInNjcmlwdCIsCiAgICAgICAgICAgICAgICBjYWNoZTogITAsCiAgICAgICAg
ICAgICAgICBhc3luYzogITEsCiAgICAgICAgICAgICAgICBnbG9iYWw6ICExLAogICAgICAgICAg
ICAgICAgdGhyb3dzOiAhMAogICAgICAgICAgICB9KQogICAgICAgIH0sIGd0LmZuLmV4dGVuZCh7
CiAgICAgICAgICAgIHdyYXBBbGw6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIHZhciBl
OwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbMF0gJiYgKGd0LmlzRnVuY3Rpb24odCkgJiYg
KHQgPSB0LmNhbGwodGhpc1swXSkpLCBlID0gZ3QodCwgdGhpc1swXS5vd25lckRvY3VtZW50KS5l
cSgwKS5jbG9uZSghMCksIHRoaXNbMF0ucGFyZW50Tm9kZSAmJiBlLmluc2VydEJlZm9yZSh0aGlz
WzBdKSwgZS5tYXAoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgdCA9
IHRoaXM7IHQuZmlyc3RFbGVtZW50Q2hpbGQ7KSB0ID0gdC5maXJzdEVsZW1lbnRDaGlsZDsKICAg
ICAgICAgICAgICAgICAgICByZXR1cm4gdAogICAgICAgICAgICAgICAgfSkuYXBwZW5kKHRoaXMp
KSwgdGhpcwogICAgICAgICAgICB9LAogICAgICAgICAgICB3cmFwSW5uZXI6IGZ1bmN0aW9uKHQp
IHsKICAgICAgICAgICAgICAgIHJldHVybiBndC5pc0Z1bmN0aW9uKHQpID8gdGhpcy5lYWNoKGZ1
bmN0aW9uKGUpIHsKICAgICAgICAgICAgICAgICAgICBndCh0aGlzKS53cmFwSW5uZXIodC5jYWxs
KHRoaXMsIGUpKQogICAgICAgICAgICAgICAgfSkgOiB0aGlzLmVhY2goZnVuY3Rpb24oKSB7CiAg
ICAgICAgICAgICAgICAgICAgdmFyIGUgPSBndCh0aGlzKSwKICAgICAgICAgICAgICAgICAgICAg
ICAgbiA9IGUuY29udGVudHMoKTsKICAgICAgICAgICAgICAgICAgICBuLmxlbmd0aCA/IG4ud3Jh
cEFsbCh0KSA6IGUuYXBwZW5kKHQpCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9LAog
ICAgICAgICAgICB3cmFwOiBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICB2YXIgZSA9IGd0
LmlzRnVuY3Rpb24odCk7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9u
KG4pIHsKICAgICAgICAgICAgICAgICAgICBndCh0aGlzKS53cmFwQWxsKGUgPyB0LmNhbGwodGhp
cywgbikgOiB0KQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfSwKICAgICAgICAgICAg
dW53cmFwOiBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnQo
dCkubm90KCJib2R5IikuZWFjaChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICBndCh0
aGlzKS5yZXBsYWNlV2l0aCh0aGlzLmNoaWxkTm9kZXMpCiAgICAgICAgICAgICAgICB9KSwgdGhp
cwogICAgICAgICAgICB9CiAgICAgICAgfSksIGd0LmV4cHIucHNldWRvcy5oaWRkZW4gPSBmdW5j
dGlvbih0KSB7CiAgICAgICAgICAgIHJldHVybiAhZ3QuZXhwci5wc2V1ZG9zLnZpc2libGUodCkK
ICAgICAgICB9LCBndC5leHByLnBzZXVkb3MudmlzaWJsZSA9IGZ1bmN0aW9uKHQpIHsKICAgICAg
ICAgICAgcmV0dXJuICEhKHQub2Zmc2V0V2lkdGggfHwgdC5vZmZzZXRIZWlnaHQgfHwgdC5nZXRD
bGllbnRSZWN0cygpLmxlbmd0aCkKICAgICAgICB9LCBndC5hamF4U2V0dGluZ3MueGhyID0gZnVu
Y3Rpb24oKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHQu
WE1MSHR0cFJlcXVlc3QKICAgICAgICAgICAgfSBjYXRjaCAodCkge30KICAgICAgICB9OwogICAg
ICAgIHZhciBMZSA9IHsKICAgICAgICAgICAgICAgIDA6IDIwMCwKICAgICAgICAgICAgICAgIDEy
MjM6IDIwNAogICAgICAgICAgICB9LAogICAgICAgICAgICAkZSA9IGd0LmFqYXhTZXR0aW5ncy54
aHIoKTsKICAgICAgICBmdC5jb3JzID0gISEkZSAmJiAid2l0aENyZWRlbnRpYWxzIiBpbiAkZSwg
ZnQuYWpheCA9ICRlID0gISEkZSwgZ3QuYWpheFRyYW5zcG9ydChmdW5jdGlvbihlKSB7CiAgICAg
ICAgICAgIHZhciBuLCBpOwogICAgICAgICAgICBpZiAoZnQuY29ycyB8fCAkZSAmJiAhZS5jcm9z
c0RvbWFpbikgcmV0dXJuIHsKICAgICAgICAgICAgICAgIHNlbmQ6IGZ1bmN0aW9uKG8sIHIpIHsK
ICAgICAgICAgICAgICAgICAgICB2YXIgcywgYSA9IGUueGhyKCk7CiAgICAgICAgICAgICAgICAg
ICAgaWYgKGEub3BlbihlLnR5cGUsIGUudXJsLCBlLmFzeW5jLCBlLnVzZXJuYW1lLCBlLnBhc3N3
b3JkKSwgZS54aHJGaWVsZHMpCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAocyBpbiBlLnho
ckZpZWxkcykgYVtzXSA9IGUueGhyRmllbGRzW3NdOwogICAgICAgICAgICAgICAgICAgIGUubWlt
ZVR5cGUgJiYgYS5vdmVycmlkZU1pbWVUeXBlICYmIGEub3ZlcnJpZGVNaW1lVHlwZShlLm1pbWVU
eXBlKSwgZS5jcm9zc0RvbWFpbiB8fCBvWyJYLVJlcXVlc3RlZC1XaXRoIl0gfHwgKG9bIlgtUmVx
dWVzdGVkLVdpdGgiXSA9ICJYTUxIdHRwUmVxdWVzdCIpOwogICAgICAgICAgICAgICAgICAgIGZv
ciAocyBpbiBvKSBhLnNldFJlcXVlc3RIZWFkZXIocywgb1tzXSk7CiAgICAgICAgICAgICAgICAg
ICAgbiA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0
aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbiAmJiAobiA9IGkgPSBhLm9ubG9h
ZCA9IGEub25lcnJvciA9IGEub25hYm9ydCA9IGEub25yZWFkeXN0YXRlY2hhbmdlID0gbnVsbCwg
ImFib3J0IiA9PT0gdCA/IGEuYWJvcnQoKSA6ICJlcnJvciIgPT09IHQgPyAibnVtYmVyIiAhPSB0
eXBlb2YgYS5zdGF0dXMgPyByKDAsICJlcnJvciIpIDogcihhLnN0YXR1cywgYS5zdGF0dXNUZXh0
KSA6IHIoTGVbYS5zdGF0dXNdIHx8IGEuc3RhdHVzLCBhLnN0YXR1c1RleHQsICJ0ZXh0IiAhPT0g
KGEucmVzcG9uc2VUeXBlIHx8ICJ0ZXh0IikgfHwgInN0cmluZyIgIT0gdHlwZW9mIGEucmVzcG9u
c2VUZXh0ID8gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpbmFyeTogYS5yZXNw
b25zZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSA6IHsKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB0ZXh0OiBhLnJlc3BvbnNlVGV4dAogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgfSwgYS5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSkpCiAgICAgICAgICAgICAgICAgICAg
ICAgIH0KICAgICAgICAgICAgICAgICAgICB9LCBhLm9ubG9hZCA9IG4oKSwgaSA9IGEub25lcnJv
ciA9IG4oImVycm9yIiksIHZvaWQgMCAhPT0gYS5vbmFib3J0ID8gYS5vbmFib3J0ID0gaSA6IGEu
b25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAg
IDQgPT09IGEucmVhZHlTdGF0ZSAmJiB0LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBuICYmIGkoKQogICAgICAgICAgICAgICAgICAgICAgICB9KQog
ICAgICAgICAgICAgICAgICAgIH0sIG4gPSBuKCJhYm9ydCIpOwogICAgICAgICAgICAgICAgICAg
IHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGEuc2VuZChlLmhhc0NvbnRlbnQgJiYgZS5k
YXRhIHx8IG51bGwpCiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAg
ICAgICAgICAgICAgICBpZiAobikgdGhyb3cgdAogICAgICAgICAgICAgICAgICAgIH0KICAgICAg
ICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBhYm9ydDogZnVuY3Rpb24oKSB7CiAgICAgICAg
ICAgICAgICAgICAgbiAmJiBuKCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAg
ICAgIH0pLCBndC5hamF4UHJlZmlsdGVyKGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgdC5jcm9z
c0RvbWFpbiAmJiAodC5jb250ZW50cy5zY3JpcHQgPSAhMSkKICAgICAgICB9KSwgZ3QuYWpheFNl
dHVwKHsKICAgICAgICAgICAgYWNjZXB0czogewogICAgICAgICAgICAgICAgc2NyaXB0OiAidGV4
dC9qYXZhc2NyaXB0LCBhcHBsaWNhdGlvbi9qYXZhc2NyaXB0LCBhcHBsaWNhdGlvbi9lY21hc2Ny
aXB0LCBhcHBsaWNhdGlvbi94LWVjbWFzY3JpcHQiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAg
IGNvbnRlbnRzOiB7CiAgICAgICAgICAgICAgICBzY3JpcHQ6IC9cYig/OmphdmF8ZWNtYSlzY3Jp
cHRcYi8KICAgICAgICAgICAgfSwKICAgICAgICAgICAgY29udmVydGVyczogewogICAgICAgICAg
ICAgICAgInRleHQgc2NyaXB0IjogZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgIHJl
dHVybiBndC5nbG9iYWxFdmFsKHQpLCB0CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0K
ICAgICAgICB9KSwgZ3QuYWpheFByZWZpbHRlcigic2NyaXB0IiwgZnVuY3Rpb24odCkgewogICAg
ICAgICAgICB2b2lkIDAgPT09IHQuY2FjaGUgJiYgKHQuY2FjaGUgPSAhMSksIHQuY3Jvc3NEb21h
aW4gJiYgKHQudHlwZSA9ICJHRVQiKQogICAgICAgIH0pLCBndC5hamF4VHJhbnNwb3J0KCJzY3Jp
cHQiLCBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgIGlmICh0LmNyb3NzRG9tYWluKSB7CiAgICAg
ICAgICAgICAgICB2YXIgZSwgbjsKICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAg
ICAgICAgICAgc2VuZDogZnVuY3Rpb24oaSwgbykgewogICAgICAgICAgICAgICAgICAgICAgICBl
ID0gZ3QoIjxzY3JpcHQ+IikucHJvcCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFy
c2V0OiB0LnNjcmlwdENoYXJzZXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcmM6IHQu
dXJsCiAgICAgICAgICAgICAgICAgICAgICAgIH0pLm9uKCJsb2FkIGVycm9yIiwgbiA9IGZ1bmN0
aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucmVtb3ZlKCksIG4gPSBudWxs
LCB0ICYmIG8oImVycm9yIiA9PT0gdC50eXBlID8gNDA0IDogMjAwLCB0LnR5cGUpCiAgICAgICAg
ICAgICAgICAgICAgICAgIH0pLCBudC5oZWFkLmFwcGVuZENoaWxkKGVbMF0pCiAgICAgICAgICAg
ICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBhYm9ydDogZnVuY3Rpb24oKSB7CiAgICAg
ICAgICAgICAgICAgICAgICAgIG4gJiYgbigpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAg
ICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgdmFyIFBlID0gW10s
CiAgICAgICAgICAgIHFlID0gLyg9KVw/KD89JnwkKXxcP1w/LzsKICAgICAgICBndC5hamF4U2V0
dXAoewogICAgICAgICAgICBqc29ucDogImNhbGxiYWNrIiwKICAgICAgICAgICAganNvbnBDYWxs
YmFjazogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB2YXIgdCA9IFBlLnBvcCgpIHx8IGd0
LmV4cGFuZG8gKyAiXyIgKyBiZSsrOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbdF0gPSAh
MCwgdAogICAgICAgICAgICB9CiAgICAgICAgfSksIGd0LmFqYXhQcmVmaWx0ZXIoImpzb24ganNv
bnAiLCBmdW5jdGlvbihlLCBuLCBpKSB7CiAgICAgICAgICAgIHZhciBvLCByLCBzLCBhID0gITEg
IT09IGUuanNvbnAgJiYgKHFlLnRlc3QoZS51cmwpID8gInVybCIgOiAic3RyaW5nIiA9PSB0eXBl
b2YgZS5kYXRhICYmIDAgPT09IChlLmNvbnRlbnRUeXBlIHx8ICIiKS5pbmRleE9mKCJhcHBsaWNh
dGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKSAmJiBxZS50ZXN0KGUuZGF0YSkgJiYgImRhdGEi
KTsKICAgICAgICAgICAgaWYgKGEgfHwgImpzb25wIiA9PT0gZS5kYXRhVHlwZXNbMF0pIHJldHVy
biBvID0gZS5qc29ucENhbGxiYWNrID0gZ3QuaXNGdW5jdGlvbihlLmpzb25wQ2FsbGJhY2spID8g
ZS5qc29ucENhbGxiYWNrKCkgOiBlLmpzb25wQ2FsbGJhY2ssIGEgPyBlW2FdID0gZVthXS5yZXBs
YWNlKHFlLCAiJDEiICsgbykgOiAhMSAhPT0gZS5qc29ucCAmJiAoZS51cmwgKz0gKFRlLnRlc3Qo
ZS51cmwpID8gIiYiIDogIj8iKSArIGUuanNvbnAgKyAiPSIgKyBvKSwgZS5jb252ZXJ0ZXJzWyJz
Y3JpcHQganNvbiJdID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gcyB8fCBn
dC5lcnJvcihvICsgIiB3YXMgbm90IGNhbGxlZCIpLCBzWzBdCiAgICAgICAgICAgIH0sIGUuZGF0
YVR5cGVzWzBdID0gImpzb24iLCByID0gdFtvXSwgdFtvXSA9IGZ1bmN0aW9uKCkgewogICAgICAg
ICAgICAgICAgcyA9IGFyZ3VtZW50cwogICAgICAgICAgICB9LCBpLmFsd2F5cyhmdW5jdGlvbigp
IHsKICAgICAgICAgICAgICAgIHZvaWQgMCA9PT0gciA/IGd0KHQpLnJlbW92ZVByb3AobykgOiB0
W29dID0gciwgZVtvXSAmJiAoZS5qc29ucENhbGxiYWNrID0gbi5qc29ucENhbGxiYWNrLCBQZS5w
dXNoKG8pKSwgcyAmJiBndC5pc0Z1bmN0aW9uKHIpICYmIHIoc1swXSksIHMgPSByID0gdm9pZCAw
CiAgICAgICAgICAgIH0pLCAic2NyaXB0IgogICAgICAgIH0pLCBmdC5jcmVhdGVIVE1MRG9jdW1l
bnQgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgdmFyIHQgPSBudC5pbXBsZW1lbnRhdGlvbi5j
cmVhdGVIVE1MRG9jdW1lbnQoIiIpLmJvZHk7CiAgICAgICAgICAgIHJldHVybiB0LmlubmVySFRN
TCA9ICI8Zm9ybT48L2Zvcm0+PGZvcm0+PC9mb3JtPiIsIDIgPT09IHQuY2hpbGROb2Rlcy5sZW5n
dGgKICAgICAgICB9KCksIGd0LnBhcnNlSFRNTCA9IGZ1bmN0aW9uKHQsIGUsIG4pIHsKICAgICAg
ICAgICAgaWYgKCJzdHJpbmciICE9IHR5cGVvZiB0KSByZXR1cm4gW107CiAgICAgICAgICAgICJi
b29sZWFuIiA9PSB0eXBlb2YgZSAmJiAobiA9IGUsIGUgPSAhMSk7CiAgICAgICAgICAgIHZhciBp
LCBvLCByOwogICAgICAgICAgICByZXR1cm4gZSB8fCAoZnQuY3JlYXRlSFRNTERvY3VtZW50ID8g
KGUgPSBudC5pbXBsZW1lbnRhdGlvbi5jcmVhdGVIVE1MRG9jdW1lbnQoIiIpLCBpID0gZS5jcmVh
dGVFbGVtZW50KCJiYXNlIiksIGkuaHJlZiA9IG50LmxvY2F0aW9uLmhyZWYsIGUuaGVhZC5hcHBl
bmRDaGlsZChpKSkgOiBlID0gbnQpLCBvID0gVHQuZXhlYyh0KSwgciA9ICFuICYmIFtdLCBvID8g
W2UuY3JlYXRlRWxlbWVudChvWzFdKV0gOiAobyA9IGIoW3RdLCBlLCByKSwgciAmJiByLmxlbmd0
aCAmJiBndChyKS5yZW1vdmUoKSwgZ3QubWVyZ2UoW10sIG8uY2hpbGROb2RlcykpCiAgICAgICAg
fSwgZ3QuZm4ubG9hZCA9IGZ1bmN0aW9uKHQsIGUsIG4pIHsKICAgICAgICAgICAgdmFyIGksIG8s
IHIsIHMgPSB0aGlzLAogICAgICAgICAgICAgICAgYSA9IHQuaW5kZXhPZigiICIpOwogICAgICAg
ICAgICByZXR1cm4gYSA+IC0xICYmIChpID0gVih0LnNsaWNlKGEpKSwgdCA9IHQuc2xpY2UoMCwg
YSkpLCBndC5pc0Z1bmN0aW9uKGUpID8gKG4gPSBlLCBlID0gdm9pZCAwKSA6IGUgJiYgIm9iamVj
dCIgPT0gdHlwZW9mIGUgJiYgKG8gPSAiUE9TVCIpLCBzLmxlbmd0aCA+IDAgJiYgZ3QuYWpheCh7
CiAgICAgICAgICAgICAgICB1cmw6IHQsCiAgICAgICAgICAgICAgICB0eXBlOiBvIHx8ICJHRVQi
LAogICAgICAgICAgICAgICAgZGF0YVR5cGU6ICJodG1sIiwKICAgICAgICAgICAgICAgIGRhdGE6
IGUKICAgICAgICAgICAgfSkuZG9uZShmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICByID0g
YXJndW1lbnRzLCBzLmh0bWwoaSA/IGd0KCI8ZGl2PiIpLmFwcGVuZChndC5wYXJzZUhUTUwodCkp
LmZpbmQoaSkgOiB0KQogICAgICAgICAgICB9KS5hbHdheXMobiAmJiBmdW5jdGlvbih0LCBlKSB7
CiAgICAgICAgICAgICAgICBzLmVhY2goZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAg
bi5hcHBseSh0aGlzLCByIHx8IFt0LnJlc3BvbnNlVGV4dCwgZSwgdF0pCiAgICAgICAgICAgICAg
ICB9KQogICAgICAgICAgICB9KSwgdGhpcwogICAgICAgIH0sIGd0LmVhY2goWyJhamF4U3RhcnQi
LCAiYWpheFN0b3AiLCAiYWpheENvbXBsZXRlIiwgImFqYXhFcnJvciIsICJhamF4U3VjY2VzcyIs
ICJhamF4U2VuZCJdLCBmdW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAgIGd0LmZuW2VdID0gZnVu
Y3Rpb24odCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMub24oZSwgdCkKICAgICAgICAg
ICAgfQogICAgICAgIH0pLCBndC5leHByLnBzZXVkb3MuYW5pbWF0ZWQgPSBmdW5jdGlvbih0KSB7
CiAgICAgICAgICAgIHJldHVybiBndC5ncmVwKGd0LnRpbWVycywgZnVuY3Rpb24oZSkgewogICAg
ICAgICAgICAgICAgcmV0dXJuIHQgPT09IGUuZWxlbQogICAgICAgICAgICB9KS5sZW5ndGgKICAg
ICAgICB9LCBndC5vZmZzZXQgPSB7CiAgICAgICAgICAgIHNldE9mZnNldDogZnVuY3Rpb24odCwg
ZSwgbikgewogICAgICAgICAgICAgICAgdmFyIGksIG8sIHIsIHMsIGEsIHUsIGwsIGMgPSBndC5j
c3ModCwgInBvc2l0aW9uIiksCiAgICAgICAgICAgICAgICAgICAgcCA9IGd0KHQpLAogICAgICAg
ICAgICAgICAgICAgIGggPSB7fTsKICAgICAgICAgICAgICAgICJzdGF0aWMiID09PSBjICYmICh0
LnN0eWxlLnBvc2l0aW9uID0gInJlbGF0aXZlIiksIGEgPSBwLm9mZnNldCgpLCByID0gZ3QuY3Nz
KHQsICJ0b3AiKSwgdSA9IGd0LmNzcyh0LCAibGVmdCIpLCBsID0gKCJhYnNvbHV0ZSIgPT09IGMg
fHwgImZpeGVkIiA9PT0gYykgJiYgKHIgKyB1KS5pbmRleE9mKCJhdXRvIikgPiAtMSwgbCA/IChp
ID0gcC5wb3NpdGlvbigpLCBzID0gaS50b3AsIG8gPSBpLmxlZnQpIDogKHMgPSBwYXJzZUZsb2F0
KHIpIHx8IDAsIG8gPSBwYXJzZUZsb2F0KHUpIHx8IDApLCBndC5pc0Z1bmN0aW9uKGUpICYmIChl
ID0gZS5jYWxsKHQsIG4sIGd0LmV4dGVuZCh7fSwgYSkpKSwgbnVsbCAhPSBlLnRvcCAmJiAoaC50
b3AgPSBlLnRvcCAtIGEudG9wICsgcyksIG51bGwgIT0gZS5sZWZ0ICYmIChoLmxlZnQgPSBlLmxl
ZnQgLSBhLmxlZnQgKyBvKSwgInVzaW5nIiBpbiBlID8gZS51c2luZy5jYWxsKHQsIGgpIDogcC5j
c3MoaCkKICAgICAgICAgICAgfQogICAgICAgIH0sIGd0LmZuLmV4dGVuZCh7CiAgICAgICAgICAg
IG9mZnNldDogZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5n
dGgpIHJldHVybiB2b2lkIDAgPT09IHQgPyB0aGlzIDogdGhpcy5lYWNoKGZ1bmN0aW9uKGUpIHsK
ICAgICAgICAgICAgICAgICAgICBndC5vZmZzZXQuc2V0T2Zmc2V0KHRoaXMsIHQsIGUpCiAgICAg
ICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHZhciBlLCBuLCBpLCBvLCByID0gdGhpc1sw
XTsKICAgICAgICAgICAgICAgIHJldHVybiByID8gci5nZXRDbGllbnRSZWN0cygpLmxlbmd0aCA/
IChpID0gci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSwgZSA9IHIub3duZXJEb2N1bWVudCwgbiA9
IGUuZG9jdW1lbnRFbGVtZW50LCBvID0gZS5kZWZhdWx0VmlldywgewogICAgICAgICAgICAgICAg
ICAgIHRvcDogaS50b3AgKyBvLnBhZ2VZT2Zmc2V0IC0gbi5jbGllbnRUb3AsCiAgICAgICAgICAg
ICAgICAgICAgbGVmdDogaS5sZWZ0ICsgby5wYWdlWE9mZnNldCAtIG4uY2xpZW50TGVmdAogICAg
ICAgICAgICAgICAgfSkgOiB7CiAgICAgICAgICAgICAgICAgICAgdG9wOiAwLAogICAgICAgICAg
ICAgICAgICAgIGxlZnQ6IDAKICAgICAgICAgICAgICAgIH0gOiB2b2lkIDAKICAgICAgICAgICAg
fSwKICAgICAgICAgICAgcG9zaXRpb246IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgaWYg
KHRoaXNbMF0pIHsKICAgICAgICAgICAgICAgICAgICB2YXIgdCwgZSwgbiA9IHRoaXNbMF0sCiAg
ICAgICAgICAgICAgICAgICAgICAgIGkgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0
b3A6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiAwCiAgICAgICAgICAgICAg
ICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJmaXhlZCIgPT09IGd0LmNz
cyhuLCAicG9zaXRpb24iKSA/IGUgPSBuLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpIDogKHQgPSB0
aGlzLm9mZnNldFBhcmVudCgpLCBlID0gdGhpcy5vZmZzZXQoKSwgbyh0WzBdLCAiaHRtbCIpIHx8
IChpID0gdC5vZmZzZXQoKSksIGkgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogaS50
b3AgKyBndC5jc3ModFswXSwgImJvcmRlclRvcFdpZHRoIiwgITApLAogICAgICAgICAgICAgICAg
ICAgICAgICBsZWZ0OiBpLmxlZnQgKyBndC5jc3ModFswXSwgImJvcmRlckxlZnRXaWR0aCIsICEw
KQogICAgICAgICAgICAgICAgICAgIH0pLCB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRvcDog
ZS50b3AgLSBpLnRvcCAtIGd0LmNzcyhuLCAibWFyZ2luVG9wIiwgITApLAogICAgICAgICAgICAg
ICAgICAgICAgICBsZWZ0OiBlLmxlZnQgLSBpLmxlZnQgLSBndC5jc3MobiwgIm1hcmdpbkxlZnQi
LCAhMCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg
IH0sCiAgICAgICAgICAgIG9mZnNldFBhcmVudDogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAg
ICByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yICh2
YXIgdCA9IHRoaXMub2Zmc2V0UGFyZW50OyB0ICYmICJzdGF0aWMiID09PSBndC5jc3ModCwgInBv
c2l0aW9uIik7KSB0ID0gdC5vZmZzZXRQYXJlbnQ7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJu
IHQgfHwgVnQKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICB9KSwgZ3Qu
ZWFjaCh7CiAgICAgICAgICAgIHNjcm9sbExlZnQ6ICJwYWdlWE9mZnNldCIsCiAgICAgICAgICAg
IHNjcm9sbFRvcDogInBhZ2VZT2Zmc2V0IgogICAgICAgIH0sIGZ1bmN0aW9uKHQsIGUpIHsKICAg
ICAgICAgICAgdmFyIG4gPSAicGFnZVlPZmZzZXQiID09PSBlOwogICAgICAgICAgICBndC5mblt0
XSA9IGZ1bmN0aW9uKGkpIHsKICAgICAgICAgICAgICAgIHJldHVybiBNdCh0aGlzLCBmdW5jdGlv
bih0LCBpLCBvKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHI7CiAgICAgICAgICAgICAgICAg
ICAgcmV0dXJuIGd0LmlzV2luZG93KHQpID8gciA9IHQgOiA5ID09PSB0Lm5vZGVUeXBlICYmIChy
ID0gdC5kZWZhdWx0VmlldyksIHZvaWQgMCA9PT0gbyA/IHIgPyByW2VdIDogdFtpXSA6IHZvaWQo
ciA/IHIuc2Nyb2xsVG8obiA/IHIucGFnZVhPZmZzZXQgOiBvLCBuID8gbyA6IHIucGFnZVlPZmZz
ZXQpIDogdFtpXSA9IG8pCiAgICAgICAgICAgICAgICB9LCB0LCBpLCBhcmd1bWVudHMubGVuZ3Ro
KQogICAgICAgICAgICB9CiAgICAgICAgfSksIGd0LmVhY2goWyJ0b3AiLCAibGVmdCJdLCBmdW5j
dGlvbih0LCBlKSB7CiAgICAgICAgICAgIGd0LmNzc0hvb2tzW2VdID0gJChmdC5waXhlbFBvc2l0
aW9uLCBmdW5jdGlvbih0LCBuKSB7CiAgICAgICAgICAgICAgICBpZiAobikgcmV0dXJuIG4gPSBM
KHQsIGUpLCBuZS50ZXN0KG4pID8gZ3QodCkucG9zaXRpb24oKVtlXSArICJweCIgOiBuCiAgICAg
ICAgICAgIH0pCiAgICAgICAgfSksIGd0LmVhY2goewogICAgICAgICAgICBIZWlnaHQ6ICJoZWln
aHQiLAogICAgICAgICAgICBXaWR0aDogIndpZHRoIgogICAgICAgIH0sIGZ1bmN0aW9uKHQsIGUp
IHsKICAgICAgICAgICAgZ3QuZWFjaCh7CiAgICAgICAgICAgICAgICBwYWRkaW5nOiAiaW5uZXIi
ICsgdCwKICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGUsCiAgICAgICAgICAgICAgICAiIjogIm91
dGVyIiArIHQKICAgICAgICAgICAgfSwgZnVuY3Rpb24obiwgaSkgewogICAgICAgICAgICAgICAg
Z3QuZm5baV0gPSBmdW5jdGlvbihvLCByKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHMgPSBh
cmd1bWVudHMubGVuZ3RoICYmIChuIHx8ICJib29sZWFuIiAhPSB0eXBlb2YgbyksCiAgICAgICAg
ICAgICAgICAgICAgICAgIGEgPSBuIHx8ICghMCA9PT0gbyB8fCAhMCA9PT0gciA/ICJtYXJnaW4i
IDogImJvcmRlciIpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBNdCh0aGlzLCBmdW5jdGlv
bihlLCBuLCBvKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByOwogICAgICAgICAgICAg
ICAgICAgICAgICByZXR1cm4gZ3QuaXNXaW5kb3coZSkgPyAwID09PSBpLmluZGV4T2YoIm91dGVy
IikgPyBlWyJpbm5lciIgKyB0XSA6IGUuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50WyJjbGllbnQi
ICsgdF0gOiA5ID09PSBlLm5vZGVUeXBlID8gKHIgPSBlLmRvY3VtZW50RWxlbWVudCwgTWF0aC5t
YXgoZS5ib2R5WyJzY3JvbGwiICsgdF0sIHJbInNjcm9sbCIgKyB0XSwgZS5ib2R5WyJvZmZzZXQi
ICsgdF0sIHJbIm9mZnNldCIgKyB0XSwgclsiY2xpZW50IiArIHRdKSkgOiB2b2lkIDAgPT09IG8g
PyBndC5jc3MoZSwgbiwgYSkgOiBndC5zdHlsZShlLCBuLCBvLCBhKQogICAgICAgICAgICAgICAg
ICAgIH0sIGUsIHMgPyBvIDogdm9pZCAwLCBzKQogICAgICAgICAgICAgICAgfQogICAgICAgICAg
ICB9KQogICAgICAgIH0pLCBndC5mbi5leHRlbmQoewogICAgICAgICAgICBiaW5kOiBmdW5jdGlv
bih0LCBlLCBuKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5vbih0LCBudWxsLCBlLCBu
KQogICAgICAgICAgICB9LAogICAgICAgICAgICB1bmJpbmQ6IGZ1bmN0aW9uKHQsIGUpIHsKICAg
ICAgICAgICAgICAgIHJldHVybiB0aGlzLm9mZih0LCBudWxsLCBlKQogICAgICAgICAgICB9LAog
ICAgICAgICAgICBkZWxlZ2F0ZTogZnVuY3Rpb24odCwgZSwgbiwgaSkgewogICAgICAgICAgICAg
ICAgcmV0dXJuIHRoaXMub24oZSwgdCwgbiwgaSkKICAgICAgICAgICAgfSwKICAgICAgICAgICAg
dW5kZWxlZ2F0ZTogZnVuY3Rpb24odCwgZSwgbikgewogICAgICAgICAgICAgICAgcmV0dXJuIDEg
PT09IGFyZ3VtZW50cy5sZW5ndGggPyB0aGlzLm9mZih0LCAiKioiKSA6IHRoaXMub2ZmKGUsIHQg
fHwgIioqIiwgbikKICAgICAgICAgICAgfQogICAgICAgIH0pLCBndC5ob2xkUmVhZHkgPSBmdW5j
dGlvbih0KSB7CiAgICAgICAgICAgIHQgPyBndC5yZWFkeVdhaXQrKyA6IGd0LnJlYWR5KCEwKQog
ICAgICAgIH0sIGd0LmlzQXJyYXkgPSBBcnJheS5pc0FycmF5LCBndC5wYXJzZUpTT04gPSBKU09O
LnBhcnNlLCBndC5ub2RlTmFtZSA9IG8sICJmdW5jdGlvbiIgPT0gdHlwZW9mIGRlZmluZSAmJiBk
ZWZpbmUuYW1kICYmIGRlZmluZSgianF1ZXJ5IiwgW10sIGZ1bmN0aW9uKCkgewogICAgICAgICAg
ICByZXR1cm4gZ3QKICAgICAgICB9KTsKICAgICAgICB2YXIgUmUgPSB0LmpRdWVyeSwKICAgICAg
ICAgICAgSWUgPSB0LiQ7CiAgICAgICAgcmV0dXJuIGd0Lm5vQ29uZmxpY3QgPSBmdW5jdGlvbihl
KSB7CiAgICAgICAgICAgIHJldHVybiB0LiQgPT09IGd0ICYmICh0LiQgPSBJZSksIGUgJiYgdC5q
UXVlcnkgPT09IGd0ICYmICh0LmpRdWVyeSA9IFJlKSwgZ3QKICAgICAgICB9LCBlIHx8ICh0LmpR
dWVyeSA9IHQuJCA9IGd0KSwgZ3QKICAgIH0pLAogICAgZnVuY3Rpb24odCwgZSkgewogICAgICAg
IGZ1bmN0aW9uIG4odCwgZSwgbikgewogICAgICAgICAgICB2YXIgaSA9IGNbZS50eXBlXSB8fCB7
fTsKICAgICAgICAgICAgcmV0dXJuIG51bGwgPT0gdCA/IG4gfHwgIWUuZGVmID8gbnVsbCA6IGUu
ZGVmIDogKHQgPSBpLmZsb29yID8gfn50IDogcGFyc2VGbG9hdCh0KSwgaXNOYU4odCkgPyBlLmRl
ZiA6IGkubW9kID8gKHQgKyBpLm1vZCkgJSBpLm1vZCA6IDAgPiB0ID8gMCA6IGkubWF4IDwgdCA/
IGkubWF4IDogdCkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGkoZSkgewogICAgICAgICAg
ICB2YXIgbiA9IHUoKSwKICAgICAgICAgICAgICAgIGkgPSBuLl9yZ2JhID0gW107CiAgICAgICAg
ICAgIHJldHVybiBlID0gZS50b0xvd2VyQ2FzZSgpLCBmKGEsIGZ1bmN0aW9uKHQsIG8pIHsKICAg
ICAgICAgICAgICAgIHZhciByLCBzID0gby5yZS5leGVjKGUpLAogICAgICAgICAgICAgICAgICAg
IGEgPSBzICYmIG8ucGFyc2UocyksCiAgICAgICAgICAgICAgICAgICAgdSA9IG8uc3BhY2UgfHwg
InJnYmEiOwogICAgICAgICAgICAgICAgaWYgKGEpIHJldHVybiByID0gblt1XShhKSwgbltsW3Vd
LmNhY2hlXSA9IHJbbFt1XS5jYWNoZV0sIGkgPSBuLl9yZ2JhID0gci5fcmdiYSwgITEKICAgICAg
ICAgICAgfSksIGkubGVuZ3RoID8gKCIwLDAsMCwwIiA9PT0gaS5qb2luKCkgJiYgdC5leHRlbmQo
aSwgci50cmFuc3BhcmVudCksIG4pIDogcltlXQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24g
byh0LCBlLCBuKSB7CiAgICAgICAgICAgIHJldHVybiBuID0gKG4gKyAxKSAlIDEsIDYgKiBuIDwg
MSA/IHQgKyAoZSAtIHQpICogbiAqIDYgOiAyICogbiA8IDEgPyBlIDogMyAqIG4gPCAyID8gdCAr
IChlIC0gdCkgKiAoMiAvIDMgLSBuKSAqIDYgOiB0CiAgICAgICAgfQogICAgICAgIHZhciByLCBz
ID0gL14oW1wtK10pPVxzKihcZCtcLj9cZCopLywKICAgICAgICAgICAgYSA9IFt7CiAgICAgICAg
ICAgICAgICByZTogL3JnYmE/XChccyooXGR7MSwzfSlccyosXHMqKFxkezEsM30pXHMqLFxzKihc
ZHsxLDN9KVxzKig/OixccyooXGQ/KD86XC5cZCspPylccyopP1wpLywKICAgICAgICAgICAgICAg
IHBhcnNlOiBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFt0WzFdLCB0
WzJdLCB0WzNdLCB0WzRdXQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCB7CiAgICAg
ICAgICAgICAgICByZTogL3JnYmE/XChccyooXGQrKD86XC5cZCspPylcJVxzKixccyooXGQrKD86
XC5cZCspPylcJVxzKixccyooXGQrKD86XC5cZCspPylcJVxzKig/OixccyooXGQ/KD86XC5cZCsp
PylccyopP1wpLywKICAgICAgICAgICAgICAgIHBhcnNlOiBmdW5jdGlvbih0KSB7CiAgICAgICAg
ICAgICAgICAgICAgcmV0dXJuIFsyLjU1ICogdFsxXSwgMi41NSAqIHRbMl0sIDIuNTUgKiB0WzNd
LCB0WzRdXQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAg
ICByZTogLyMoW2EtZjAtOV17Mn0pKFthLWYwLTldezJ9KShbYS1mMC05XXsyfSkvLAogICAgICAg
ICAgICAgICAgcGFyc2U6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4g
W3BhcnNlSW50KHRbMV0sIDE2KSwgcGFyc2VJbnQodFsyXSwgMTYpLCBwYXJzZUludCh0WzNdLCAx
NildCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHJl
OiAvIyhbYS1mMC05XSkoW2EtZjAtOV0pKFthLWYwLTldKS8sCiAgICAgICAgICAgICAgICBwYXJz
ZTogZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBbcGFyc2VJbnQodFsx
XSArIHRbMV0sIDE2KSwgcGFyc2VJbnQodFsyXSArIHRbMl0sIDE2KSwgcGFyc2VJbnQodFszXSAr
IHRbM10sIDE2KV0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgewogICAgICAgICAg
ICAgICAgcmU6IC9oc2xhP1woXHMqKFxkKyg/OlwuXGQrKT8pXHMqLFxzKihcZCsoPzpcLlxkKyk/
KVwlXHMqLFxzKihcZCsoPzpcLlxkKyk/KVwlXHMqKD86LFxzKihcZD8oPzpcLlxkKyk/KVxzKik/
XCkvLAogICAgICAgICAgICAgICAgc3BhY2U6ICJoc2xhIiwKICAgICAgICAgICAgICAgIHBhcnNl
OiBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFt0WzFdLCB0WzJdIC8g
MTAwLCB0WzNdIC8gMTAwLCB0WzRdXQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9XSwK
ICAgICAgICAgICAgdSA9IHQuQ29sb3IgPSBmdW5jdGlvbihlLCBuLCBpLCBvKSB7CiAgICAgICAg
ICAgICAgICByZXR1cm4gbmV3IHQuQ29sb3IuZm4ucGFyc2UoZSwgbiwgaSwgbykKICAgICAgICAg
ICAgfSwKICAgICAgICAgICAgbCA9IHsKICAgICAgICAgICAgICAgIHJnYmE6IHsKICAgICAgICAg
ICAgICAgICAgICBwcm9wczogewogICAgICAgICAgICAgICAgICAgICAgICByZWQ6IHsKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGlkeDogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHR5cGU6ICJieXRlIgogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAg
ICAgICAgICBncmVlbjogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWR4OiAxLAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogImJ5dGUiCiAgICAgICAgICAgICAgICAgICAg
ICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIGJsdWU6IHsKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGlkeDogMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJieXRl
IgogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAg
ICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGhzbGE6IHsKICAgICAgICAgICAgICAgICAgICBw
cm9wczogewogICAgICAgICAgICAgICAgICAgICAgICBodWU6IHsKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGlkeDogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJkZWdy
ZWVzIgogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBz
YXR1cmF0aW9uOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZHg6IDEsCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB0eXBlOiAicGVyY2VudCIKICAgICAgICAgICAgICAgICAgICAg
ICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgbGlnaHRuZXNzOiB7CiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBpZHg6IDIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAi
cGVyY2VudCIKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0K
ICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgYyA9IHsKICAgICAg
ICAgICAgICAgIGJ5dGU6IHsKICAgICAgICAgICAgICAgICAgICBmbG9vcjogITAsCiAgICAgICAg
ICAgICAgICAgICAgbWF4OiAyNTUKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBw
ZXJjZW50OiB7CiAgICAgICAgICAgICAgICAgICAgbWF4OiAxCiAgICAgICAgICAgICAgICB9LAog
ICAgICAgICAgICAgICAgZGVncmVlczogewogICAgICAgICAgICAgICAgICAgIG1vZDogMzYwLAog
ICAgICAgICAgICAgICAgICAgIGZsb29yOiAhMAogICAgICAgICAgICAgICAgfQogICAgICAgICAg
ICB9LAogICAgICAgICAgICBwID0gdS5zdXBwb3J0ID0ge30sCiAgICAgICAgICAgIGggPSB0KCI8
cD4iKVswXSwKICAgICAgICAgICAgZiA9IHQuZWFjaDsKICAgICAgICBoLnN0eWxlLmNzc1RleHQg
PSAiYmFja2dyb3VuZC1jb2xvcjpyZ2JhKDEsMSwxLC41KSIsIHAucmdiYSA9IGguc3R5bGUuYmFj
a2dyb3VuZENvbG9yLmluZGV4T2YoInJnYmEiKSA+IC0xLCBmKGwsIGZ1bmN0aW9uKHQsIGUpIHsK
ICAgICAgICAgICAgZS5jYWNoZSA9ICJfIiArIHQsIGUucHJvcHMuYWxwaGEgPSB7CiAgICAgICAg
ICAgICAgICBpZHg6IDMsCiAgICAgICAgICAgICAgICB0eXBlOiAicGVyY2VudCIsCiAgICAgICAg
ICAgICAgICBkZWY6IDEKICAgICAgICAgICAgfQogICAgICAgIH0pLCB1LmZuID0gdC5leHRlbmQo
dS5wcm90b3R5cGUsIHsKICAgICAgICAgICAgcGFyc2U6IGZ1bmN0aW9uKG8sIHMsIGEsIGMpIHsK
ICAgICAgICAgICAgICAgIGlmIChvID09PSBlKSByZXR1cm4gdGhpcy5fcmdiYSA9IFtudWxsLCBu
dWxsLCBudWxsLCBudWxsXSwgdGhpczsKICAgICAgICAgICAgICAgIChvLmpxdWVyeSB8fCBvLm5v
ZGVUeXBlKSAmJiAobyA9IHQobykuY3NzKHMpLCBzID0gZSk7CiAgICAgICAgICAgICAgICB2YXIg
cCA9IHRoaXMsCiAgICAgICAgICAgICAgICAgICAgaCA9IHQudHlwZShvKSwKICAgICAgICAgICAg
ICAgICAgICBkID0gdGhpcy5fcmdiYSA9IFtdOwogICAgICAgICAgICAgICAgcmV0dXJuIHMgIT09
IGUgJiYgKG8gPSBbbywgcywgYSwgY10sIGggPSAiYXJyYXkiKSwgInN0cmluZyIgPT09IGggPyB0
aGlzLnBhcnNlKGkobykgfHwgci5fZGVmYXVsdCkgOiAiYXJyYXkiID09PSBoID8gKGYobC5yZ2Jh
LnByb3BzLCBmdW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAgICAgICAgICAgZFtlLmlkeF0gPSBu
KG9bZS5pZHhdLCBlKQogICAgICAgICAgICAgICAgfSksIHRoaXMpIDogIm9iamVjdCIgPT09IGgg
PyAobyBpbnN0YW5jZW9mIHUgPyBmKGwsIGZ1bmN0aW9uKHQsIGUpIHsKICAgICAgICAgICAgICAg
ICAgICBvW2UuY2FjaGVdICYmIChwW2UuY2FjaGVdID0gb1tlLmNhY2hlXS5zbGljZSgpKQogICAg
ICAgICAgICAgICAgfSkgOiBmKGwsIGZ1bmN0aW9uKGUsIGkpIHsKICAgICAgICAgICAgICAgICAg
ICB2YXIgciA9IGkuY2FjaGU7CiAgICAgICAgICAgICAgICAgICAgZihpLnByb3BzLCBmdW5jdGlv
bih0LCBlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcFtyXSAmJiBpLnRvKSB7CiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoImFscGhhIiA9PT0gdCB8fCBudWxsID09IG9b
dF0pIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBbcl0gPSBpLnRvKHAuX3Jn
YmEpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgcFty
XVtlLmlkeF0gPSBuKG9bdF0sIGUsICEwKQogICAgICAgICAgICAgICAgICAgIH0pLCBwW3JdICYm
IHQuaW5BcnJheShudWxsLCBwW3JdLnNsaWNlKDAsIDMpKSA8IDAgJiYgKHBbcl1bM10gPSAxLCBp
LmZyb20gJiYgKHAuX3JnYmEgPSBpLmZyb20ocFtyXSkpKQogICAgICAgICAgICAgICAgfSksIHRo
aXMpIDogdm9pZCAwCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGlzOiBmdW5jdGlvbih0KSB7
CiAgICAgICAgICAgICAgICB2YXIgZSA9IHUodCksCiAgICAgICAgICAgICAgICAgICAgbiA9ICEw
LAogICAgICAgICAgICAgICAgICAgIGkgPSB0aGlzOwogICAgICAgICAgICAgICAgcmV0dXJuIGYo
bCwgZnVuY3Rpb24odCwgbykgewogICAgICAgICAgICAgICAgICAgIHZhciByLCBzID0gZVtvLmNh
Y2hlXTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcyAmJiAociA9IGlbby5jYWNoZV0gfHwg
by50byAmJiBvLnRvKGkuX3JnYmEpIHx8IFtdLCBmKG8ucHJvcHMsIGZ1bmN0aW9uKHQsIGUpIHsK
ICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgIT0gc1tlLmlkeF0pIHJldHVybiBuID0g
c1tlLmlkeF0gPT09IHJbZS5pZHhdCiAgICAgICAgICAgICAgICAgICAgfSkpLCBuCiAgICAgICAg
ICAgICAgICB9KSwgbgogICAgICAgICAgICB9LAogICAgICAgICAgICBfc3BhY2U6IGZ1bmN0aW9u
KCkgewogICAgICAgICAgICAgICAgdmFyIHQgPSBbXSwKICAgICAgICAgICAgICAgICAgICBlID0g
dGhpczsKICAgICAgICAgICAgICAgIHJldHVybiBmKGwsIGZ1bmN0aW9uKG4sIGkpIHsKICAgICAg
ICAgICAgICAgICAgICBlW2kuY2FjaGVdICYmIHQucHVzaChuKQogICAgICAgICAgICAgICAgfSks
IHQucG9wKCkKICAgICAgICAgICAgfSwKICAgICAgICAgICAgdHJhbnNpdGlvbjogZnVuY3Rpb24o
dCwgZSkgewogICAgICAgICAgICAgICAgdmFyIGkgPSB1KHQpLAogICAgICAgICAgICAgICAgICAg
IG8gPSBpLl9zcGFjZSgpLAogICAgICAgICAgICAgICAgICAgIHIgPSBsW29dLAogICAgICAgICAg
ICAgICAgICAgIHMgPSAwID09PSB0aGlzLmFscGhhKCkgPyB1KCJ0cmFuc3BhcmVudCIpIDogdGhp
cywKICAgICAgICAgICAgICAgICAgICBhID0gc1tyLmNhY2hlXSB8fCByLnRvKHMuX3JnYmEpLAog
ICAgICAgICAgICAgICAgICAgIHAgPSBhLnNsaWNlKCk7CiAgICAgICAgICAgICAgICByZXR1cm4g
aSA9IGlbci5jYWNoZV0sIGYoci5wcm9wcywgZnVuY3Rpb24odCwgbykgewogICAgICAgICAgICAg
ICAgICAgIHZhciByID0gby5pZHgsCiAgICAgICAgICAgICAgICAgICAgICAgIHMgPSBhW3JdLAog
ICAgICAgICAgICAgICAgICAgICAgICB1ID0gaVtyXSwKICAgICAgICAgICAgICAgICAgICAgICAg
bCA9IGNbby50eXBlXSB8fCB7fTsKICAgICAgICAgICAgICAgICAgICBudWxsICE9PSB1ICYmIChu
dWxsID09PSBzID8gcFtyXSA9IHUgOiAobC5tb2QgJiYgKHUgLSBzID4gbC5tb2QgLyAyID8gcyAr
PSBsLm1vZCA6IHMgLSB1ID4gbC5tb2QgLyAyICYmIChzIC09IGwubW9kKSksIHBbcl0gPSBuKCh1
IC0gcykgKiBlICsgcywgbykpKQogICAgICAgICAgICAgICAgfSksIHRoaXNbb10ocCkKICAgICAg
ICAgICAgfSwKICAgICAgICAgICAgYmxlbmQ6IGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgICAg
IGlmICgxID09PSB0aGlzLl9yZ2JhWzNdKSByZXR1cm4gdGhpczsKICAgICAgICAgICAgICAgIHZh
ciBuID0gdGhpcy5fcmdiYS5zbGljZSgpLAogICAgICAgICAgICAgICAgICAgIGkgPSBuLnBvcCgp
LAogICAgICAgICAgICAgICAgICAgIG8gPSB1KGUpLl9yZ2JhOwogICAgICAgICAgICAgICAgcmV0
dXJuIHUodC5tYXAobiwgZnVuY3Rpb24odCwgZSkgewogICAgICAgICAgICAgICAgICAgIHJldHVy
biAoMSAtIGkpICogb1tlXSArIGkgKiB0CiAgICAgICAgICAgICAgICB9KSkKICAgICAgICAgICAg
fSwKICAgICAgICAgICAgdG9SZ2JhU3RyaW5nOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAg
IHZhciBlID0gInJnYmEoIiwKICAgICAgICAgICAgICAgICAgICBuID0gdC5tYXAodGhpcy5fcmdi
YSwgZnVuY3Rpb24odCwgZSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbCA9
PSB0ID8gZSA+IDIgPyAxIDogMCA6IHQKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAg
ICAgICAgIHJldHVybiAxID09PSBuWzNdICYmIChuLnBvcCgpLCBlID0gInJnYigiKSwgZSArIG4u
am9pbigpICsgIikiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHRvSHNsYVN0cmluZzogZnVu
Y3Rpb24oKSB7CiAgICAgICAgICAgICAgICB2YXIgZSA9ICJoc2xhKCIsCiAgICAgICAgICAgICAg
ICAgICAgbiA9IHQubWFwKHRoaXMuaHNsYSgpLCBmdW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAg
ICAgICAgICAgICAgIHJldHVybiBudWxsID09IHQgJiYgKHQgPSBlID4gMiA/IDEgOiAwKSwgZSAm
JiBlIDwgMyAmJiAodCA9IE1hdGgucm91bmQoMTAwICogdCkgKyAiJSIpLCB0CiAgICAgICAgICAg
ICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm4gMSA9PT0gblszXSAmJiAobi5wb3Ao
KSwgZSA9ICJoc2woIiksIGUgKyBuLmpvaW4oKSArICIpIgogICAgICAgICAgICB9LAogICAgICAg
ICAgICB0b0hleFN0cmluZzogZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgICAgdmFyIG4gPSB0
aGlzLl9yZ2JhLnNsaWNlKCksCiAgICAgICAgICAgICAgICAgICAgaSA9IG4ucG9wKCk7CiAgICAg
ICAgICAgICAgICByZXR1cm4gZSAmJiBuLnB1c2gofn4oMjU1ICogaSkpLCAiIyIgKyB0Lm1hcChu
LCBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQgPSAodCB8fCAwKS50
b1N0cmluZygxNiksIDEgPT09IHQubGVuZ3RoID8gIjAiICsgdCA6IHQKICAgICAgICAgICAgICAg
IH0pLmpvaW4oIiIpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHRvU3RyaW5nOiBmdW5jdGlv
bigpIHsKICAgICAgICAgICAgICAgIHJldHVybiAwID09PSB0aGlzLl9yZ2JhWzNdID8gInRyYW5z
cGFyZW50IiA6IHRoaXMudG9SZ2JhU3RyaW5nKCkKICAgICAgICAgICAgfQogICAgICAgIH0pLCB1
LmZuLnBhcnNlLnByb3RvdHlwZSA9IHUuZm4sIGwuaHNsYS50byA9IGZ1bmN0aW9uKHQpIHsKICAg
ICAgICAgICAgaWYgKG51bGwgPT0gdFswXSB8fCBudWxsID09IHRbMV0gfHwgbnVsbCA9PSB0WzJd
KSByZXR1cm4gW251bGwsIG51bGwsIG51bGwsIHRbM11dOwogICAgICAgICAgICB2YXIgZSwgbiwg
aSA9IHRbMF0gLyAyNTUsCiAgICAgICAgICAgICAgICBvID0gdFsxXSAvIDI1NSwKICAgICAgICAg
ICAgICAgIHIgPSB0WzJdIC8gMjU1LAogICAgICAgICAgICAgICAgcyA9IHRbM10sCiAgICAgICAg
ICAgICAgICBhID0gTWF0aC5tYXgoaSwgbywgciksCiAgICAgICAgICAgICAgICB1ID0gTWF0aC5t
aW4oaSwgbywgciksCiAgICAgICAgICAgICAgICBsID0gYSAtIHUsCiAgICAgICAgICAgICAgICBj
ID0gYSArIHUsCiAgICAgICAgICAgICAgICBwID0gLjUgKiBjOwogICAgICAgICAgICByZXR1cm4g
ZSA9IHUgPT09IGEgPyAwIDogaSA9PT0gYSA/IDYwICogKG8gLSByKSAvIGwgKyAzNjAgOiBvID09
PSBhID8gNjAgKiAociAtIGkpIC8gbCArIDEyMCA6IDYwICogKGkgLSBvKSAvIGwgKyAyNDAsIG4g
PSAwID09PSBsID8gMCA6IHAgPD0gLjUgPyBsIC8gYyA6IGwgLyAoMiAtIGMpLCBbTWF0aC5yb3Vu
ZChlKSAlIDM2MCwgbiwgcCwgbnVsbCA9PSBzID8gMSA6IHNdCiAgICAgICAgfSwgbC5oc2xhLmZy
b20gPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgIGlmIChudWxsID09IHRbMF0gfHwgbnVsbCA9
PSB0WzFdIHx8IG51bGwgPT0gdFsyXSkgcmV0dXJuIFtudWxsLCBudWxsLCBudWxsLCB0WzNdXTsK
ICAgICAgICAgICAgdmFyIGUgPSB0WzBdIC8gMzYwLAogICAgICAgICAgICAgICAgbiA9IHRbMV0s
CiAgICAgICAgICAgICAgICBpID0gdFsyXSwKICAgICAgICAgICAgICAgIHIgPSB0WzNdLAogICAg
ICAgICAgICAgICAgcyA9IGkgPD0gLjUgPyBpICogKDEgKyBuKSA6IGkgKyBuIC0gaSAqIG4sCiAg
ICAgICAgICAgICAgICBhID0gMiAqIGkgLSBzOwogICAgICAgICAgICByZXR1cm4gW01hdGgucm91
bmQoMjU1ICogbyhhLCBzLCBlICsgMSAvIDMpKSwgTWF0aC5yb3VuZCgyNTUgKiBvKGEsIHMsIGUp
KSwgTWF0aC5yb3VuZCgyNTUgKiBvKGEsIHMsIGUgLSAxIC8gMykpLCByXQogICAgICAgIH0sIGYo
bCwgZnVuY3Rpb24oaSwgbykgewogICAgICAgICAgICB2YXIgciA9IG8ucHJvcHMsCiAgICAgICAg
ICAgICAgICBhID0gby5jYWNoZSwKICAgICAgICAgICAgICAgIGwgPSBvLnRvLAogICAgICAgICAg
ICAgICAgYyA9IG8uZnJvbTsKICAgICAgICAgICAgdS5mbltpXSA9IGZ1bmN0aW9uKGkpIHsKICAg
ICAgICAgICAgICAgIGlmIChsICYmICF0aGlzW2FdICYmICh0aGlzW2FdID0gbCh0aGlzLl9yZ2Jh
KSksIGkgPT09IGUpIHJldHVybiB0aGlzW2FdLnNsaWNlKCk7CiAgICAgICAgICAgICAgICB2YXIg
bywgcyA9IHQudHlwZShpKSwKICAgICAgICAgICAgICAgICAgICBwID0gImFycmF5IiA9PT0gcyB8
fCAib2JqZWN0IiA9PT0gcyA/IGkgOiBhcmd1bWVudHMsCiAgICAgICAgICAgICAgICAgICAgaCA9
IHRoaXNbYV0uc2xpY2UoKTsKICAgICAgICAgICAgICAgIHJldHVybiBmKHIsIGZ1bmN0aW9uKHQs
IGUpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IHBbIm9iamVjdCIgPT09IHMgPyB0IDog
ZS5pZHhdOwogICAgICAgICAgICAgICAgICAgIG51bGwgPT0gaSAmJiAoaSA9IGhbZS5pZHhdKSwg
aFtlLmlkeF0gPSBuKGksIGUpCiAgICAgICAgICAgICAgICB9KSwgYyA/IChvID0gdShjKGgpKSwg
b1thXSA9IGgsIG8pIDogdShoKQogICAgICAgICAgICB9LCBmKHIsIGZ1bmN0aW9uKGUsIG4pIHsK
ICAgICAgICAgICAgICAgIHUuZm5bZV0gfHwgKHUuZm5bZV0gPSBmdW5jdGlvbihvKSB7CiAgICAg
ICAgICAgICAgICAgICAgdmFyIHIsIGEgPSB0LnR5cGUobyksCiAgICAgICAgICAgICAgICAgICAg
ICAgIHUgPSAiYWxwaGEiID09PSBlID8gdGhpcy5faHNsYSA/ICJoc2xhIiA6ICJyZ2JhIiA6IGks
CiAgICAgICAgICAgICAgICAgICAgICAgIGwgPSB0aGlzW3VdKCksCiAgICAgICAgICAgICAgICAg
ICAgICAgIGMgPSBsW24uaWR4XTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gInVuZGVmaW5l
ZCIgPT09IGEgPyBjIDogKCJmdW5jdGlvbiIgPT09IGEgJiYgKG8gPSBvLmNhbGwodGhpcywgYyks
IGEgPSB0LnR5cGUobykpLCBudWxsID09IG8gJiYgbi5lbXB0eSA/IHRoaXMgOiAoInN0cmluZyIg
PT09IGEgJiYgKHIgPSBzLmV4ZWMobykpICYmIChvID0gYyArIHBhcnNlRmxvYXQoclsyXSkgKiAo
IisiID09PSByWzFdID8gMSA6IC0xKSksIGxbbi5pZHhdID0gbywgdGhpc1t1XShsKSkpCiAgICAg
ICAgICAgICAgICB9KQogICAgICAgICAgICB9KQogICAgICAgIH0pLCB1Lmhvb2sgPSBmdW5jdGlv
bihlKSB7CiAgICAgICAgICAgIHZhciBuID0gZS5zcGxpdCgiICIpOwogICAgICAgICAgICBmKG4s
IGZ1bmN0aW9uKGUsIG4pIHsKICAgICAgICAgICAgICAgIHQuY3NzSG9va3Nbbl0gPSB7CiAgICAg
ICAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbihlLCBvKSB7CiAgICAgICAgICAgICAgICAgICAg
ICAgIHZhciByLCBzLCBhID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgidHJhbnNw
YXJlbnQiICE9PSBvICYmICgic3RyaW5nIiAhPT0gdC50eXBlKG8pIHx8IChyID0gaShvKSkpKSB7
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobyA9IHUociB8fCBvKSwgIXAucmdiYSAm
JiAxICE9PSBvLl9yZ2JhWzNdKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9y
IChzID0gImJhY2tncm91bmRDb2xvciIgPT09IG4gPyBlLnBhcmVudE5vZGUgOiBlOwogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoIiIgPT09IGEgfHwgInRyYW5zcGFyZW50IiA9
PT0gYSkgJiYgcyAmJiBzLnN0eWxlOykgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgYSA9IHQuY3NzKHMsICJiYWNrZ3JvdW5kQ29sb3IiKSwgcyA9IHMucGFyZW50Tm9k
ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHt9CiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgbyA9IG8uYmxlbmQoYSAmJiAidHJhbnNwYXJlbnQiICE9
PSBhID8gYSA6ICJfZGVmYXVsdCIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBvID0gby50b1JnYmFTdHJpbmcoKQogICAgICAgICAgICAg
ICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBlLnN0eWxlW25dID0gbwogICAgICAgICAgICAgICAgICAgICAgICB9IGNh
dGNoICh0KSB7fQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIHQuZngu
c3RlcFtuXSA9IGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgICAgICAgICBlLmNvbG9ySW5pdCB8
fCAoZS5zdGFydCA9IHUoZS5lbGVtLCBuKSwgZS5lbmQgPSB1KGUuZW5kKSwgZS5jb2xvckluaXQg
PSAhMCksIHQuY3NzSG9va3Nbbl0uc2V0KGUuZWxlbSwgZS5zdGFydC50cmFuc2l0aW9uKGUuZW5k
LCBlLnBvcykpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwgdS5o
b29rKCJiYWNrZ3JvdW5kQ29sb3IgYm9yZGVyQm90dG9tQ29sb3IgYm9yZGVyTGVmdENvbG9yIGJv
cmRlclJpZ2h0Q29sb3IgYm9yZGVyVG9wQ29sb3IgY29sb3IgY29sdW1uUnVsZUNvbG9yIG91dGxp
bmVDb2xvciB0ZXh0RGVjb3JhdGlvbkNvbG9yIHRleHRFbXBoYXNpc0NvbG9yIiksIHQuY3NzSG9v
a3MuYm9yZGVyQ29sb3IgPSB7CiAgICAgICAgICAgIGV4cGFuZDogZnVuY3Rpb24odCkgewogICAg
ICAgICAgICAgICAgdmFyIGUgPSB7fTsKICAgICAgICAgICAgICAgIHJldHVybiBmKFsiVG9wIiwg
IlJpZ2h0IiwgIkJvdHRvbSIsICJMZWZ0Il0sIGZ1bmN0aW9uKG4sIGkpIHsKICAgICAgICAgICAg
ICAgICAgICBlWyJib3JkZXIiICsgaSArICJDb2xvciJdID0gdAogICAgICAgICAgICAgICAgfSks
IGUKICAgICAgICAgICAgfQogICAgICAgIH0sIHIgPSB0LkNvbG9yLm5hbWVzID0gewogICAgICAg
ICAgICBhcXVhOiAiIzAwZmZmZiIsCiAgICAgICAgICAgIGJsYWNrOiAiIzAwMDAwMCIsCiAgICAg
ICAgICAgIGJsdWU6ICIjMDAwMGZmIiwKICAgICAgICAgICAgZnVjaHNpYTogIiNmZjAwZmYiLAog
ICAgICAgICAgICBncmF5OiAiIzgwODA4MCIsCiAgICAgICAgICAgIGdyZWVuOiAiIzAwODAwMCIs
CiAgICAgICAgICAgIGxpbWU6ICIjMDBmZjAwIiwKICAgICAgICAgICAgbWFyb29uOiAiIzgwMDAw
MCIsCiAgICAgICAgICAgIG5hdnk6ICIjMDAwMDgwIiwKICAgICAgICAgICAgb2xpdmU6ICIjODA4
MDAwIiwKICAgICAgICAgICAgcHVycGxlOiAiIzgwMDA4MCIsCiAgICAgICAgICAgIHJlZDogIiNm
ZjAwMDAiLAogICAgICAgICAgICBzaWx2ZXI6ICIjYzBjMGMwIiwKICAgICAgICAgICAgdGVhbDog
IiMwMDgwODAiLAogICAgICAgICAgICB3aGl0ZTogIiNmZmZmZmYiLAogICAgICAgICAgICB5ZWxs
b3c6ICIjZmZmZjAwIiwKICAgICAgICAgICAgdHJhbnNwYXJlbnQ6IFtudWxsLCBudWxsLCBudWxs
LCAwXSwKICAgICAgICAgICAgX2RlZmF1bHQ6ICIjZmZmZmZmIgogICAgICAgIH0KICAgIH0oalF1
ZXJ5KSwgISBmdW5jdGlvbih0KSB7CiAgICAgICAgdmFyIGUgPSAicHJvcGVsbGVyIiwKICAgICAg
ICAgICAgbiA9IHsKICAgICAgICAgICAgICAgIGFuZ2xlOiAwLAogICAgICAgICAgICAgICAgc3Bl
ZWQ6IDAsCiAgICAgICAgICAgICAgICBpbmVydGlhOiAwLAogICAgICAgICAgICAgICAgbWluaW1h
bFNwZWVkOiAuMDAxLAogICAgICAgICAgICAgICAgbWluaW1hbEFuZ2xlQ2hhbmdlOiAuMSwKICAg
ICAgICAgICAgICAgIHN0ZXA6IDAsCiAgICAgICAgICAgICAgICBzdGVwVHJhbnNpdGlvblRpbWU6
IDAsCiAgICAgICAgICAgICAgICBzdGVwVHJhbnNpdGlvbkVhc2luZzogImxpbmVhciIsCiAgICAg
ICAgICAgICAgICByb3RhdGVQYXJlbnRJbnN0YW50bHk6ICExLAogICAgICAgICAgICAgICAgdG91
Y2hFbGVtZW50OiBudWxsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGkgPSBmdW5jdGlvbih0
LCBlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gInN0cmluZyIgPT0gdHlwZW9mIHQgJiYgKHQg
PSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHQpKSwgdC5sZW5ndGggPiAxID8gaS5jcmVhdGVN
YW55KHQsIGUpIDogKDEgPT09IHQubGVuZ3RoICYmICh0ID0gdFswXSksIHRoaXMuZWxlbWVudCA9
IHQsIHRoaXMuYWN0aXZlID0gITEsIHRoaXMudHJhbnNpdGluZyA9ICExLCB0aGlzLnVwZGF0ZSA9
IHRoaXMudXBkYXRlLmJpbmQodGhpcyksIHRoaXMuaW5pdENTU1ByZWZpeCgpLCB0aGlzLmluaXRB
bmdsZUdldHRlclNldHRlcigpLCB0aGlzLmluaXRPcHRpb25zKGUpLCB0aGlzLmluaXRIYXJkd2Fy
ZUFjY2VsZXJhdGlvbigpLCB0aGlzLmluaXRUcmFuc2l0aW9uKCksIHRoaXMuYmluZEhhbmRsZXJz
KCksIHRoaXMuYWRkTGlzdGVuZXJzKCksIHZvaWQgdGhpcy51cGRhdGUoKSkKICAgICAgICAgICAg
fTsKICAgICAgICBpLmNyZWF0ZU1hbnkgPSBmdW5jdGlvbih0LCBlKSB7CiAgICAgICAgICAgIGZv
ciAodmFyIG4gPSBbXSwgbyA9IDA7IG8gPCB0Lmxlbmd0aDsgbysrKSBuLnB1c2gobmV3IGkodFtv
XSwgZSkpOwogICAgICAgICAgICByZXR1cm4gbgogICAgICAgIH07CiAgICAgICAgdmFyIG8gPSBp
LnByb3RvdHlwZTsKICAgICAgICBvLmluaXRBbmdsZUdldHRlclNldHRlciA9IGZ1bmN0aW9uKCkg
ewogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgImFuZ2xlIiwgewogICAg
ICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4g
dGhpcy5fYW5nbGUKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBzZXQ6IGZ1bmN0
aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLl9hbmdsZSA9IHQsIHRoaXMudmlydHVh
bEFuZ2xlID0gdCwgdGhpcy51cGRhdGVDU1MoKQogICAgICAgICAgICAgICAgfQogICAgICAgICAg
ICB9KQogICAgICAgIH0sIG8uYmluZEhhbmRsZXJzID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAg
IHRoaXMub25Sb3RhdGlvblN0YXJ0ID0gdGhpcy5vblJvdGF0aW9uU3RhcnQuYmluZCh0aGlzKSwg
dGhpcy5vblJvdGF0aW9uU3RvcCA9IHRoaXMub25Sb3RhdGlvblN0b3AuYmluZCh0aGlzKSwgdGhp
cy5vblJvdGF0ZWQgPSB0aGlzLm9uUm90YXRlZC5iaW5kKHRoaXMpCiAgICAgICAgfSwgby5hZGRM
aXN0ZW5lcnMgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgdGhpcy5saXN0ZW5lcnNJbnN0YWxs
ZWQgPSAhMCwgIm9udG91Y2hzdGFydCIgaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50ID8gKHRo
aXMudG91Y2hFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoInRvdWNoc3RhcnQiLCB0aGlzLm9uUm90
YXRpb25TdGFydCksIHRoaXMudG91Y2hFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoInRvdWNobW92
ZSIsIHRoaXMub25Sb3RhdGVkKSwgdGhpcy50b3VjaEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigi
dG91Y2hlbmQiLCB0aGlzLm9uUm90YXRpb25TdG9wKSwgdGhpcy50b3VjaEVsZW1lbnQuYWRkRXZl
bnRMaXN0ZW5lcigidG91Y2hjYW5jZWwiLCB0aGlzLm9uUm90YXRpb25TdG9wKSwgdGhpcy50b3Vj
aEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiZHJhZ3N0YXJ0IiwgdGhpcy5yZXR1cm5GYWxzZSkp
IDogKHRoaXMudG91Y2hFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlZG93biIsIHRoaXMu
b25Sb3RhdGlvblN0YXJ0KSwgdGhpcy50b3VjaEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigibW91
c2Vtb3ZlIiwgdGhpcy5vblJvdGF0ZWQpLCB0aGlzLnRvdWNoRWxlbWVudC5hZGRFdmVudExpc3Rl
bmVyKCJtb3VzZXVwIiwgdGhpcy5vblJvdGF0aW9uU3RvcCksIHRoaXMudG91Y2hFbGVtZW50LmFk
ZEV2ZW50TGlzdGVuZXIoIm1vdXNlbGVhdmUiLCB0aGlzLm9uUm90YXRpb25TdG9wKSwKICAgICAg
ICAgICAgICAgIHRoaXMudG91Y2hFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoImRyYWdzdGFydCIs
IHRoaXMucmV0dXJuRmFsc2UpKSwgdGhpcy50b3VjaEVsZW1lbnQub25kcmFnc3RhcnQgPSB0aGlz
LnJldHVybkZhbHNlCiAgICAgICAgfSwgby5yZW1vdmVMaXN0ZW5lcnMgPSBmdW5jdGlvbigpIHsK
ICAgICAgICAgICAgdGhpcy5saXN0ZW5lcnNJbnN0YWxsZWQgPSAhMSwgIm9udG91Y2hzdGFydCIg
aW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50ID8gKHRoaXMudG91Y2hFbGVtZW50LnJlbW92ZUV2
ZW50TGlzdGVuZXIoInRvdWNoc3RhcnQiLCB0aGlzLm9uUm90YXRpb25TdGFydCksIHRoaXMudG91
Y2hFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoInRvdWNobW92ZSIsIHRoaXMub25Sb3RhdGVk
KSwgdGhpcy50b3VjaEVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigidG91Y2hlbmQiLCB0aGlz
Lm9uUm90YXRpb25TdG9wKSwgdGhpcy50b3VjaEVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigi
dG91Y2hjYW5jZWwiLCB0aGlzLm9uUm90YXRpb25TdG9wKSwgdGhpcy50b3VjaEVsZW1lbnQucmVt
b3ZlRXZlbnRMaXN0ZW5lcigiZHJhZ3N0YXJ0IiwgdGhpcy5yZXR1cm5GYWxzZSkpIDogKHRoaXMu
dG91Y2hFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1vdXNlZG93biIsIHRoaXMub25Sb3Rh
dGlvblN0YXJ0KSwgdGhpcy50b3VjaEVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigibW91c2Vt
b3ZlIiwgdGhpcy5vblJvdGF0ZWQpLCB0aGlzLnRvdWNoRWxlbWVudC5yZW1vdmVFdmVudExpc3Rl
bmVyKCJtb3VzZXVwIiwgdGhpcy5vblJvdGF0aW9uU3RvcCksIHRoaXMudG91Y2hFbGVtZW50LnJl
bW92ZUV2ZW50TGlzdGVuZXIoIm1vdXNlbGVhdmUiLCB0aGlzLm9uUm90YXRpb25TdG9wKSwgdGhp
cy50b3VjaEVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigiZHJhZ3N0YXJ0IiwgdGhpcy5yZXR1
cm5GYWxzZSkpCiAgICAgICAgfSwgby5iaW5kID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICEw
ICE9PSB0aGlzLmxpc3RlbmVyc0luc3RhbGxlZCAmJiB0aGlzLmFkZExpc3RlbmVycygpCiAgICAg
ICAgfSwgby51bmJpbmQgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgITAgPT09IHRoaXMubGlz
dGVuZXJzSW5zdGFsbGVkICYmICh0aGlzLnJlbW92ZUxpc3RlbmVycygpLCB0aGlzLm9uUm90YXRp
b25TdG9wKCkpCiAgICAgICAgfSwgby5zdG9wID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHRo
aXMuc3BlZWQgPSAwLCB0aGlzLm9uUm90YXRpb25TdG9wKCkKICAgICAgICB9LCBvLm9uUm90YXRp
b25TdGFydCA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgdGhpcy5pbml0Q29vcmRpbmF0ZXMo
KSwgdGhpcy5pbml0RHJhZygpLCB0aGlzLmFjdGl2ZSA9ICEwLCB2b2lkIDAgIT09IHRoaXMub25E
cmFnU3RhcnQgJiYgdGhpcy5vbkRyYWdTdGFydCgpLCAhMSA9PT0gdGhpcy5yb3RhdGVQYXJlbnRJ
bnN0YW50bHkgJiYgdC5zdG9wUHJvcGFnYXRpb24oKQogICAgICAgIH0sIG8ub25Sb3RhdGlvblN0
b3AgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgdm9pZCAwICE9PSB0aGlzLm9uRHJhZ1N0b3Ag
JiYgITAgPT09IHRoaXMuYWN0aXZlICYmIHRoaXMub25EcmFnU3RvcCgpLCB0aGlzLmFjdGl2ZSA9
ICExCiAgICAgICAgfSwgby5vblJvdGF0ZWQgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICEw
ID09PSB0aGlzLmFjdGl2ZSAmJiAodC5zdG9wUHJvcGFnYXRpb24oKSwgdC5wcmV2ZW50RGVmYXVs
dCgpLCB2b2lkIDAgIT09IHQudGFyZ2V0VG91Y2hlcyAmJiB2b2lkIDAgIT09IHQudGFyZ2V0VG91
Y2hlc1swXSA/IHRoaXMubGFzdE1vdXNlRXZlbnQgPSB7CiAgICAgICAgICAgICAgICBwYWdlWDog
dC50YXJnZXRUb3VjaGVzWzBdLnBhZ2VYLAogICAgICAgICAgICAgICAgcGFnZVk6IHQudGFyZ2V0
VG91Y2hlc1swXS5wYWdlWQogICAgICAgICAgICB9IDogdGhpcy5sYXN0TW91c2VFdmVudCA9IHsK
ICAgICAgICAgICAgICAgIHBhZ2VYOiB0LnBhZ2VYIHx8IHQuY2xpZW50WCwKICAgICAgICAgICAg
ICAgIHBhZ2VZOiB0LnBhZ2VZIHx8IHQuY2xpZW50WQogICAgICAgICAgICB9KQogICAgICAgIH0s
IG8udXBkYXRlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHZvaWQgMCAhPT0gdGhpcy5sYXN0
TW91c2VFdmVudCAmJiAhMCA9PT0gdGhpcy5hY3RpdmUgJiYgdGhpcy51cGRhdGVBbmdsZVRvTW91
c2UodGhpcy5sYXN0TW91c2VFdmVudCksIHRoaXMudXBkYXRlQW5nbGUoKSwgdGhpcy5hcHBseVNw
ZWVkKCksIHRoaXMuYXBwbHlJbmVydGlhKCksIE1hdGguYWJzKHRoaXMubGFzdEFwcGxpZWRBbmds
ZSAtIHRoaXMuX2FuZ2xlKSA+PSB0aGlzLm1pbmltYWxBbmdsZUNoYW5nZSAmJiAhMSA9PT0gdGhp
cy50cmFuc2l0aW5nICYmICh0aGlzLnVwZGF0ZUNTUygpLCB0aGlzLmJsb2NrVHJhbnNpdGlvbigp
LCB2b2lkIDAgIT09IHRoaXMub25Sb3RhdGUgJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgdGhpcy5v
blJvdGF0ZSAmJiB0aGlzLm9uUm90YXRlLmJpbmQodGhpcykoKSwgdGhpcy5sYXN0QXBwbGllZEFu
Z2xlID0gdGhpcy5fYW5nbGUpLCB3aW5kb3cucmVxdWVzdEFuaW1GcmFtZSh0aGlzLnVwZGF0ZSkK
ICAgICAgICB9LCBvLnVwZGF0ZUFuZ2xlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHRoaXMu
c3RlcCA+IDAgPyB0aGlzLl9hbmdsZSA9IHRoaXMuZ2V0QW5nbGVGcm9tVmlydHVhbCgpIDogdGhp
cy5fYW5nbGUgPSB0aGlzLm5vcm1hbGl6ZUFuZ2xlKHRoaXMudmlydHVhbEFuZ2xlKQogICAgICAg
IH0sIG8uZ2V0QW5nbGVGcm9tVmlydHVhbCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICByZXR1
cm4gTWF0aC5jZWlsKHRoaXMudmlydHVhbEFuZ2xlIC8gdGhpcy5zdGVwKSAqIHRoaXMuc3RlcAog
ICAgICAgIH0sIG8ubm9ybWFsaXplQW5nbGUgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgIHZh
ciBlID0gdDsKICAgICAgICAgICAgcmV0dXJuIGUgJT0gMzYwLCAwID4gZSAmJiAoZSA9IDM2MCAr
IGUpLCBlCiAgICAgICAgfSwgby5kaWZmZXJlbmNlQmV0d2VlbkFuZ2xlcyA9IGZ1bmN0aW9uKHQs
IGUpIHsKICAgICAgICAgICAgdmFyIG4gPSB0ICogKE1hdGguUEkgLyAxODApLAogICAgICAgICAg
ICAgICAgaSA9IGUgKiAoTWF0aC5QSSAvIDE4MCksCiAgICAgICAgICAgICAgICBvID0gTWF0aC5h
dGFuMihNYXRoLnNpbihuIC0gaSksIE1hdGguY29zKG4gLSBpKSksCiAgICAgICAgICAgICAgICBy
ID0gbyAqICgxODAgLyBNYXRoLlBJKTsKICAgICAgICAgICAgcmV0dXJuIE1hdGgucm91bmQoMTAw
ICogcikgLyAxMDAKICAgICAgICB9LCBvLmFwcGx5U3BlZWQgPSBmdW5jdGlvbigpIHsKICAgICAg
ICAgICAgdGhpcy5pbmVydGlhID4gMCAmJiAwICE9PSB0aGlzLnNwZWVkICYmICExID09PSB0aGlz
LmFjdGl2ZSAmJiAodGhpcy52aXJ0dWFsQW5nbGUgKz0gdGhpcy5zcGVlZCkKICAgICAgICB9LCBv
LmFwcGx5SW5lcnRpYSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICB0aGlzLmluZXJ0aWEgPiAw
ICYmIChNYXRoLmFicyh0aGlzLnNwZWVkKSA+PSB0aGlzLm1pbmltYWxTcGVlZCA/ICh0aGlzLnNw
ZWVkID0gdGhpcy5zcGVlZCAqIHRoaXMuaW5lcnRpYSwgITEgPT09IHRoaXMuYWN0aXZlICYmIE1h
dGguYWJzKHRoaXMuc3BlZWQpIDwgdGhpcy5taW5pbWFsU3BlZWQgJiYgdm9pZCAwICE9PSB0aGlz
Lm9uU3RvcCAmJiB0aGlzLm9uU3RvcCgpKSA6IDAgIT09IHRoaXMuc3BlZWQgJiYgKHRoaXMuc3Bl
ZWQgPSAwKSkKICAgICAgICB9LCBvLnVwZGF0ZUFuZ2xlVG9Nb3VzZSA9IGZ1bmN0aW9uKHQpIHsK
ICAgICAgICAgICAgdmFyIGUgPSB0LnBhZ2VYIC0gdGhpcy5jeCwKICAgICAgICAgICAgICAgIGkg
PSB0LnBhZ2VZIC0gdGhpcy5jeSwKICAgICAgICAgICAgICAgIG8gPSBNYXRoLmF0YW4yKGUsIGkp
LAogICAgICAgICAgICAgICAgciA9IG8gKiAoMTgwIC8gTWF0aC5QSSAqIC0xKSArIDE4MDsKICAg
ICAgICAgICAgaWYgKHZvaWQgMCA9PT0gdGhpcy5sYXN0TW91c2VBbmdsZSAmJiAodGhpcy5sYXN0
RWxlbWVudEFuZ2xlID0gdGhpcy52aXJ0dWFsQW5nbGUsIHRoaXMubGFzdE1vdXNlQW5nbGUgPSBy
KSwgdGhpcy5zdGVwVHJhbnNpdGlvblRpbWUgIT09IG4uc3RlcFRyYW5zaXRpb25UaW1lKSB0aGlz
LnNwZWVkID0gdGhpcy5tb3VzZURpZmYgPSB0aGlzLmRpZmZlcmVuY2VCZXR3ZWVuQW5nbGVzKHIs
IHRoaXMubGFzdE1vdXNlQW5nbGUpLCB0aGlzLnZpcnR1YWxBbmdsZSA9IHRoaXMubGFzdEVsZW1l
bnRBbmdsZSArIHRoaXMubW91c2VEaWZmLCB0aGlzLmxhc3RFbGVtZW50QW5nbGUgPSB0aGlzLnZp
cnR1YWxBbmdsZSwgdGhpcy5sYXN0TW91c2VBbmdsZSA9IHI7CiAgICAgICAgICAgIGVsc2Ugewog
ICAgICAgICAgICAgICAgdmFyIHMgPSB0aGlzLnZpcnR1YWxBbmdsZTsKICAgICAgICAgICAgICAg
IHRoaXMubW91c2VEaWZmID0gciAtIHRoaXMubGFzdE1vdXNlQW5nbGUsIHRoaXMudmlydHVhbEFu
Z2xlID0gdGhpcy5sYXN0RWxlbWVudEFuZ2xlICsgdGhpcy5tb3VzZURpZmY7CiAgICAgICAgICAg
ICAgICB2YXIgYSA9IHRoaXMudmlydHVhbEFuZ2xlOwogICAgICAgICAgICAgICAgdGhpcy5zcGVl
ZCA9IHRoaXMuZGlmZmVyZW5jZUJldHdlZW5BbmdsZXMoYSwgcykKICAgICAgICAgICAgfQogICAg
ICAgIH0sIG8uaW5pdENvb3JkaW5hdGVzID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHZhciB0
ID0gdGhpcy5nZXRWaWV3T2Zmc2V0KCk7CiAgICAgICAgICAgIHRoaXMuY3ggPSB0LnggKyB0aGlz
LmVsZW1lbnQub2Zmc2V0V2lkdGggLyAyLCB0aGlzLmN5ID0gdC55ICsgdGhpcy5lbGVtZW50Lm9m
ZnNldEhlaWdodCAvIDIKICAgICAgICB9LCBvLmluaXREcmFnID0gZnVuY3Rpb24oKSB7CiAgICAg
ICAgICAgIHRoaXMuc3BlZWQgPSAwLCB0aGlzLmxhc3RNb3VzZUFuZ2xlID0gdm9pZCAwLCB0aGlz
Lmxhc3RFbGVtZW50QW5nbGUgPSB2b2lkIDAsIHRoaXMubGFzdE1vdXNlRXZlbnQgPSB2b2lkIDAK
ICAgICAgICB9LCBvLmluaXRPcHRpb25zID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICB0ID0g
dCB8fCBuLCB0aGlzLnRvdWNoRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodC50
b3VjaEVsZW1lbnQpWzBdIHx8IHRoaXMuZWxlbWVudCwgdGhpcy5vblJvdGF0ZSA9IHQub25Sb3Rh
dGUgfHwgdC5vbnJvdGF0ZSwgdGhpcy5vblN0b3AgPSB0Lm9uU3RvcCB8fCB0Lm9uc3RvcCwgdGhp
cy5vbkRyYWdTdG9wID0gdC5vbkRyYWdTdG9wIHx8IHQub25kcmFnc3RvcCwgdGhpcy5vbkRyYWdT
dGFydCA9IHQub25EcmFnU3RhcnQgfHwgdC5vbmRyYWdzdGFydCwgdGhpcy5zdGVwID0gdC5zdGVw
IHx8IG4uc3RlcCwgdGhpcy5zdGVwVHJhbnNpdGlvblRpbWUgPSB0LnN0ZXBUcmFuc2l0aW9uVGlt
ZSB8fCBuLnN0ZXBUcmFuc2l0aW9uVGltZSwgdGhpcy5zdGVwVHJhbnNpdGlvbkVhc2luZyA9IHQu
c3RlcFRyYW5zaXRpb25FYXNpbmcgfHwgbi5zdGVwVHJhbnNpdGlvbkVhc2luZywgdGhpcy5hbmds
ZSA9IHQuYW5nbGUgfHwgbi5hbmdsZSwgdGhpcy5zcGVlZCA9IHQuc3BlZWQgfHwgbi5zcGVlZCwg
dGhpcy5pbmVydGlhID0gdC5pbmVydGlhIHx8IG4uaW5lcnRpYSwgdGhpcy5taW5pbWFsU3BlZWQg
PSB0Lm1pbmltYWxTcGVlZCB8fCBuLm1pbmltYWxTcGVlZCwgdGhpcy5sYXN0QXBwbGllZEFuZ2xl
ID0gdGhpcy52aXJ0dWFsQW5nbGUgPSB0aGlzLl9hbmdsZSA9IHQuYW5nbGUgfHwgbi5hbmdsZSwg
dGhpcy5taW5pbWFsQW5nbGVDaGFuZ2UgPSB0aGlzLnN0ZXAgIT09IG4uc3RlcCA/IHRoaXMuc3Rl
cCA6IG4ubWluaW1hbEFuZ2xlQ2hhbmdlLCB0aGlzLnJvdGF0ZVBhcmVudEluc3RhbnRseSA9IHQu
cm90YXRlUGFyZW50SW5zdGFudGx5IHx8IG4ucm90YXRlUGFyZW50SW5zdGFudGx5CiAgICAgICAg
fSwgby5pbml0Q1NTUHJlZml4ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHZvaWQgMCA9PT0g
aS5jc3NQcmVmaXggJiYgKHZvaWQgMCAhPT0gZG9jdW1lbnQuYm9keS5zdHlsZS50cmFuc2Zvcm0g
PyBpLmNzc1ByZWZpeCA9ICIiIDogdm9pZCAwICE9PSBkb2N1bWVudC5ib2R5LnN0eWxlLm1velRy
YW5zZm9ybSA/IGkuY3NzUHJlZml4ID0gIi1tb3otIiA6IHZvaWQgMCAhPT0gZG9jdW1lbnQuYm9k
eS5zdHlsZS53ZWJraXRUcmFuc2Zvcm0gPyBpLmNzc1ByZWZpeCA9ICItd2Via2l0LSIgOiB2b2lk
IDAgIT09IGRvY3VtZW50LmJvZHkuc3R5bGUubXNUcmFuc2Zvcm0gJiYgKGkuY3NzUHJlZml4ID0g
Ii1tcy0iKSkKICAgICAgICB9LCBvLmluaXRIYXJkd2FyZUFjY2VsZXJhdGlvbiA9IGZ1bmN0aW9u
KCkgewogICAgICAgICAgICB0aGlzLmFjY2VsZXJhdGlvblBvc3RmaXggPSAiIjsKICAgICAgICAg
ICAgdmFyIHQsIGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJwIiksCiAgICAgICAgICAgICAg
ICBuID0gewogICAgICAgICAgICAgICAgICAgIHdlYmtpdFRyYW5zZm9ybTogIi13ZWJraXQtdHJh
bnNmb3JtIiwKICAgICAgICAgICAgICAgICAgICBPVHJhbnNmb3JtOiAiLW8tdHJhbnNmb3JtIiwK
ICAgICAgICAgICAgICAgICAgICBtc1RyYW5zZm9ybTogIi1tcy10cmFuc2Zvcm0iLAogICAgICAg
ICAgICAgICAgICAgIE1velRyYW5zZm9ybTogIi1tb3otdHJhbnNmb3JtIiwKICAgICAgICAgICAg
ICAgICAgICB0cmFuc2Zvcm06ICJ0cmFuc2Zvcm0iCiAgICAgICAgICAgICAgICB9OwogICAgICAg
ICAgICBkb2N1bWVudC5ib2R5Lmluc2VydEJlZm9yZShlLCBudWxsKTsKICAgICAgICAgICAgZm9y
ICh2YXIgbyBpbiBuKSB2b2lkIDAgIT09IGUuc3R5bGVbb10gJiYgKGUuc3R5bGVbb10gPSAidHJh
bnNsYXRlM2QoMXB4LDFweCwxcHgpIiwgdCA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGUpLmdl
dFByb3BlcnR5VmFsdWUobltvXSkpOwogICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNo
aWxkKGUpLCAhMCA9PSAodm9pZCAwICE9PSB0ICYmIHQubGVuZ3RoID4gMCAmJiAibm9uZSIgIT09
IHQpICYmICh0aGlzLmFjY2VsZXJhdGlvblBvc3RmaXggPSAidHJhbnNsYXRlWigwKSIsIHRoaXMu
ZWxlbWVudC5zdHlsZVtpLmNzc1ByZWZpeCArICJ0cmFuc2Zvcm0iXSA9IHRoaXMuYWNjZWxlcmF0
aW9uUG9zdGZpeCwgdGhpcy51cGRhdGVDU1MoKSkKICAgICAgICB9LCBvLmluaXRUcmFuc2l0aW9u
ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGlmICh0aGlzLnN0ZXBUcmFuc2l0aW9uVGltZSAh
PT0gbi5zdGVwVHJhbnNpdGlvblRpbWUpIHsKICAgICAgICAgICAgICAgIHZhciB0ID0gImFsbCAi
ICsgdGhpcy5zdGVwVHJhbnNpdGlvblRpbWUgKyAibXMgIiArIHRoaXMuc3RlcFRyYW5zaXRpb25F
YXNpbmc7CiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGVbaS5jc3NQcmVmaXggKyAi
dHJhbnNpdGlvbiJdID0gdAogICAgICAgICAgICB9CiAgICAgICAgfSwgby51cGRhdGVDU1MgPSBm
dW5jdGlvbigpIHsKICAgICAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlW2kuY3NzUHJlZml4ICsg
InRyYW5zZm9ybSJdID0gInJvdGF0ZSgiICsgdGhpcy5fYW5nbGUgKyAiZGVnKSAiICsgdGhpcy5h
Y2NlbGVyYXRpb25Qb3N0Zml4CiAgICAgICAgfSwgby5ibG9ja1RyYW5zaXRpb24gPSBmdW5jdGlv
bigpIHsKICAgICAgICAgICAgaWYgKHRoaXMuc3RlcFRyYW5zaXRpb25UaW1lICE9PSBuLnN0ZXBU
cmFuc2l0aW9uVGltZSkgewogICAgICAgICAgICAgICAgdmFyIHQgPSB0aGlzOwogICAgICAgICAg
ICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICB0LnRyYW5z
aXRpbmcgPSAhMQogICAgICAgICAgICAgICAgfSwgdGhpcy5zdGVwVHJhbnNpdGlvblRpbWUpLCB0
aGlzLnRyYW5zaXRpbmcgPSAhMAogICAgICAgICAgICB9CiAgICAgICAgfSwgby5nZXRWaWV3T2Zm
c2V0ID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICB2YXIgZSA9IHsKICAgICAgICAgICAgICAg
IHg6IDAsCiAgICAgICAgICAgICAgICB5OiAwCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHJl
dHVybiB0aGlzLmVsZW1lbnQgJiYgdGhpcy5hZGRPZmZzZXQodGhpcy5lbGVtZW50LCBlLCAiZGVm
YXVsdFZpZXciIGluIGRvY3VtZW50ID8gZG9jdW1lbnQuZGVmYXVsdFZpZXcgOiBkb2N1bWVudC5w
YXJlbnRXaW5kb3cpLCBlCiAgICAgICAgfSwgby5hZGRPZmZzZXQgPSBmdW5jdGlvbih0LCBlLCBu
KSB7CiAgICAgICAgICAgIHZhciBpID0gdC5vZmZzZXRQYXJlbnQ7CiAgICAgICAgICAgIGlmIChl
LnggKz0gdC5vZmZzZXRMZWZ0IC0gKGkgPyBpLnNjcm9sbExlZnQgOiAwKSwgZS55ICs9IHQub2Zm
c2V0VG9wIC0gKGkgPyBpLnNjcm9sbFRvcCA6IDApLCBpKSB7CiAgICAgICAgICAgICAgICBpZiAo
MSA9PSBpLm5vZGVUeXBlKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIG8gPSBuLmdldENvbXB1
dGVkU3R5bGUoaSwgIiIpOwogICAgICAgICAgICAgICAgICAgIGlmICgic3RhdGljIiAhPSBvLnBv
c2l0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlLnggKz0gcGFyc2VJbnQoby5i
b3JkZXJMZWZ0V2lkdGgpLCBlLnkgKz0gcGFyc2VJbnQoby5ib3JkZXJUb3BXaWR0aCksICJ0YWJs
ZSIgPT0gaS5sb2NhbE5hbWUudG9Mb3dlckNhc2UoKSkgZS54ICs9IHBhcnNlSW50KG8ucGFkZGlu
Z0xlZnQpLCBlLnkgKz0gcGFyc2VJbnQoby5wYWRkaW5nVG9wKTsKICAgICAgICAgICAgICAgICAg
ICAgICAgZWxzZSBpZiAoImJvZHkiID09IGkubG9jYWxOYW1lLnRvTG93ZXJDYXNlKCkpIHsKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByID0gbi5nZXRDb21wdXRlZFN0eWxlKHQsICIi
KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUueCArPSBwYXJzZUludChyLm1hcmdpbkxl
ZnQpLCBlLnkgKz0gcGFyc2VJbnQoci5tYXJnaW5Ub3ApCiAgICAgICAgICAgICAgICAgICAgICAg
IH0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgImJvZHkiID09IGkubG9jYWxOYW1lLnRvTG93
ZXJDYXNlKCkgJiYgKGUueCArPSBwYXJzZUludChvLmJvcmRlckxlZnRXaWR0aCksIGUueSArPSBw
YXJzZUludChvLmJvcmRlclRvcFdpZHRoKSk7CiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIg
cyA9IHQucGFyZW50Tm9kZTsgaSAhPSBzOykgZS54IC09IHMuc2Nyb2xsTGVmdCwgZS55IC09IHMu
c2Nyb2xsVG9wLCBzID0gcy5wYXJlbnROb2RlOwogICAgICAgICAgICAgICAgICAgIHRoaXMuYWRk
T2Zmc2V0KGksIGUsIG4pCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAg
ICAgICAgICAgICAgICBpZiAoImJvZHkiID09IHQubG9jYWxOYW1lLnRvTG93ZXJDYXNlKCkpIHsK
ICAgICAgICAgICAgICAgICAgICB2YXIgciA9IG4uZ2V0Q29tcHV0ZWRTdHlsZSh0LCAiIik7CiAg
ICAgICAgICAgICAgICAgICAgZS54ICs9IHBhcnNlSW50KHIuYm9yZGVyTGVmdFdpZHRoKSwgZS55
ICs9IHBhcnNlSW50KHIuYm9yZGVyVG9wV2lkdGgpOwogICAgICAgICAgICAgICAgICAgIHZhciBh
ID0gbi5nZXRDb21wdXRlZFN0eWxlKHQucGFyZW50Tm9kZSwgIiIpOwogICAgICAgICAgICAgICAg
ICAgIGUueCArPSBwYXJzZUludChhLnBhZGRpbmdMZWZ0KSwgZS55ICs9IHBhcnNlSW50KGEucGFk
ZGluZ1RvcCksIGUueCArPSBwYXJzZUludChhLm1hcmdpbkxlZnQpLCBlLnkgKz0gcGFyc2VJbnQo
YS5tYXJnaW5Ub3ApCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0LnNjcm9sbExl
ZnQgJiYgKGUueCArPSB0LnNjcm9sbExlZnQpLCB0LnNjcm9sbFRvcCAmJiAoZS55ICs9IHQuc2Ny
b2xsVG9wKTsKICAgICAgICAgICAgICAgIHZhciB1ID0gdC5vd25lckRvY3VtZW50LmRlZmF1bHRW
aWV3OwogICAgICAgICAgICAgICAgdSAmJiB1LmZyYW1lRWxlbWVudCAmJiB0aGlzLmFkZE9mZnNl
dCh1LmZyYW1lRWxlbWVudCwgZSwgdSkKICAgICAgICAgICAgfQogICAgICAgIH0sIG8ucmV0dXJu
RmFsc2UgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuICExCiAgICAgICAgfSwgdm9p
ZCAwICE9PSB0LiQgJiYgKCQucHJvcGVsbGVyID0ge30sICQucHJvcGVsbGVyLnByb3BlbGxlcnMg
PSBbXSwgJC5mbltlXSA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWFj
aChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIGlmICghJC5kYXRhKHRoaXMsICJwbHVnaW5f
IiArIGUpKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSBuZXcgaSh0aGlzLCB0KTsKICAg
ICAgICAgICAgICAgICAgICAkLmRhdGEodGhpcywgInBsdWdpbl8iICsgZSwgbiksICQucHJvcGVs
bGVyLnByb3BlbGxlcnMucHVzaChuKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQog
ICAgICAgIH0pLCBpLmRlZzJyYWRpYW5zID0gMiAqIE1hdGguUEkgLyAzNjAsIHQuUHJvcGVsbGVy
ID0gaQogICAgfSh3aW5kb3cpLCB3aW5kb3cucmVxdWVzdEFuaW1GcmFtZSA9IGZ1bmN0aW9uKCkg
ewogICAgICAgIHJldHVybiB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IHdpbmRvdy53
ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgd2luZG93Lm1velJlcXVlc3RBbmltYXRpb25G
cmFtZSB8fCBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KHQsIDFl
MyAvIDYwKQogICAgICAgIH0KICAgIH0oKSwKICAgIGZ1bmN0aW9uKHQsIGUsIG4pIHsKICAgICAg
ICAidXNlIHN0cmljdCI7CgogICAgICAgIGZ1bmN0aW9uIGkoZSwgbikgewogICAgICAgICAgICBy
ZXR1cm4gdGhpcy5uYW1lID0gbywgdGhpcy5lbCA9IGUsIHRoaXMuJGVsID0gdChlKSwgdGhpcy5v
cHRpb25zID0gdC5leHRlbmQoe30sIHIsIG4pLCB0aGlzLiRkb2N1bWVudCA9IHQodGhpcy4kZWxb
MF0ub3duZXJEb2N1bWVudCksIHRoaXMuJGJvZHkgPSB0aGlzLiRkb2N1bWVudC5maW5kKCJib2R5
IiksIHRoaXMubW92ZVRyaWdnZXIgPSAiTVNQb2ludGVyTW92ZSBwb2ludGVybW92ZSB0b3VjaG1v
dmUgbW91c2Vtb3ZlIiwgdGhpcy5zdGFydFRyaWdnZXIgPSAiTVNQb2ludGVyRG93biBwb2ludGVy
ZG93biB0b3VjaHN0YXJ0IG1vdXNlZG93biIsIHRoaXMuc3RvcFRyaWdnZXIgPSAiTVNQb2ludGVy
VXAgcG9pbnRlcnVwIHRvdWNoZW5kIG1vdXNldXAiLCB0aGlzLnN0YXJ0VHJpZ2dlckFycmF5ID0g
dGhpcy5zdGFydFRyaWdnZXIuc3BsaXQoIiAiKSwgdGhpcy5tb3ZlVHJpZ2dlckFycmF5ID0gdGhp
cy5tb3ZlVHJpZ2dlci5zcGxpdCgiICIpLCB0aGlzLnN0b3BUcmlnZ2VyQXJyYXkgPSB0aGlzLnN0
b3BUcmlnZ2VyLnNwbGl0KCIgIiksIHRoaXMuc3RvcEV2ZW50cyA9IFt0aGlzLnN0b3BUcmlnZ2Vy
LCB0aGlzLm9wdGlvbnMuc3RvcEV2ZW50c10uam9pbigiICIpLCAid2luZG93IiA9PT0gdGhpcy5v
cHRpb25zLmNvbnN0cmFpblRvID8gdGhpcy4kY29udGFpbmVyID0gdGhpcy4kZG9jdW1lbnQgOiB0
aGlzLm9wdGlvbnMuY29uc3RyYWluVG8gJiYgInBhcmVudCIgIT09IHRoaXMub3B0aW9ucy5jb25z
dHJhaW5UbyA/IHRoaXMuJGNvbnRhaW5lciA9IHQodGhpcy5vcHRpb25zLmNvbnN0cmFpblRvKSA6
IHRoaXMuJGNvbnRhaW5lciA9IHRoaXMuJGVsLnBhcmVudCgpLCB0aGlzLmlzUG9pbnRlckV2ZW50
Q29tcGF0aWJsZSgpICYmIHRoaXMuYXBwbHlNU0RlZmF1bHRzKCksIHRoaXMuQ1NTRWFzZUhhc2gg
PSB0aGlzLmdldENTU0Vhc2VIYXNoKCksIHRoaXMuc2NhbGUgPSAxLCB0aGlzLnN0YXJ0ZWQgPSAh
MSwgdGhpcy5kaXNhYmxlZCA9ICExLCB0aGlzLmFjdGl2ZURyb3BSZWdpb25zID0gW10sIHRoaXMu
cmVzZXRWZWxvY2l0eVF1ZXVlKCksIHRoaXMuaW5pdCgpLCB0aGlzCiAgICAgICAgfQogICAgICAg
IHZhciBvID0gInBlcCIsCiAgICAgICAgICAgIHIgPSB7CiAgICAgICAgICAgICAgICBpbml0aWF0
ZTogZnVuY3Rpb24oKSB7fSwKICAgICAgICAgICAgICAgIHN0YXJ0OiBmdW5jdGlvbigpIHt9LAog
ICAgICAgICAgICAgICAgZHJhZzogZnVuY3Rpb24oKSB7fSwKICAgICAgICAgICAgICAgIHN0b3A6
IGZ1bmN0aW9uKCkge30sCiAgICAgICAgICAgICAgICBlYXNpbmc6IG51bGwsCiAgICAgICAgICAg
ICAgICByZXN0OiBmdW5jdGlvbigpIHt9LAogICAgICAgICAgICAgICAgbW92ZVRvOiAhMSwKICAg
ICAgICAgICAgICAgIGNhbGxJZk5vdFN0YXJ0ZWQ6IFsic3RvcCIsICJyZXN0Il0sCiAgICAgICAg
ICAgICAgICBzdGFydFRocmVzaG9sZDogWzAsIDBdLAogICAgICAgICAgICAgICAgZ3JpZDogWzEs
IDFdLAogICAgICAgICAgICAgICAgZGVidWc6ICExLAogICAgICAgICAgICAgICAgYWN0aXZlQ2xh
c3M6ICJwZXAtYWN0aXZlIiwKICAgICAgICAgICAgICAgIG11bHRpcGxpZXI6IDEsCiAgICAgICAg
ICAgICAgICB2ZWxvY2l0eU11bHRpcGxpZXI6IDIuNSwKICAgICAgICAgICAgICAgIHNob3VsZFBy
ZXZlbnREZWZhdWx0OiAhMCwKICAgICAgICAgICAgICAgIGFsbG93RHJhZ0V2ZW50UHJvcGFnYXRp
b246ICEwLAogICAgICAgICAgICAgICAgc3RvcEV2ZW50czogIiIsCiAgICAgICAgICAgICAgICBo
YXJkd2FyZUFjY2VsZXJhdGU6ICEwLAogICAgICAgICAgICAgICAgdXNlQ1NTVHJhbnNsYXRpb246
ICEwLAogICAgICAgICAgICAgICAgZGlzYWJsZVNlbGVjdDogITAsCiAgICAgICAgICAgICAgICBj
c3NFYXNlU3RyaW5nOiAiY3ViaWMtYmV6aWVyKDAuMTkwLCAxLjAwMCwgMC4yMjAsIDEuMDAwKSIs
CiAgICAgICAgICAgICAgICBjc3NFYXNlRHVyYXRpb246IDFlMywKICAgICAgICAgICAgICAgIHNo
b3VsZEVhc2U6ICEwLAogICAgICAgICAgICAgICAgZHJvcHBhYmxlOiAhMSwKICAgICAgICAgICAg
ICAgIGRyb3BwYWJsZUFjdGl2ZUNsYXNzOiAicGVwLWRwYSIsCiAgICAgICAgICAgICAgICBvdmVy
bGFwRnVuY3Rpb246ICExLAogICAgICAgICAgICAgICAgY29uc3RyYWluVG86ICExLAogICAgICAg
ICAgICAgICAgcmVtb3ZlTWFyZ2luczogITAsCiAgICAgICAgICAgICAgICBwbGFjZTogITAsCiAg
ICAgICAgICAgICAgICBkZWZlclBsYWNlbWVudDogITEsCiAgICAgICAgICAgICAgICBheGlzOiBu
dWxsLAogICAgICAgICAgICAgICAgZm9yY2VOb25DU1MzTW92ZW1lbnQ6ICExLAogICAgICAgICAg
ICAgICAgZWxlbWVudHNXaXRoSW50ZXJhY3Rpb246ICJpbnB1dCIsCiAgICAgICAgICAgICAgICBy
ZXZlcnQ6ICExLAogICAgICAgICAgICAgICAgcmV2ZXJ0QWZ0ZXI6ICJzdG9wIiwKICAgICAgICAg
ICAgICAgIHJldmVydElmOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4g
ITAKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBpZ25vcmVSaWdodENsaWNrOiAh
MCwKICAgICAgICAgICAgICAgIHN0YXJ0UG9zOiB7CiAgICAgICAgICAgICAgICAgICAgbGVmdDog
bnVsbCwKICAgICAgICAgICAgICAgICAgICB0b3A6IG51bGwKICAgICAgICAgICAgICAgIH0sCiAg
ICAgICAgICAgICAgICB1c2VCb3VuZGluZ0NsaWVudFJlY3Q6ICExCiAgICAgICAgICAgIH07CiAg
ICAgICAgaS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICB0aGlzLm9w
dGlvbnMuZGVidWcgJiYgdGhpcy5idWlsZERlYnVnRGl2KCksIHRoaXMub3B0aW9ucy5kaXNhYmxl
U2VsZWN0ICYmIHRoaXMuZGlzYWJsZVNlbGVjdCgpLCB0aGlzLm9wdGlvbnMucGxhY2UgJiYgIXRo
aXMub3B0aW9ucy5kZWZlclBsYWNlbWVudCAmJiAodGhpcy5wb3NpdGlvblBhcmVudCgpLCB0aGlz
LnBsYWNlT2JqZWN0KCkpLCB0aGlzLmV2ID0ge30sIHRoaXMucG9zID0ge30sIHRoaXMuc3Vic2Ny
aWJlKCkKICAgICAgICB9LCBpLnByb3RvdHlwZS5zdWJzY3JpYmUgPSBmdW5jdGlvbigpIHsKICAg
ICAgICAgICAgdmFyIHQgPSB0aGlzOwogICAgICAgICAgICB0aGlzLm9uU3RhcnRFdmVudCA9IGZ1
bmN0aW9uKGUpIHsKICAgICAgICAgICAgICAgIHQuaGFuZGxlU3RhcnQoZSkKICAgICAgICAgICAg
fSwgdGhpcy4kZWwub24odGhpcy5zdGFydFRyaWdnZXIsIHRoaXMub25TdGFydEV2ZW50KSwgdGhp
cy5vblN0YXJ0RXZlbnRPbkVsZW1lbnRzV2l0aEludGVyYWN0aW9uID0gZnVuY3Rpb24odCkgewog
ICAgICAgICAgICAgICAgdC5pZ25vcmVQcm9wYWdhdGlvbiA9ICEwCiAgICAgICAgICAgIH0sIHRo
aXMuJGVsLm9uKHRoaXMuc3RhcnRUcmlnZ2VyLCB0aGlzLm9wdGlvbnMuZWxlbWVudHNXaXRoSW50
ZXJhY3Rpb24sIHRoaXMub25TdGFydEV2ZW50T25FbGVtZW50c1dpdGhJbnRlcmFjdGlvbiksIHRo
aXMub25TdG9wRXZlbnRzID0gZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgICAgdC5oYW5kbGVT
dG9wKGUpCiAgICAgICAgICAgIH0sIHRoaXMuJGRvY3VtZW50Lm9uKHRoaXMuc3RvcEV2ZW50cywg
dGhpcy5vblN0b3BFdmVudHMpLCB0aGlzLm9uTW92ZUV2ZW50cyA9IGZ1bmN0aW9uKGUpIHsKICAg
ICAgICAgICAgICAgIHQubW92ZUV2ZW50ID0gZQogICAgICAgICAgICB9LCB0aGlzLiRkb2N1bWVu
dC5vbih0aGlzLm1vdmVUcmlnZ2VyLCB0aGlzLm9uTW92ZUV2ZW50cykKICAgICAgICB9LCBpLnBy
b3RvdHlwZS51bnN1YnNjcmliZSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICB0aGlzLiRlbC5v
ZmYodGhpcy5zdGFydFRyaWdnZXIsIHRoaXMub25TdGFydEV2ZW50KSwgdGhpcy4kZWwub2ZmKHRo
aXMuc3RhcnRUcmlnZ2VyLCB0aGlzLm9wdGlvbnMuZWxlbWVudHNXaXRoSW50ZXJhY3Rpb24sIHRo
aXMub25TdGFydEV2ZW50T25FbGVtZW50c1dpdGhJbnRlcmFjdGlvbiksIHRoaXMuJGRvY3VtZW50
Lm9mZih0aGlzLnN0b3BFdmVudHMsIHRoaXMub25TdG9wRXZlbnRzKSwgdGhpcy4kZG9jdW1lbnQu
b2ZmKHRoaXMubW92ZVRyaWdnZXIsIHRoaXMub25Nb3ZlRXZlbnRzKQogICAgICAgIH0sIGkucHJv
dG90eXBlLmhhbmRsZVN0YXJ0ID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICBpZiAoIXQuaWdu
b3JlUHJvcGFnYXRpb24pIHsKICAgICAgICAgICAgICAgIHZhciBlID0gdGhpczsKICAgICAgICAg
ICAgICAgIGlmICh0aGlzLmlzVmFsaWRNb3ZlRXZlbnQodCkgJiYgIXRoaXMuZGlzYWJsZWQgJiYg
KCF0aGlzLm9wdGlvbnMuaWdub3JlUmlnaHRDbGljayB8fCAzICE9PSB0LndoaWNoKSkgewogICAg
ICAgICAgICAgICAgICAgIHRoaXMuaXNQb2ludGVyRXZlbnRDb21wYXRpYmxlKCkgJiYgdC5wcmV2
ZW50TWFuaXB1bGF0aW9uICYmIHQucHJldmVudE1hbmlwdWxhdGlvbigpLCB0ID0gdGhpcy5ub3Jt
YWxpemVFdmVudCh0KSwgdGhpcy5vcHRpb25zLnBsYWNlICYmIHRoaXMub3B0aW9ucy5kZWZlclBs
YWNlbWVudCAmJiAodGhpcy5wb3NpdGlvblBhcmVudCgpLCB0aGlzLnBsYWNlT2JqZWN0KCkpLCB0
aGlzLmxvZyh7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJldmVudCIsCiAgICAgICAg
ICAgICAgICAgICAgICAgIGV2ZW50OiB0LnR5cGUKICAgICAgICAgICAgICAgICAgICB9KSwgdGhp
cy5vcHRpb25zLmhhcmR3YXJlQWNjZWxlcmF0ZSAmJiAhdGhpcy5oYXJkd2FyZUFjY2VsZXJhdGVk
ICYmICh0aGlzLmhhcmR3YXJlQWNjZWxlcmF0ZSgpLCB0aGlzLmhhcmR3YXJlQWNjZWxlcmF0ZWQg
PSAhMCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKCExID09PSB0aGlzLm9wdGlvbnMuaW5pdGlh
dGUuY2FsbCh0aGlzLCB0LCB0aGlzKSkgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIGNsZWFy
VGltZW91dCh0aGlzLnJlc3RUaW1lb3V0KSwgdGhpcy4kZWwuYWRkQ2xhc3ModGhpcy5vcHRpb25z
LmFjdGl2ZUNsYXNzKSwgdGhpcy5yZW1vdmVDU1NFYXNpbmcoKSwgdGhpcy5zdGFydFggPSB0aGlz
LmV2LnggPSB0LnBlcC54LCB0aGlzLnN0YXJ0WSA9IHRoaXMuZXYueSA9IHQucGVwLnksIHRoaXMu
aW5pdGlhbFBvc2l0aW9uID0gdGhpcy5pbml0aWFsUG9zaXRpb24gfHwgdGhpcy4kZWwucG9zaXRp
b24oKSwgdGhpcy5zdGFydEV2ZW50ID0gdGhpcy5tb3ZlRXZlbnQgPSB0LCB0aGlzLmFjdGl2ZSA9
ICEwLCB0aGlzLm9wdGlvbnMuc2hvdWxkUHJldmVudERlZmF1bHQgJiYgdC5wcmV2ZW50RGVmYXVs
dCgpLCB0aGlzLm9wdGlvbnMuYWxsb3dEcmFnRXZlbnRQcm9wYWdhdGlvbiB8fCB0LnN0b3BQcm9w
YWdhdGlvbigpLAogICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiB0KCkgewogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgZS5hY3RpdmUgJiYgKGUuaGFuZGxlTW92ZSgpLCBlLnJlcXVl
c3RBbmltYXRpb25GcmFtZSh0KSkKICAgICAgICAgICAgICAgICAgICAgICAgfSgpLAogICAgICAg
ICAgICAgICAgICAgICAgICBmdW5jdGlvbiB0KCkgewogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgZS5vcHRpb25zLmVhc2luZyAmJiAoZS5lYXNpbmcgJiYgZS5vcHRpb25zLmVhc2luZy5jYWxs
KGUsIG51bGwsIGUpLCBlLnJlcXVlc3RBbmltYXRpb25GcmFtZSh0KSkKICAgICAgICAgICAgICAg
ICAgICAgICAgfSgpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LCBp
LnByb3RvdHlwZS5oYW5kbGVNb3ZlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGlmICh2b2lk
IDAgIT09IHRoaXMubW92ZUV2ZW50KSB7CiAgICAgICAgICAgICAgICB2YXIgbiA9IHRoaXMubm9y
bWFsaXplRXZlbnQodGhpcy5tb3ZlRXZlbnQpLAogICAgICAgICAgICAgICAgICAgIGkgPSBlLnBh
cnNlSW50KG4ucGVwLnggLyB0aGlzLm9wdGlvbnMuZ3JpZFswXSkgKiB0aGlzLm9wdGlvbnMuZ3Jp
ZFswXSwKICAgICAgICAgICAgICAgICAgICBvID0gZS5wYXJzZUludChuLnBlcC55IC8gdGhpcy5v
cHRpb25zLmdyaWRbMV0pICogdGhpcy5vcHRpb25zLmdyaWRbMV07CiAgICAgICAgICAgICAgICB0
aGlzLmFkZFRvTElGTyh7CiAgICAgICAgICAgICAgICAgICAgdGltZTogbi50aW1lU3RhbXAsCiAg
ICAgICAgICAgICAgICAgICAgeDogaSwKICAgICAgICAgICAgICAgICAgICB5OiBvCiAgICAgICAg
ICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHZhciByLCBzOwogICAgICAgICAgICAgICAgaWYg
KHQuaW5BcnJheShuLnR5cGUsIHRoaXMuc3RhcnRUcmlnZ2VyQXJyYXkpID4gLTEgPyAociA9IDAs
IHMgPSAwKSA6IChyID0gaSAtIHRoaXMuZXYueCwgcyA9IG8gLSB0aGlzLmV2LnkpLCB0aGlzLmR4
ID0gciwgdGhpcy5keSA9IHMsIHRoaXMuZXYueCA9IGksIHRoaXMuZXYueSA9IG8sIDAgPT09IHIg
JiYgMCA9PT0gcykgcmV0dXJuIHZvaWQgdGhpcy5sb2coewogICAgICAgICAgICAgICAgICAgIHR5
cGU6ICJldmVudCIsCiAgICAgICAgICAgICAgICAgICAgZXZlbnQ6ICIqKiBzdG9wcGVkICoqIgog
ICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB2YXIgYSA9IE1hdGguYWJzKHRoaXMu
c3RhcnRYIC0gaSksCiAgICAgICAgICAgICAgICAgICAgdSA9IE1hdGguYWJzKHRoaXMuc3RhcnRZ
IC0gbyk7CiAgICAgICAgICAgICAgICAhdGhpcy5zdGFydGVkICYmIChhID4gdGhpcy5vcHRpb25z
LnN0YXJ0VGhyZXNob2xkWzBdIHx8IHUgPiB0aGlzLm9wdGlvbnMuc3RhcnRUaHJlc2hvbGRbMV0p
ICYmICh0aGlzLnN0YXJ0ZWQgPSAhMCwgdGhpcy4kZWwuYWRkQ2xhc3MoInBlcC1zdGFydCIpLCB0
aGlzLm9wdGlvbnMuc3RhcnQuY2FsbCh0aGlzLCB0aGlzLnN0YXJ0RXZlbnQsIHRoaXMpKSwgdGhp
cy5kb01vdmVUbyhyLCBzKSwgdGhpcy5vcHRpb25zLmRyb3BwYWJsZSAmJiB0aGlzLmNhbGN1bGF0
ZUFjdGl2ZURyb3BSZWdpb25zKCk7CiAgICAgICAgICAgICAgICBpZiAoITEgPT09IHRoaXMub3B0
aW9ucy5kcmFnLmNhbGwodGhpcywgbiwgdGhpcykpIHJldHVybiB2b2lkIHRoaXMucmVzZXRWZWxv
Y2l0eVF1ZXVlKCk7CiAgICAgICAgICAgICAgICB0aGlzLmxvZyh7CiAgICAgICAgICAgICAgICAg
ICAgdHlwZTogImV2ZW50IiwKICAgICAgICAgICAgICAgICAgICBldmVudDogbi50eXBlCiAgICAg
ICAgICAgICAgICB9KSwgdGhpcy5sb2coewogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJldmVu
dC1jb29yZHMiLAogICAgICAgICAgICAgICAgICAgIHg6IHRoaXMuZXYueCwKICAgICAgICAgICAg
ICAgICAgICB5OiB0aGlzLmV2LnkKICAgICAgICAgICAgICAgIH0pLCB0aGlzLmxvZyh7CiAgICAg
ICAgICAgICAgICAgICAgdHlwZTogInZlbG9jaXR5IgogICAgICAgICAgICAgICAgfSkKICAgICAg
ICAgICAgfQogICAgICAgIH0sIGkucHJvdG90eXBlLmRvTW92ZVRvID0gZnVuY3Rpb24odCwgZSkg
ewogICAgICAgICAgICB2YXIgbiwgaSwgbyA9IHRoaXMuaGFuZGxlQ29uc3RyYWludCh0LCBlKTsK
ICAgICAgICAgICAgImZ1bmN0aW9uIiA9PSB0eXBlb2YgdGhpcy5vcHRpb25zLm1vdmVUbyA/IChu
ID0gdCA+PSAwID8gIis9IiArIE1hdGguYWJzKHQgLyB0aGlzLnNjYWxlKSAqIHRoaXMub3B0aW9u
cy5tdWx0aXBsaWVyIDogIi09IiArIE1hdGguYWJzKHQgLyB0aGlzLnNjYWxlKSAqIHRoaXMub3B0
aW9ucy5tdWx0aXBsaWVyLCBpID0gZSA+PSAwID8gIis9IiArIE1hdGguYWJzKGUgLyB0aGlzLnNj
YWxlKSAqIHRoaXMub3B0aW9ucy5tdWx0aXBsaWVyIDogIi09IiArIE1hdGguYWJzKGUgLyB0aGlz
LnNjYWxlKSAqIHRoaXMub3B0aW9ucy5tdWx0aXBsaWVyLCB0aGlzLm9wdGlvbnMuY29uc3RyYWlu
VG8gJiYgKG4gPSAhMSAhPT0gby54ID8gby54IDogbiwgaSA9ICExICE9PSBvLnkgPyBvLnkgOiBp
KSwgIngiID09PSB0aGlzLm9wdGlvbnMuYXhpcyAmJiAoaSA9IG8ueSksICJ5IiA9PT0gdGhpcy5v
cHRpb25zLmF4aXMgJiYgKG4gPSBvLngpLCB0aGlzLm9wdGlvbnMubW92ZVRvLmNhbGwodGhpcywg
biwgaSkpIDogdGhpcy5zaG91bGRVc2VDU1NUcmFuc2xhdGlvbigpID8gKHQgPSB0IC8gdGhpcy5z
Y2FsZSAqIHRoaXMub3B0aW9ucy5tdWx0aXBsaWVyLCBlID0gZSAvIHRoaXMuc2NhbGUgKiB0aGlz
Lm9wdGlvbnMubXVsdGlwbGllciwgdGhpcy5vcHRpb25zLmNvbnN0cmFpblRvICYmICh0ID0gITEg
PT09IG8ueCA/IHQgOiAwLCBlID0gITEgPT09IG8ueSA/IGUgOiAwKSwgIngiID09PSB0aGlzLm9w
dGlvbnMuYXhpcyAmJiAoZSA9IDApLCAieSIgPT09IHRoaXMub3B0aW9ucy5heGlzICYmICh0ID0g
MCksIHRoaXMubW92ZVRvVXNpbmdUcmFuc2Zvcm1zKHQsIGUpKSA6IChuID0gdCA+PSAwID8gIis9
IiArIE1hdGguYWJzKHQgLyB0aGlzLnNjYWxlKSAqIHRoaXMub3B0aW9ucy5tdWx0aXBsaWVyIDog
Ii09IiArIE1hdGguYWJzKHQgLyB0aGlzLnNjYWxlKSAqIHRoaXMub3B0aW9ucy5tdWx0aXBsaWVy
LCBpID0gZSA+PSAwID8gIis9IiArIE1hdGguYWJzKGUgLyB0aGlzLnNjYWxlKSAqIHRoaXMub3B0
aW9ucy5tdWx0aXBsaWVyIDogIi09IiArIE1hdGguYWJzKGUgLyB0aGlzLnNjYWxlKSAqIHRoaXMu
b3B0aW9ucy5tdWx0aXBsaWVyLCB0aGlzLm9wdGlvbnMuY29uc3RyYWluVG8gJiYgKG4gPSAhMSAh
PT0gby54ID8gby54IDogbiwgaSA9ICExICE9PSBvLnkgPyBvLnkgOiBpKSwgIngiID09PSB0aGlz
Lm9wdGlvbnMuYXhpcyAmJiAoaSA9IG8ueSksICJ5IiA9PT0gdGhpcy5vcHRpb25zLmF4aXMgJiYg
KG4gPSBvLngpLCB0aGlzLm1vdmVUbyhuLCBpKSkKICAgICAgICB9LCBpLnByb3RvdHlwZS5oYW5k
bGVTdG9wID0gZnVuY3Rpb24oZSkgewogICAgICAgICAgICB0aGlzLmFjdGl2ZSAmJiAodGhpcy5s
b2coewogICAgICAgICAgICAgICAgdHlwZTogImV2ZW50IiwKICAgICAgICAgICAgICAgIGV2ZW50
OiBlLnR5cGUKICAgICAgICAgICAgfSksIHRoaXMuYWN0aXZlID0gITEsIHRoaXMuZWFzaW5nID0g
ITAsIHRoaXMuJGVsLnJlbW92ZUNsYXNzKCJwZXAtc3RhcnQiKS5hZGRDbGFzcygicGVwLWVhc2Ui
KSwgdGhpcy5vcHRpb25zLmRyb3BwYWJsZSAmJiB0aGlzLmNhbGN1bGF0ZUFjdGl2ZURyb3BSZWdp
b25zKCksICh0aGlzLnN0YXJ0ZWQgfHwgIXRoaXMuc3RhcnRlZCAmJiB0LmluQXJyYXkoInN0b3Ai
LCB0aGlzLm9wdGlvbnMuY2FsbElmTm90U3RhcnRlZCkgPiAtMSkgJiYgdGhpcy5vcHRpb25zLnN0
b3AuY2FsbCh0aGlzLCBlLCB0aGlzKSwgdGhpcy5vcHRpb25zLnNob3VsZEVhc2UgPyB0aGlzLmVh
c2UoZSwgdGhpcy5zdGFydGVkKSA6IHRoaXMucmVtb3ZlQWN0aXZlQ2xhc3MoKSwgdGhpcy5vcHRp
b25zLnJldmVydCAmJiAoInN0b3AiID09PSB0aGlzLm9wdGlvbnMucmV2ZXJ0QWZ0ZXIgfHwgIXRo
aXMub3B0aW9ucy5zaG91bGRFYXNlKSAmJiB0aGlzLm9wdGlvbnMucmV2ZXJ0SWYgJiYgdGhpcy5v
cHRpb25zLnJldmVydElmLmNhbGwodGhpcykgJiYgdGhpcy5yZXZlcnQoKSwgdGhpcy5zdGFydGVk
ID0gITEsIHRoaXMucmVzZXRWZWxvY2l0eVF1ZXVlKCkpCiAgICAgICAgfSwgaS5wcm90b3R5cGUu
ZWFzZSA9IGZ1bmN0aW9uKGUsIG4pIHsKICAgICAgICAgICAgdmFyIGkgPSAodGhpcy4kZWwucG9z
aXRpb24oKSwgdGhpcy52ZWxvY2l0eSgpKSwKICAgICAgICAgICAgICAgIG8gPSAodGhpcy5kdCwg
aS54IC8gdGhpcy5zY2FsZSAqIHRoaXMub3B0aW9ucy5tdWx0aXBsaWVyKSwKICAgICAgICAgICAg
ICAgIHIgPSBpLnkgLyB0aGlzLnNjYWxlICogdGhpcy5vcHRpb25zLm11bHRpcGxpZXIsCiAgICAg
ICAgICAgICAgICBzID0gdGhpcy5oYW5kbGVDb25zdHJhaW50KG8sIHIsICEwKTsKICAgICAgICAg
ICAgdGhpcy5jc3NBbmltYXRpb25zU3VwcG9ydGVkKCkgJiYgdGhpcy4kZWwuY3NzKHRoaXMuZ2V0
Q1NTRWFzZUhhc2goKSk7CiAgICAgICAgICAgIHZhciBhID0gaS54ID4gMCA/ICIrPSIgKyBvIDog
Ii09IiArIE1hdGguYWJzKG8pLAogICAgICAgICAgICAgICAgdSA9IGkueSA+IDAgPyAiKz0iICsg
ciA6ICItPSIgKyBNYXRoLmFicyhyKTsKICAgICAgICAgICAgdGhpcy5vcHRpb25zLmNvbnN0cmFp
blRvICYmIChhID0gITEgIT09IHMueCA/IHMueCA6IGEsIHUgPSAhMSAhPT0gcy55ID8gcy55IDog
dSksICJ4IiA9PT0gdGhpcy5vcHRpb25zLmF4aXMgJiYgKHUgPSAiKz0wIiksICJ5IiA9PT0gdGhp
cy5vcHRpb25zLmF4aXMgJiYgKGEgPSAiKz0wIik7CiAgICAgICAgICAgIHZhciBsID0gIXRoaXMu
Y3NzQW5pbWF0aW9uc1N1cHBvcnRlZCgpIHx8IHRoaXMub3B0aW9ucy5mb3JjZU5vbkNTUzNNb3Zl
bWVudDsKICAgICAgICAgICAgImZ1bmN0aW9uIiA9PSB0eXBlb2YgdGhpcy5vcHRpb25zLm1vdmVU
byA/IHRoaXMub3B0aW9ucy5tb3ZlVG8uY2FsbCh0aGlzLCBhLCB1KSA6IHRoaXMubW92ZVRvKGEs
IHUsIGwpOwogICAgICAgICAgICB2YXIgYyA9IHRoaXM7CiAgICAgICAgICAgIHRoaXMucmVzdFRp
bWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgYy5vcHRpb25z
LmRyb3BwYWJsZSAmJiBjLmNhbGN1bGF0ZUFjdGl2ZURyb3BSZWdpb25zKCksIGMuZWFzaW5nID0g
ITEsIChuIHx8ICFuICYmIHQuaW5BcnJheSgicmVzdCIsIGMub3B0aW9ucy5jYWxsSWZOb3RTdGFy
dGVkKSA+IC0xKSAmJiBjLm9wdGlvbnMucmVzdC5jYWxsKGMsIGUsIGMpLCBjLm9wdGlvbnMucmV2
ZXJ0ICYmICJlYXNlIiA9PT0gYy5vcHRpb25zLnJldmVydEFmdGVyICYmIGMub3B0aW9ucy5zaG91
bGRFYXNlICYmIGMub3B0aW9ucy5yZXZlcnRJZiAmJiBjLm9wdGlvbnMucmV2ZXJ0SWYuY2FsbChj
KSAmJiBjLnJldmVydCgpLCBjLnJlbW92ZUFjdGl2ZUNsYXNzKCkKICAgICAgICAgICAgfSwgdGhp
cy5vcHRpb25zLmNzc0Vhc2VEdXJhdGlvbikKICAgICAgICB9LCBpLnByb3RvdHlwZS5ub3JtYWxp
emVFdmVudCA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgcmV0dXJuIHQucGVwID0ge30sIHRo
aXMuaXNUb3VjaCh0KSA/ICh0LnBlcC54ID0gdC5vcmlnaW5hbEV2ZW50LnRvdWNoZXNbMF0ucGFn
ZVgsIHQucGVwLnkgPSB0Lm9yaWdpbmFsRXZlbnQudG91Y2hlc1swXS5wYWdlWSwgdC5wZXAudHlw
ZSA9IHQudHlwZSkgOiAhdGhpcy5pc1BvaW50ZXJFdmVudENvbXBhdGlibGUoKSAmJiB0aGlzLmlz
VG91Y2godCkgfHwgKHQucGFnZVggPyAodC5wZXAueCA9IHQucGFnZVgsIHQucGVwLnkgPSB0LnBh
Z2VZKSA6ICh0LnBlcC54ID0gdC5vcmlnaW5hbEV2ZW50LnBhZ2VYLCB0LnBlcC55ID0gdC5vcmln
aW5hbEV2ZW50LnBhZ2VZKSwgdC5wZXAudHlwZSA9IHQudHlwZSksIHQKICAgICAgICB9LCBpLnBy
b3RvdHlwZS5yZXNldFZlbG9jaXR5UXVldWUgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgdGhp
cy52ZWxvY2l0eVF1ZXVlID0gbmV3IEFycmF5KDUpCiAgICAgICAgfSwgaS5wcm90b3R5cGUubW92
ZVRvID0gZnVuY3Rpb24odCwgZSwgbikgewogICAgICAgICAgICB0aGlzLmxvZyh7CiAgICAgICAg
ICAgICAgICB0eXBlOiAiZGVsdGEiLAogICAgICAgICAgICAgICAgeDogdCwKICAgICAgICAgICAg
ICAgIHk6IGUKICAgICAgICAgICAgfSksIG4gPyB0aGlzLiRlbC5hbmltYXRlKHsKICAgICAgICAg
ICAgICAgIHRvcDogZSwKICAgICAgICAgICAgICAgIGxlZnQ6IHQKICAgICAgICAgICAgfSwgMCwg
ImVhc2VPdXRRdWFkIiwgewogICAgICAgICAgICAgICAgcXVldWU6ICExCiAgICAgICAgICAgIH0p
IDogdGhpcy4kZWwuc3RvcCghMCwgITEpLmNzcyh7CiAgICAgICAgICAgICAgICB0b3A6IGUsCiAg
ICAgICAgICAgICAgICBsZWZ0OiB0CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwgaS5wcm90b3R5
cGUubW92ZVRvVXNpbmdUcmFuc2Zvcm1zID0gZnVuY3Rpb24odCwgZSkgewogICAgICAgICAgICB2
YXIgbiA9IHRoaXMubWF0cml4VG9BcnJheSh0aGlzLm1hdHJpeFN0cmluZygpKTsKICAgICAgICAg
ICAgdGhpcy5jc3NYIHx8ICh0aGlzLmNzc1ggPSB0aGlzLnhUcmFuc2xhdGlvbihuKSksIHRoaXMu
Y3NzWSB8fCAodGhpcy5jc3NZID0gdGhpcy55VHJhbnNsYXRpb24obikpLCB0aGlzLmNzc1ggPSB0
aGlzLmNzc1ggKyB0LCB0aGlzLmNzc1kgPSB0aGlzLmNzc1kgKyBlLCB0aGlzLmxvZyh7CiAgICAg
ICAgICAgICAgICB0eXBlOiAiZGVsdGEiLAogICAgICAgICAgICAgICAgeDogdCwKICAgICAgICAg
ICAgICAgIHk6IGUKICAgICAgICAgICAgfSksIG5bNF0gPSB0aGlzLmNzc1gsIG5bNV0gPSB0aGlz
LmNzc1ksIHRoaXMudHJhbnNsYXRpb24gPSB0aGlzLmFycmF5VG9NYXRyaXgobiksIHRoaXMudHJh
bnNmb3JtKHRoaXMudHJhbnNsYXRpb24pCiAgICAgICAgfSwgaS5wcm90b3R5cGUudHJhbnNmb3Jt
ID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICB0aGlzLiRlbC5jc3MoewogICAgICAgICAgICAg
ICAgIi13ZWJraXQtdHJhbnNmb3JtIjogdCwKICAgICAgICAgICAgICAgICItbW96LXRyYW5zZm9y
bSI6IHQsCiAgICAgICAgICAgICAgICAiLW1zLXRyYW5zZm9ybSI6IHQsCiAgICAgICAgICAgICAg
ICAiLW8tdHJhbnNmb3JtIjogdCwKICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogdAogICAgICAg
ICAgICB9KQogICAgICAgIH0sIGkucHJvdG90eXBlLnhUcmFuc2xhdGlvbiA9IGZ1bmN0aW9uKHQp
IHsKICAgICAgICAgICAgcmV0dXJuIHQgPSB0IHx8IHRoaXMubWF0cml4VG9BcnJheSh0aGlzLm1h
dHJpeFN0cmluZygpKSwgcGFyc2VJbnQodFs0XSwgMTApCiAgICAgICAgfSwgaS5wcm90b3R5cGUu
eVRyYW5zbGF0aW9uID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICByZXR1cm4gdCA9IHQgfHwg
dGhpcy5tYXRyaXhUb0FycmF5KHRoaXMubWF0cml4U3RyaW5nKCkpLCBwYXJzZUludCh0WzVdLCAx
MCkKICAgICAgICB9LCBpLnByb3RvdHlwZS5tYXRyaXhTdHJpbmcgPSBmdW5jdGlvbigpIHsKICAg
ICAgICAgICAgdmFyIHQgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJu
ICEoIXQgfHwgIm5vbmUiID09PSB0IHx8IHQuaW5kZXhPZigibWF0cml4IikgPCAwKQogICAgICAg
ICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGUgPSAibWF0cml4KDEsIDAsIDAsIDEsIDAsIDAp
IjsKICAgICAgICAgICAgcmV0dXJuIHQodGhpcy4kZWwuY3NzKCItd2Via2l0LXRyYW5zZm9ybSIp
KSAmJiAoZSA9IHRoaXMuJGVsLmNzcygiLXdlYmtpdC10cmFuc2Zvcm0iKSksIHQodGhpcy4kZWwu
Y3NzKCItbW96LXRyYW5zZm9ybSIpKSAmJiAoZSA9IHRoaXMuJGVsLmNzcygiLW1vei10cmFuc2Zv
cm0iKSksIHQodGhpcy4kZWwuY3NzKCItbXMtdHJhbnNmb3JtIikpICYmIChlID0gdGhpcy4kZWwu
Y3NzKCItbXMtdHJhbnNmb3JtIikpLCB0KHRoaXMuJGVsLmNzcygiLW8tdHJhbnNmb3JtIikpICYm
IChlID0gdGhpcy4kZWwuY3NzKCItby10cmFuc2Zvcm0iKSksIHQodGhpcy4kZWwuY3NzKCJ0cmFu
c2Zvcm0iKSkgJiYgKGUgPSB0aGlzLiRlbC5jc3MoInRyYW5zZm9ybSIpKSwgZQogICAgICAgIH0s
IGkucHJvdG90eXBlLm1hdHJpeFRvQXJyYXkgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgIHJl
dHVybiB0LnNwbGl0KCIoIilbMV0uc3BsaXQoIikiKVswXS5zcGxpdCgiLCIpCiAgICAgICAgfSwg
aS5wcm90b3R5cGUuYXJyYXlUb01hdHJpeCA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgcmV0
dXJuICJtYXRyaXgoIiArIHQuam9pbigiLCIpICsgIikiCiAgICAgICAgfSwgaS5wcm90b3R5cGUu
YWRkVG9MSUZPID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICB2YXIgZSA9IHRoaXMudmVsb2Np
dHlRdWV1ZTsKICAgICAgICAgICAgZSA9IGUuc2xpY2UoMSwgZS5sZW5ndGgpLCBlLnB1c2godCks
IHRoaXMudmVsb2NpdHlRdWV1ZSA9IGUKICAgICAgICB9LCBpLnByb3RvdHlwZS52ZWxvY2l0eSA9
IGZ1bmN0aW9uKCkgewogICAgICAgICAgICBmb3IgKHZhciB0ID0gMCwgZSA9IDAsIG4gPSAwOyBu
IDwgdGhpcy52ZWxvY2l0eVF1ZXVlLmxlbmd0aCAtIDE7IG4rKykgdGhpcy52ZWxvY2l0eVF1ZXVl
W25dICYmICh0ICs9IHRoaXMudmVsb2NpdHlRdWV1ZVtuICsgMV0ueCAtIHRoaXMudmVsb2NpdHlR
dWV1ZVtuXS54LCBlICs9IHRoaXMudmVsb2NpdHlRdWV1ZVtuICsgMV0ueSAtIHRoaXMudmVsb2Np
dHlRdWV1ZVtuXS55LCB0aGlzLmR0ID0gdGhpcy52ZWxvY2l0eVF1ZXVlW24gKyAxXS50aW1lIC0g
dGhpcy52ZWxvY2l0eVF1ZXVlW25dLnRpbWUpOwogICAgICAgICAgICByZXR1cm4gewogICAgICAg
ICAgICAgICAgeDogdCAqIHRoaXMub3B0aW9ucy52ZWxvY2l0eU11bHRpcGxpZXIsCiAgICAgICAg
ICAgICAgICB5OiBlICogdGhpcy5vcHRpb25zLnZlbG9jaXR5TXVsdGlwbGllcgogICAgICAgICAg
ICB9CiAgICAgICAgfSwgaS5wcm90b3R5cGUucmV2ZXJ0ID0gZnVuY3Rpb24oKSB7CiAgICAgICAg
ICAgIHRoaXMuc2hvdWxkVXNlQ1NTVHJhbnNsYXRpb24oKSAmJiB0aGlzLm1vdmVUb1VzaW5nVHJh
bnNmb3JtcygtdGhpcy54VHJhbnNsYXRpb24oKSwgLXRoaXMueVRyYW5zbGF0aW9uKCkpLCB0aGlz
Lm9wdGlvbnMucGxhY2UgJiYgdGhpcy5tb3ZlVG8odGhpcy5pbml0aWFsUG9zaXRpb24ubGVmdCwg
dGhpcy5pbml0aWFsUG9zaXRpb24udG9wKQogICAgICAgIH0sIGkucHJvdG90eXBlLnJlcXVlc3RB
bmltYXRpb25GcmFtZSA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgcmV0dXJuIGUucmVxdWVz
dEFuaW1hdGlvbkZyYW1lICYmIGUucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHQpIHx8IGUud2Via2l0
UmVxdWVzdEFuaW1hdGlvbkZyYW1lICYmIGUud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lKHQp
IHx8IGUubW96UmVxdWVzdEFuaW1hdGlvbkZyYW1lICYmIGUubW96UmVxdWVzdEFuaW1hdGlvbkZy
YW1lKHQpIHx8IGUub1JlcXVlc3RBbmltYXRpb25GcmFtZSAmJiBlLm1velJlcXVlc3RBbmltYXRp
b25GcmFtZSh0KSB8fCBlLm1zUmVxdWVzdEFuaW1hdGlvbkZyYW1lICYmIGUubXNSZXF1ZXN0QW5p
bWF0aW9uRnJhbWUodCkgfHwgZS5zZXRUaW1lb3V0KHQsIDFlMyAvIDYwKQogICAgICAgIH0sIGku
cHJvdG90eXBlLnBvc2l0aW9uUGFyZW50ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHRoaXMu
b3B0aW9ucy5jb25zdHJhaW5UbyAmJiAhdGhpcy5wYXJlbnRQb3NpdGlvbmVkICYmICh0aGlzLnBh
cmVudFBvc2l0aW9uZWQgPSAhMCwgInBhcmVudCIgPT09IHRoaXMub3B0aW9ucy5jb25zdHJhaW5U
byA/IHRoaXMuJGNvbnRhaW5lci5jc3MoewogICAgICAgICAgICAgICAgcG9zaXRpb246ICJyZWxh
dGl2ZSIKICAgICAgICAgICAgfSkgOiAid2luZG93IiA9PT0gdGhpcy5vcHRpb25zLmNvbnN0cmFp
blRvICYmICIjZG9jdW1lbnQiICE9PSB0aGlzLiRjb250YWluZXIuZ2V0KDApLm5vZGVOYW1lICYm
ICJzdGF0aWMiICE9PSB0aGlzLiRjb250YWluZXIuY3NzKCJwb3NpdGlvbiIpICYmIHRoaXMuJGNv
bnRhaW5lci5jc3MoewogICAgICAgICAgICAgICAgcG9zaXRpb246ICJzdGF0aWMiCiAgICAgICAg
ICAgIH0pKQogICAgICAgIH0sIGkucHJvdG90eXBlLnBsYWNlT2JqZWN0ID0gZnVuY3Rpb24oKSB7
CiAgICAgICAgICAgIHRoaXMub2JqZWN0UGxhY2VkIHx8ICh0aGlzLm9iamVjdFBsYWNlZCA9ICEw
LCB0aGlzLm9mZnNldCA9ICJwYXJlbnQiID09PSB0aGlzLm9wdGlvbnMuY29uc3RyYWluVG8gfHwg
dGhpcy5oYXNOb25Cb2R5UmVsYXRpdmUoKSA/IHRoaXMuJGVsLnBvc2l0aW9uKCkgOiB0aGlzLiRl
bC5vZmZzZXQoKSwgcGFyc2VJbnQodGhpcy4kZWwuY3NzKCJsZWZ0IiksIDEwKSAmJiAodGhpcy5v
ZmZzZXQubGVmdCA9IHRoaXMuJGVsLmNzcygibGVmdCIpKSwgIm51bWJlciIgPT0gdHlwZW9mIHRo
aXMub3B0aW9ucy5zdGFydFBvcy5sZWZ0ICYmICh0aGlzLm9mZnNldC5sZWZ0ID0gdGhpcy5vcHRp
b25zLnN0YXJ0UG9zLmxlZnQpLCBwYXJzZUludCh0aGlzLiRlbC5jc3MoInRvcCIpLCAxMCkgJiYg
KHRoaXMub2Zmc2V0LnRvcCA9IHRoaXMuJGVsLmNzcygidG9wIikpLCAibnVtYmVyIiA9PSB0eXBl
b2YgdGhpcy5vcHRpb25zLnN0YXJ0UG9zLnRvcCAmJiAodGhpcy5vZmZzZXQudG9wID0gdGhpcy5v
cHRpb25zLnN0YXJ0UG9zLnRvcCksIHRoaXMub3B0aW9ucy5yZW1vdmVNYXJnaW5zICYmIHRoaXMu
JGVsLmNzcyh7CiAgICAgICAgICAgICAgICBtYXJnaW46IDAKICAgICAgICAgICAgfSksIHRoaXMu
JGVsLmNzcyh7CiAgICAgICAgICAgICAgICBwb3NpdGlvbjogImFic29sdXRlIiwKICAgICAgICAg
ICAgICAgIHRvcDogdGhpcy5vZmZzZXQudG9wLAogICAgICAgICAgICAgICAgbGVmdDogdGhpcy5v
ZmZzZXQubGVmdAogICAgICAgICAgICB9KSkKICAgICAgICB9LCBpLnByb3RvdHlwZS5oYXNOb25C
b2R5UmVsYXRpdmUgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGVsLnBh
cmVudHMoKS5maWx0ZXIoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB2YXIgZSA9IHQodGhp
cyk7CiAgICAgICAgICAgICAgICByZXR1cm4gZS5pcygiYm9keSIpIHx8ICJyZWxhdGl2ZSIgPT09
IGUuY3NzKCJwb3NpdGlvbiIpCiAgICAgICAgICAgIH0pLmxlbmd0aCA+IDEKICAgICAgICB9LCBp
LnByb3RvdHlwZS5zZXRTY2FsZSA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgdGhpcy5zY2Fs
ZSA9IHQKICAgICAgICB9LCBpLnByb3RvdHlwZS5zZXRNdWx0aXBsaWVyID0gZnVuY3Rpb24odCkg
ewogICAgICAgICAgICB0aGlzLm9wdGlvbnMubXVsdGlwbGllciA9IHQKICAgICAgICB9LCBpLnBy
b3RvdHlwZS5yZW1vdmVDU1NFYXNpbmcgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgdGhpcy5j
c3NBbmltYXRpb25zU3VwcG9ydGVkKCkgJiYgdGhpcy4kZWwuY3NzKHRoaXMuZ2V0Q1NTRWFzZUhh
c2goITApKQogICAgICAgIH0sIGkucHJvdG90eXBlLmRpc2FibGVTZWxlY3QgPSBmdW5jdGlvbigp
IHsKICAgICAgICAgICAgdGhpcy4kZWwuY3NzKHsKICAgICAgICAgICAgICAgICItd2Via2l0LXRv
dWNoLWNhbGxvdXQiOiAibm9uZSIsCiAgICAgICAgICAgICAgICAiLXdlYmtpdC11c2VyLXNlbGVj
dCI6ICJub25lIiwKICAgICAgICAgICAgICAgICIta2h0bWwtdXNlci1zZWxlY3QiOiAibm9uZSIs
CiAgICAgICAgICAgICAgICAiLW1vei11c2VyLXNlbGVjdCI6ICJub25lIiwKICAgICAgICAgICAg
ICAgICItbXMtdXNlci1zZWxlY3QiOiAibm9uZSIsCiAgICAgICAgICAgICAgICAidXNlci1zZWxl
Y3QiOiAibm9uZSIKICAgICAgICAgICAgfSkKICAgICAgICB9LCBpLnByb3RvdHlwZS5yZW1vdmVB
Y3RpdmVDbGFzcyA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICB0aGlzLiRlbC5yZW1vdmVDbGFz
cyhbdGhpcy5vcHRpb25zLmFjdGl2ZUNsYXNzLCAicGVwLWVhc2UiXS5qb2luKCIgIikpCiAgICAg
ICAgfSwgaS5wcm90b3R5cGUuaGFuZGxlQ29uc3RyYWludCA9IGZ1bmN0aW9uKGUsIG4sIGkpIHsK
ICAgICAgICAgICAgdmFyIG8gPSB0aGlzLiRlbC5wb3NpdGlvbigpOwogICAgICAgICAgICB0aGlz
LnBvcy54ID0gby5sZWZ0LCB0aGlzLnBvcy55ID0gby50b3A7CiAgICAgICAgICAgIHZhciByLCBz
LCBhLCB1LCBsID0gewogICAgICAgICAgICAgICAgeDogITEsCiAgICAgICAgICAgICAgICB5OiAh
MQogICAgICAgICAgICB9OwogICAgICAgICAgICByZXR1cm4gdGhpcy5sb2coewogICAgICAgICAg
ICAgICAgdHlwZTogInBvcy1jb29yZHMiLAogICAgICAgICAgICAgICAgeDogdGhpcy5wb3MueCwK
ICAgICAgICAgICAgICAgIHk6IHRoaXMucG9zLnkKICAgICAgICAgICAgfSksIHQuaXNBcnJheSh0
aGlzLm9wdGlvbnMuY29uc3RyYWluVG8pID8gKHZvaWQgMCAhPT0gdGhpcy5vcHRpb25zLmNvbnN0
cmFpblRvWzNdICYmIHZvaWQgMCAhPT0gdGhpcy5vcHRpb25zLmNvbnN0cmFpblRvWzFdICYmIChz
ID0gITEgPT09IHRoaXMub3B0aW9ucy5jb25zdHJhaW5Ub1sxXSA/IDEgLyAwIDogdGhpcy5vcHRp
b25zLmNvbnN0cmFpblRvWzFdLCBhID0gITEgPT09IHRoaXMub3B0aW9ucy5jb25zdHJhaW5Ub1sz
XSA/IC0xIC8gMCA6IHRoaXMub3B0aW9ucy5jb25zdHJhaW5Ub1szXSksICExICE9PSB0aGlzLm9w
dGlvbnMuY29uc3RyYWluVG9bMF0gJiYgITEgIT09IHRoaXMub3B0aW9ucy5jb25zdHJhaW5Ub1sy
XSAmJiAociA9ICExID09PSB0aGlzLm9wdGlvbnMuY29uc3RyYWluVG9bMl0gPyAxIC8gMCA6IHRo
aXMub3B0aW9ucy5jb25zdHJhaW5Ub1syXSwgdSA9ICExID09PSB0aGlzLm9wdGlvbnMuY29uc3Ry
YWluVG9bMF0gPyAtMSAvIDAgOiB0aGlzLm9wdGlvbnMuY29uc3RyYWluVG9bMF0pLCB0aGlzLnBv
cy54ICsgZSA8IGEgJiYgKGwueCA9IGEpLCB0aGlzLnBvcy55ICsgbiA8IHUgJiYgKGwueSA9IHUp
KSA6ICJzdHJpbmciID09IHR5cGVvZiB0aGlzLm9wdGlvbnMuY29uc3RyYWluVG8gJiYgKGEgPSAw
LCB1ID0gMCwgcyA9IHRoaXMuJGNvbnRhaW5lci53aWR0aCgpIC0gKHRoaXMub3B0aW9ucy51c2VC
b3VuZGluZ0NsaWVudFJlY3QgPyB0aGlzLiRlbFswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53
aWR0aCA6IHRoaXMuJGVsLm91dGVyV2lkdGgoKSksIHIgPSB0aGlzLiRjb250YWluZXIuaGVpZ2h0
KCkgLSAodGhpcy5vcHRpb25zLnVzZUJvdW5kaW5nQ2xpZW50UmVjdCA/IHRoaXMuJGVsWzBdLmdl
dEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodCA6IHRoaXMuJGVsLm91dGVySGVpZ2h0KCkpLCB0
aGlzLnBvcy54ICsgZSA8IDAgJiYgKGwueCA9IDApLCB0aGlzLnBvcy55ICsgbiA8IDAgJiYgKGwu
eSA9IDApKSwgdGhpcy5wb3MueCArIGUgPiBzICYmIChsLnggPSBzKSwgdGhpcy5wb3MueSArIG4g
PiByICYmIChsLnkgPSByKSwgdGhpcy5zaG91bGRVc2VDU1NUcmFuc2xhdGlvbigpICYmIGkgJiYg
KGwueCA9PT0gYSAmJiB0aGlzLnhUcmFuc2xhdGlvbigpICYmIChsLnggPSBhIC0gdGhpcy54VHJh
bnNsYXRpb24oKSksIGwueCA9PT0gcyAmJiB0aGlzLnhUcmFuc2xhdGlvbigpICYmIChsLnggPSBz
IC0gdGhpcy54VHJhbnNsYXRpb24oKSksIGwueSA9PT0gdSAmJiB0aGlzLnlUcmFuc2xhdGlvbigp
ICYmIChsLnkgPSB1IC0gdGhpcy55VHJhbnNsYXRpb24oKSksIGwueSA9PT0gciAmJiB0aGlzLnlU
cmFuc2xhdGlvbigpICYmIChsLnkgPSByIC0gdGhpcy55VHJhbnNsYXRpb24oKSkpLCBsCiAgICAg
ICAgfSwgaS5wcm90b3R5cGUuZ2V0Q1NTRWFzZUhhc2ggPSBmdW5jdGlvbih0KSB7CiAgICAgICAg
ICAgIHZvaWQgMCA9PT0gdCAmJiAodCA9ICExKTsKICAgICAgICAgICAgdmFyIGU7CiAgICAgICAg
ICAgIGlmICh0KSBlID0gIiI7CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgaWYg
KHRoaXMuQ1NTRWFzZUhhc2gpIHJldHVybiB0aGlzLkNTU0Vhc2VIYXNoOwogICAgICAgICAgICAg
ICAgZSA9IFsiYWxsIiwgdGhpcy5vcHRpb25zLmNzc0Vhc2VEdXJhdGlvbiArICJtcyIsIHRoaXMu
b3B0aW9ucy5jc3NFYXNlU3RyaW5nXS5qb2luKCIgIikKICAgICAgICAgICAgfQogICAgICAgICAg
ICByZXR1cm4gewogICAgICAgICAgICAgICAgIi13ZWJraXQtdHJhbnNpdGlvbiI6IGUsCiAgICAg
ICAgICAgICAgICAiLW1vei10cmFuc2l0aW9uIjogZSwKICAgICAgICAgICAgICAgICItbXMtdHJh
bnNpdGlvbiI6IGUsCiAgICAgICAgICAgICAgICAiLW8tdHJhbnNpdGlvbiI6IGUsCiAgICAgICAg
ICAgICAgICB0cmFuc2l0aW9uOiBlCiAgICAgICAgICAgIH0KICAgICAgICB9LCBpLnByb3RvdHlw
ZS5jYWxjdWxhdGVBY3RpdmVEcm9wUmVnaW9ucyA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICB2
YXIgZSA9IHRoaXM7CiAgICAgICAgICAgIHRoaXMuYWN0aXZlRHJvcFJlZ2lvbnMubGVuZ3RoID0g
MCwgdC5lYWNoKHQodGhpcy5vcHRpb25zLmRyb3BwYWJsZSksIGZ1bmN0aW9uKG4sIGkpIHsKICAg
ICAgICAgICAgICAgIHZhciBvID0gdChpKTsKICAgICAgICAgICAgICAgIGUuaXNPdmVybGFwcGlu
ZyhvLCBlLiRlbCkgPyAoby5hZGRDbGFzcyhlLm9wdGlvbnMuZHJvcHBhYmxlQWN0aXZlQ2xhc3Mp
LCBlLmFjdGl2ZURyb3BSZWdpb25zLnB1c2gobykpIDogby5yZW1vdmVDbGFzcyhlLm9wdGlvbnMu
ZHJvcHBhYmxlQWN0aXZlQ2xhc3MpCiAgICAgICAgICAgIH0pCiAgICAgICAgfSwgaS5wcm90b3R5
cGUuaXNPdmVybGFwcGluZyA9IGZ1bmN0aW9uKHQsIGUpIHsKICAgICAgICAgICAgaWYgKHRoaXMu
b3B0aW9ucy5vdmVybGFwRnVuY3Rpb24pIHJldHVybiB0aGlzLm9wdGlvbnMub3ZlcmxhcEZ1bmN0
aW9uKHQsIGUpOwogICAgICAgICAgICB2YXIgbiA9IHRbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0
KCksCiAgICAgICAgICAgICAgICBpID0gZVswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAg
ICAgICAgICAgcmV0dXJuICEobi5yaWdodCA8IGkubGVmdCB8fCBuLmxlZnQgPiBpLnJpZ2h0IHx8
IG4uYm90dG9tIDwgaS50b3AgfHwgbi50b3AgPiBpLmJvdHRvbSkKICAgICAgICB9LCBpLnByb3Rv
dHlwZS5pc1RvdWNoID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICByZXR1cm4gdC50eXBlLnNl
YXJjaCgidG91Y2giKSA+IC0xCiAgICAgICAgfSwgaS5wcm90b3R5cGUuaXNQb2ludGVyRXZlbnRD
b21wYXRpYmxlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHJldHVybiAiTVNQb2ludGVyRXZl
bnQiIGluIGUKICAgICAgICB9LCBpLnByb3RvdHlwZS5hcHBseU1TRGVmYXVsdHMgPSBmdW5jdGlv
bih0KSB7CiAgICAgICAgICAgIHRoaXMuJGVsLmNzcyh7CiAgICAgICAgICAgICAgICAiLW1zLXRv
dWNoLWFjdGlvbiI6ICJub25lIiwKICAgICAgICAgICAgICAgICJ0b3VjaC1hY3Rpb24iOiAibm9u
ZSIsCiAgICAgICAgICAgICAgICAiLW1zLXNjcm9sbC1jaGFpbmluZyI6ICJub25lIiwKICAgICAg
ICAgICAgICAgICItbXMtc2Nyb2xsLWxpbWl0IjogIjAgMCAwIDAiCiAgICAgICAgICAgIH0pCiAg
ICAgICAgfSwgaS5wcm90b3R5cGUuaXNWYWxpZE1vdmVFdmVudCA9IGZ1bmN0aW9uKHQpIHsKICAg
ICAgICAgICAgcmV0dXJuICF0aGlzLmlzVG91Y2godCkgfHwgdGhpcy5pc1RvdWNoKHQpICYmIHQu
b3JpZ2luYWxFdmVudCAmJiB0Lm9yaWdpbmFsRXZlbnQudG91Y2hlcyAmJiAxID09PSB0Lm9yaWdp
bmFsRXZlbnQudG91Y2hlcy5sZW5ndGgKICAgICAgICB9LCBpLnByb3RvdHlwZS5zaG91bGRVc2VD
U1NUcmFuc2xhdGlvbiA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICBpZiAodGhpcy5vcHRpb25z
LmZvcmNlTm9uQ1NTM01vdmVtZW50KSByZXR1cm4gITE7CiAgICAgICAgICAgIGlmICh2b2lkIDAg
IT09IHRoaXMudXNlQ1NTVHJhbnNsYXRpb24pIHJldHVybiB0aGlzLnVzZUNTU1RyYW5zbGF0aW9u
OwogICAgICAgICAgICB2YXIgdCA9ICExOwogICAgICAgICAgICByZXR1cm4gdCA9ICEoIXRoaXMu
b3B0aW9ucy51c2VDU1NUcmFuc2xhdGlvbiB8fCAidW5kZWZpbmVkIiAhPSB0eXBlb2YgTW9kZXJu
aXpyICYmICFNb2Rlcm5penIuY3NzdHJhbnNmb3JtcyksIHRoaXMudXNlQ1NTVHJhbnNsYXRpb24g
PSB0LCB0CiAgICAgICAgfSwgaS5wcm90b3R5cGUuY3NzQW5pbWF0aW9uc1N1cHBvcnRlZCA9IGZ1
bmN0aW9uKCkgewogICAgICAgICAgICBpZiAodm9pZCAwICE9PSB0aGlzLmNzc0FuaW1hdGlvbnNT
dXBwb3J0KSByZXR1cm4gdGhpcy5jc3NBbmltYXRpb25zU3VwcG9ydDsKICAgICAgICAgICAgaWYg
KCJ1bmRlZmluZWQiICE9IHR5cGVvZiBNb2Rlcm5penIgJiYgTW9kZXJuaXpyLmNzc2FuaW1hdGlv
bnMpIHJldHVybiB0aGlzLmNzc0FuaW1hdGlvbnNTdXBwb3J0ID0gITAsICEwOwogICAgICAgICAg
ICB2YXIgdCA9ICExLAogICAgICAgICAgICAgICAgZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQo
ImRpdiIpLAogICAgICAgICAgICAgICAgbiA9ICJXZWJraXQgTW96IE8gbXMgS2h0bWwiLnNwbGl0
KCIgIiksCiAgICAgICAgICAgICAgICBpID0gIiI7CiAgICAgICAgICAgIGlmIChlLnN0eWxlLmFu
aW1hdGlvbk5hbWUgJiYgKHQgPSAhMCksICExID09PSB0KQogICAgICAgICAgICAgICAgZm9yICh2
YXIgbyA9IDA7IG8gPCBuLmxlbmd0aDsgbysrKQogICAgICAgICAgICAgICAgICAgIGlmICh2b2lk
IDAgIT09IGUuc3R5bGVbbltvXSArICJBbmltYXRpb25OYW1lIl0pIHsKICAgICAgICAgICAgICAg
ICAgICAgICAgaSA9IG5bb10sIGkgKyAiQW5pbWF0aW9uIiwgIi0iICsgaS50b0xvd2VyQ2FzZSgp
ICsgIi0iLCB0ID0gITA7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAg
ICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gdGhpcy5jc3NBbmltYXRpb25zU3VwcG9ydCA9
IHQsIHQKICAgICAgICB9LCBpLnByb3RvdHlwZS5oYXJkd2FyZUFjY2VsZXJhdGUgPSBmdW5jdGlv
bigpIHsKICAgICAgICAgICAgdGhpcy4kZWwuY3NzKHsKICAgICAgICAgICAgICAgICItd2Via2l0
LXBlcnNwZWN0aXZlIjogMWUzLAogICAgICAgICAgICAgICAgcGVyc3BlY3RpdmU6IDFlMywKICAg
ICAgICAgICAgICAgICItd2Via2l0LWJhY2tmYWNlLXZpc2liaWxpdHkiOiAiaGlkZGVuIiwKICAg
ICAgICAgICAgICAgICJiYWNrZmFjZS12aXNpYmlsaXR5IjogImhpZGRlbiIKICAgICAgICAgICAg
fSkKICAgICAgICB9LCBpLnByb3RvdHlwZS5nZXRNb3ZlbWVudFZhbHVlcyA9IGZ1bmN0aW9uKCkg
ewogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgZXY6IHRoaXMuZXYsCiAgICAg
ICAgICAgICAgICBwb3M6IHRoaXMucG9zLAogICAgICAgICAgICAgICAgdmVsb2NpdHk6IHRoaXMu
dmVsb2NpdHkoKQogICAgICAgICAgICB9CiAgICAgICAgfSwgaS5wcm90b3R5cGUuYnVpbGREZWJ1
Z0RpdiA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICB2YXIgZTsKICAgICAgICAgICAgMCA9PT0g
dCgiI3BlcC1kZWJ1ZyIpLmxlbmd0aCAmJiAoZSA9IHQoIjxkaXY+PC9kaXY+IiksIGUuYXR0cigi
aWQiLCAicGVwLWRlYnVnIikuYXBwZW5kKCI8ZGl2IHN0eWxlPSdmb250LXdlaWdodDpib2xkOyBi
YWNrZ3JvdW5kOiByZWQ7IGNvbG9yOiB3aGl0ZTsnPkRFQlVHIE1PREU8L2Rpdj4iKS5hcHBlbmQo
IjxkaXYgaWQ9J3BlcC1kZWJ1Zy1ldmVudCc+bm8gZXZlbnQ8L2Rpdj4iKS5hcHBlbmQoIjxkaXYg
aWQ9J3BlcC1kZWJ1Zy1ldi1jb29yZHMnPmV2ZW50IGNvb3JkczogPHNwYW4gY2xhc3M9J3BlcC14
Jz4tPC9zcGFuPiwgPHNwYW4gY2xhc3M9J3BlcC15Jz4tPC9zcGFuPjwvZGl2PiIpLmFwcGVuZCgi
PGRpdiBpZD0ncGVwLWRlYnVnLXBvcy1jb29yZHMnPnBvc2l0aW9uIGNvb3JkczogPHNwYW4gY2xh
c3M9J3BlcC14Jz4tPC9zcGFuPiwgPHNwYW4gY2xhc3M9J3BlcC15Jz4tPC9zcGFuPjwvZGl2PiIp
LmFwcGVuZCgiPGRpdiBpZD0ncGVwLWRlYnVnLXZlbG9jaXR5Jz52ZWxvY2l0eTogPHNwYW4gY2xh
c3M9J3BlcC14Jz4tPC9zcGFuPiwgPHNwYW4gY2xhc3M9J3BlcC15Jz4tPC9zcGFuPjwvZGl2PiIp
LmFwcGVuZCgiPGRpdiBpZD0ncGVwLWRlYnVnLWRlbHRhJz4mRGVsdGE7IG1vdmVtZW50OiA8c3Bh
biBjbGFzcz0ncGVwLXgnPi08L3NwYW4+LCA8c3BhbiBjbGFzcz0ncGVwLXknPi08L3NwYW4+PC9k
aXY+IikuY3NzKHsKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAiZml4ZWQiLAogICAgICAgICAg
ICAgICAgYm90dG9tOiA1LAogICAgICAgICAgICAgICAgcmlnaHQ6IDUsCiAgICAgICAgICAgICAg
ICB6SW5kZXg6IDk5OTk5LAogICAgICAgICAgICAgICAgdGV4dEFsaWduOiAicmlnaHQiLAogICAg
ICAgICAgICAgICAgZm9udEZhbWlseTogIkFyaWFsLCBzYW5zIiwKICAgICAgICAgICAgICAgIGZv
bnRTaXplOiAxMCwKICAgICAgICAgICAgICAgIGJvcmRlcjogIjFweCBzb2xpZCAjREREIiwKICAg
ICAgICAgICAgICAgIHBhZGRpbmc6ICIzcHgiLAogICAgICAgICAgICAgICAgYmFja2dyb3VuZDog
IndoaXRlIiwKICAgICAgICAgICAgICAgIGNvbG9yOiAiIzMzMyIKICAgICAgICAgICAgfSkpOwog
ICAgICAgICAgICB2YXIgbiA9IHRoaXM7CiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24o
KSB7CiAgICAgICAgICAgICAgICBuLmRlYnVnRWxlbWVudHMgPSB7CiAgICAgICAgICAgICAgICAg
ICAgJGV2ZW50OiB0KCIjcGVwLWRlYnVnLWV2ZW50IiksCiAgICAgICAgICAgICAgICAgICAgJHZl
bG9jaXR5WDogdCgiI3BlcC1kZWJ1Zy12ZWxvY2l0eSAucGVwLXgiKSwKICAgICAgICAgICAgICAg
ICAgICAkdmVsb2NpdHlZOiB0KCIjcGVwLWRlYnVnLXZlbG9jaXR5IC5wZXAteSIpLAogICAgICAg
ICAgICAgICAgICAgICRkWDogdCgiI3BlcC1kZWJ1Zy1kZWx0YSAucGVwLXgiKSwKICAgICAgICAg
ICAgICAgICAgICAkZFk6IHQoIiNwZXAtZGVidWctZGVsdGEgLnBlcC15IiksCiAgICAgICAgICAg
ICAgICAgICAgJGV2Q29vcmRzWDogdCgiI3BlcC1kZWJ1Zy1ldi1jb29yZHMgLnBlcC14IiksCiAg
ICAgICAgICAgICAgICAgICAgJGV2Q29vcmRzWTogdCgiI3BlcC1kZWJ1Zy1ldi1jb29yZHMgLnBl
cC15IiksCiAgICAgICAgICAgICAgICAgICAgJHBvc0Nvb3Jkc1g6IHQoIiNwZXAtZGVidWctcG9z
LWNvb3JkcyAucGVwLXgiKSwKICAgICAgICAgICAgICAgICAgICAkcG9zQ29vcmRzWTogdCgiI3Bl
cC1kZWJ1Zy1wb3MtY29vcmRzIC5wZXAteSIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg
IH0sIDApLCB0KCJib2R5IikuYXBwZW5kKGUpCiAgICAgICAgfSwgaS5wcm90b3R5cGUubG9nID0g
ZnVuY3Rpb24odCkgewogICAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmRlYnVnKSBzd2l0Y2gg
KHQudHlwZSkgewogICAgICAgICAgICAgICAgY2FzZSAiZXZlbnQiOgogICAgICAgICAgICAgICAg
ICAgIHRoaXMuZGVidWdFbGVtZW50cy4kZXZlbnQudGV4dCh0LmV2ZW50KTsKICAgICAgICAgICAg
ICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgInBvcy1jb29yZHMiOgogICAgICAg
ICAgICAgICAgICAgIHRoaXMuZGVidWdFbGVtZW50cy4kcG9zQ29vcmRzWC50ZXh0KHQueCksIHRo
aXMuZGVidWdFbGVtZW50cy4kcG9zQ29vcmRzWS50ZXh0KHQueSk7CiAgICAgICAgICAgICAgICAg
ICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlICJldmVudC1jb29yZHMiOgogICAgICAgICAg
ICAgICAgICAgIHRoaXMuZGVidWdFbGVtZW50cy4kZXZDb29yZHNYLnRleHQodC54KSwgdGhpcy5k
ZWJ1Z0VsZW1lbnRzLiRldkNvb3Jkc1kudGV4dCh0LnkpOwogICAgICAgICAgICAgICAgICAgIGJy
ZWFrOwogICAgICAgICAgICAgICAgY2FzZSAiZGVsdGEiOgogICAgICAgICAgICAgICAgICAgIHRo
aXMuZGVidWdFbGVtZW50cy4kZFgudGV4dCh0LngpLCB0aGlzLmRlYnVnRWxlbWVudHMuJGRZLnRl
eHQodC55KTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2Ug
InZlbG9jaXR5IjoKICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IHRoaXMudmVsb2NpdHkoKTsK
ICAgICAgICAgICAgICAgICAgICB0aGlzLmRlYnVnRWxlbWVudHMuJHZlbG9jaXR5WC50ZXh0KE1h
dGgucm91bmQoZS54KSksIHRoaXMuZGVidWdFbGVtZW50cy4kdmVsb2NpdHlZLnRleHQoTWF0aC5y
b3VuZChlLnkpKQogICAgICAgICAgICB9CiAgICAgICAgfSwgaS5wcm90b3R5cGUudG9nZ2xlID0g
ZnVuY3Rpb24odCkgewogICAgICAgICAgICB0aGlzLmRpc2FibGVkID0gdm9pZCAwID09PSB0ID8g
IXRoaXMuZGlzYWJsZWQgOiAhdAogICAgICAgIH0sIHQuZXh0ZW5kKHQuZWFzaW5nLCB7CiAgICAg
ICAgICAgIGVhc2VPdXRRdWFkOiBmdW5jdGlvbih0LCBlLCBuLCBpLCBvKSB7CiAgICAgICAgICAg
ICAgICByZXR1cm4gLWkgKiAoZSAvPSBvKSAqIChlIC0gMikgKyBuCiAgICAgICAgICAgIH0sCiAg
ICAgICAgICAgIGVhc2VPdXRDaXJjOiBmdW5jdGlvbih0LCBlLCBuLCBpLCBvKSB7CiAgICAgICAg
ICAgICAgICByZXR1cm4gaSAqIE1hdGguc3FydCgxIC0gKGUgPSBlIC8gbyAtIDEpICogZSkgKyBu
CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGVhc2VPdXRFeHBvOiBmdW5jdGlvbih0LCBlLCBu
LCBpLCBvKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZSA9PT0gbyA/IG4gKyBpIDogaSAqICgx
IC0gTWF0aC5wb3coMiwgLTEwICogZSAvIG8pKSArIG4KICAgICAgICAgICAgfQogICAgICAgIH0p
LCB0LmZuW29dID0gZnVuY3Rpb24oZSkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1
bmN0aW9uKCkgewogICAgICAgICAgICAgICAgaWYgKCF0LmRhdGEodGhpcywgInBsdWdpbl8iICsg
bykpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgbiA9IG5ldyBpKHRoaXMsIGUpOwogICAgICAg
ICAgICAgICAgICAgIHQuZGF0YSh0aGlzLCAicGx1Z2luXyIgKyBvLCBuKSwgdC5wZXAucGVwcy5w
dXNoKG4pCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwgdC5wZXAg
PSB7fSwgdC5wZXAucGVwcyA9IFtdLCB0LnBlcC50b2dnbGVBbGwgPSBmdW5jdGlvbihlKSB7CiAg
ICAgICAgICAgIHQuZWFjaCh0aGlzLnBlcHMsIGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICAgICAg
ICAgIG4udG9nZ2xlKGUpCiAgICAgICAgICAgIH0pCiAgICAgICAgfSwgdC5wZXAudW5iaW5kID0g
ZnVuY3Rpb24oZSkgewogICAgICAgICAgICB0LmVhY2goZSwgZnVuY3Rpb24oZSwgbikgewogICAg
ICAgICAgICAgICAgbiA9IHQobik7CiAgICAgICAgICAgICAgICB2YXIgaSA9IG4uZGF0YSgicGx1
Z2luXyIgKyBvKTsKICAgICAgICAgICAgICAgIHZvaWQgMCAhPT0gaSAmJiAoaS50b2dnbGUoITEp
LCBpLnVuc3Vic2NyaWJlKCksIG4ucmVtb3ZlRGF0YSgicGx1Z2luXyIgKyBvKSkKICAgICAgICAg
ICAgfSkKICAgICAgICB9CiAgICB9KGpRdWVyeSwgd2luZG93KTsKdmFyIGluaXRpYWxPZmZzZXQg
PSAwLAogICAgYmFja2dyb3VuZEluaXQgPSAhMSwKICAgIGJhY2tncm91bmRBbmltYXRpbmcgPSAh
MSwKICAgIHNwaW5uZXI7CiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkgewogICAgc3Bpbigp
LCAkKHdpbmRvdykub24oInJlc2l6ZSIsIHJlc2l6ZU1lKQp9KTsK